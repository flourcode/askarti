<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AskArti - Your 24/7 Sales Buddy</title>
    
    <!-- Meta tags -->
    <meta name="description" content="Get personalized federal sales advice from AskArti. Free AI tool provides SMART goals, customer messaging, and deal strategies for government contractors and sales professionals.">
    <meta name="keywords" content="federal sales, government sales, AI sales coach, sales strategy, federal contractors, govcon, sales advice">
    <meta name="author" content="Mark">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://askarti.com">
    
    <!-- OG tags -->
    <meta property="og:title" content="AskArti - Your Federal Sales Buddy">
    <meta property="og:description" content="Get personalized federal sales advice from AskArti.">
    <meta property="og:image" content="https://askarti.com/images/arti_right.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AskArti - Your Federal Sales Buddy">
    <meta name="twitter:description" content="Get personalized federal sales advice from AskArti.">
    <meta name="twitter:image" content="https://askarti.com/images/arti_right.png">
    
    <!-- Favicon tags -->
    <link rel="icon" href="/images/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <meta name="theme-color" content="#ffffff">
    
    <!-- Preconnect and preload -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="/images/arti_right.png" as="image">
    
    <!-- Scripts and styles -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script> 
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&family=Merriweather:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WLGEPY5H4G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-WLGEPY5H4G');
    </script>
    
    <!-- Tailwind config -->
    <script>
    tailwind.config = {
        theme: {
            extend: {
                fontFamily: {
                    sans: ['Inter', 'sans-serif'],
                    serif: ['Merriweather', 'serif']
                },
                colors: {
                    'brand-purple': '#8E88A7',
                    'brand-purple-faint': '#E1DDEE',
                    'brand-gray': {
                        50: '#F9FAFB', 100: '#F3F4F6', 200: '#E5E7EB',
                        400: '#9CA3AF', 600: '#4B5563', 800: '#1F2937', 900: '#111827'
                    },
                    'brand-yellow': { bg: '#FCF8E8', text: '#7A6A34', border: '#F5EED8' },
                    'brand-blue': { bg: '#E8EDF2', text: '#3A4F6A', border: '#D4DCE6' },
                    'brand-green': { bg: '#EBF0EA', text: '#4A5C4A', border: '#D8E2D9' }
                }
            }
        }
    }
    </script>

    <style>
    /* === CSS VARIABLES & BASE === */
    :root {
        --brand-purple: #8E88A7;
        --brand-purple-faint: #E1DDEE;
        --brand-gray-50: #F9FAFB;
        --brand-gray-100: #F3F4F6;
        --brand-gray-800: #1F2937;
    }

    html { scroll-behavior: smooth; }

    body {
        background-color: var(--brand-gray-50);
        font-family: 'Inter', sans-serif;
        color: var(--brand-gray-800);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    /* === LAYOUT === */
    .main-container {
        max-width: 768px;
        margin: 0 auto;
        padding: 1rem;
    }

    .fade-in {
        animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* === CARDS === */
    .io-card {
        background-color: white;
        border-radius: 1rem;
        border: 0px solid #E5E7EB;
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
        transition: box-shadow 0.2s ease;
    }

    .results-card {
        background-color: white;
        border-radius: 1rem;
        border: 1px solid #E5E7EB;
        overflow: hidden;
        margin-top: 1.5rem;
    }

    .results-card-header {
        padding: 1rem 1.5rem;
        border-bottom: 1px solid #E5E7EB;
    }

    .results-card-body {
        padding: 1.5rem;
    }

    .results-card-body > div {
        margin-bottom: 1.5rem;
    }

    /* === TYPOGRAPHY === */
    h1, h2, h3, h4, h5, h6 {
        font-weight: 700;
        margin-bottom: 1rem;
    }

    p, li, span {
        font-weight: 400;
        line-height: 1.6;
    }

    /* === FORM INPUTS === */
    textarea, input[type="text"] {
        font-size: 16px !important;
        transition: all 0.2s ease;
        font-weight: 400;
        color: #374151;
        line-height: 1.4;
    }

    #chat-input {
        font-weight: 400 !important;
        color: #4B5563 !important;
        letter-spacing: 0.005em;
        line-height: 1.4 !important;
        font-size: 15px !important;
    }

    #chat-input::placeholder {
        color: #9CA3AF;
        font-weight: 300;
        font-style: italic;
        line-height: 1.4;
    }

    #chat-input:focus {
        color: #1F2937;
        outline: none;
        ring: 1px;
        ring-color: #8E88A7;
        border-color: #8E88A7;
    }

    /* === BUTTONS === */
    .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        border-radius: 0.75rem;
        padding: 0.75rem 1.5rem;
        min-height: 44px;
        min-width: 44px;
        transition: all 0.2s ease;
        cursor: pointer;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
    }

    .btn:active { transform: scale(0.95); }

    .btn-primary {
        background-color: var(--brand-purple);
        color: white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .btn-primary:hover {
        background-color: #7A7391;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .btn-primary:active {
        transform: scale(0.95);
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .btn-secondary {
        background-color: white;
        color: #374151;
        border: 1px solid #D1D5DB;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .btn-secondary:hover {
        background-color: #F9FAFB;
        border-color: #9CA3AF;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .btn-secondary:active {
        transform: scale(0.95);
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .btn-recommended {
        border-width: 2px;
        border-color: var(--brand-purple);
        box-shadow: 0 4px 12px rgba(124, 107, 190, 0.2);
    }

    /* === UTILITY BUTTONS === */
    .copy-btn {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        background-color: rgba(255, 255, 255, 0.7);
        border: 1px solid #E5E7EB;
        border-radius: 0.5rem;
        padding: 0.5rem;
        min-width: 44px;
        min-height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #4B5563;
        cursor: pointer;
        transition: all 0.2s ease;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        font-size: 0.75rem;
    }

    .copy-btn:hover {
        background-color: white;
        border-color: #9CA3AF;
        transform: translateY(-1px);
        color: #374151;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .copy-btn:active { transform: scale(0.95); }

    .copy-btn.copied {
        background-color: #10B981;
        color: white;
        border-color: #10B981;
    }

    .copy-btn.copied:hover {
        background-color: #059669;
        border-color: #059669;
    }

    /* === ANIMATIONS === */
    @keyframes copyFlash {
        0% { background-color: rgba(16, 185, 129, 0.1); }
        50% { background-color: rgba(16, 185, 129, 0.3); }
        100% { background-color: rgba(16, 185, 129, 0.1); }
    }

    .copy-flash { animation: copyFlash 0.6s ease-in-out; }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .loader {
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top: 2px solid white;
        border-radius: 50%;
        width: 1.25rem;
        height: 1.25rem;
        animation: spin 1s linear infinite;
    }

    .btn-secondary .loader {
        border-color: rgba(0, 0, 0, 0.1);
        border-top-color: var(--brand-purple);
    }

    /* === CHAT === */
    .chat-container {
        height: 65dvh;
        max-height: 600px;
        overflow-y: auto;
        padding: 1rem;
        background-color: #F9FAFB;
        border-radius: 1rem;
        border: 0px solid #E5E7EB;
    }

    .chat-message-user {
        background-color: var(--brand-purple);
        color: white;
        border-radius: 1rem 1rem 0.25rem 1rem;
    }

    .chat-message-arti {
        background-color: white;
        color: #1f2937;
        border: 1px solid #e5e7eb;
        border-radius: 1rem 1rem 1rem 0.25rem;
    }

    /* === DIGEST STYLES === */
    .digest-card .results-card-body { padding: 2rem; }

    .digest-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 0px solid #E5E7EB;
    }

    .digest-header img {
        width: 3rem;
        height: 3rem;
        border-radius: 50%;
        background-color: var(--brand-purple-faint);
        padding: 0.25rem;
        border: none;
    }

    .digest-header h2 {
        font-size: 1.75rem;
        font-weight: 800;
        color: #111827;
        letter-spacing: -0.025em;
        margin-bottom: 0.25rem;
    }

    .digest-header-meta {
        font-size: 0.875rem;
        color: #6B7280;
        text-transform: uppercase;
        font-weight: 600;
    }

    .digest-section {
        padding-top: 1.5rem;
        margin-top: 1.5rem;
        border-top: 1px solid #E5E7EB;
    }

    .digest-section-title {
        font-size: 0.75rem;
        font-weight: 700;
        color: var(--brand-purple);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 1rem;
    }

    .digest-item {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 0 1rem;
        margin-bottom: 2rem;
    }

    .digest-item-number {
        font-size: 1.5rem;
        font-weight: 700;
        color: #374151;
        line-height: 1.2;
    }

    .digest-item-headline {
        font-weight: 700;
        font-size: 1.125rem;
        color: #1F2937;
        margin-bottom: 0.25rem;
    }

    .digest-item-headline a {
        color: inherit;
        text-decoration: none;
        transition: background-color 0.2s ease;
    }

    .digest-item-headline a:hover {
        background-color: var(--brand-purple-faint);
    }

    .digest-item-summary, .digest-item-insight {
        font-family: 'Merriweather', serif;
        font-size: 1rem;
        line-height: 1.7;
        color: #374151;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    .digest-item-insight {
        font-style: italic;
        color: var(--brand-purple);
        margin-top: 0.75rem;
    }

    .digest-item-meta { margin-top: 0.75rem; }

    .digest-code-block {
        background-color: #F9FAFB;
        border: 1px solid #E5E7EB;
        border-radius: 0.5rem;
        padding: 1rem;
        font-family: monospace;
        font-size: 0.875rem;
        white-space: pre-wrap;
        word-wrap: break-word;
        word-break: normal;
        overflow-wrap: break-word;
        position: relative;
        line-height: 1.5;
    }

    .digest-tag {
        display: inline-block;
        background-color: #F3F4F6;
        color: #374151;
        font-size: 0.75rem;
        font-weight: 600;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        margin-right: 0.5rem;
        margin-bottom: 0.5rem;
    }

    /* === MISC === */
    .checkmark {
        width: 16px;
        height: 16px;
        stroke: currentColor;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
        fill: none;
    }

    .mermaid-container {
        background-color: #ffffff;
        border: 1px solid #E5E7EB;
        border-radius: 0.5rem;
        padding: 1rem;
        margin: 1rem 0;
    }

    .sample-link {
        color: var(--brand-purple);
        font-weight: 600;
        text-decoration: none;
        border-bottom: 1px dotted var(--brand-purple);
        transition: all 0.2s ease;
    }

    .sample-link:hover {
        background-color: var(--brand-purple-faint);
        border-bottom-style: solid;
    }
    
    .border-l-3 {
        border-left-width: 3px;
    }

    .border-purple-300 {
        border-left-color: #d8b4fe;
    }

    .border-blue-300 {
        border-left-color: #93c5fd;
    }

    .border-green-300 {
        border-left-color: #86efac;
    }

    .border-yellow-300 {
        border-left-color: #fde047;
    }

    .border-red-300 {
        border-left-color: #fca5a5;
    }
    .border-orange-300 {
        border-left-color: #fdba74;
    }

    .border-indigo-300 {
        border-left-color: #a5b4fc;
    }

    .suggestion-chip {
        background-color: #F3F4F6;
        border: 1px solid #E5E7EB;
        border-radius: 9999px;
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
        font-weight: 500;
        color: #4B5563;
        cursor: pointer;
        transition: all 0.2s ease;
        white-space: nowrap;
    }

    .suggestion-chip:hover {
        background-color: #E5E7EB;
        color: #1F2937;
        transform: translateY(-1px);
    }

    .suggestion-chip:active {
        transform: scale(0.95);
    }

    /* === MOBILE RESPONSIVE === */
    @media (max-width: 640px) {
        .main-container { padding: 0.5rem; padding-bottom: 0.5rem; }
        .io-card, .results-card-body { padding: 0.75rem; }
        .results-card-header { padding: 0.75rem 1rem; }
        .results-card-body > div { margin-bottom: 1rem; }
        .btn { padding: 0.75rem 1rem; font-size: 0.9rem; }
        .copy-btn { padding: 0.625rem; min-width: 48px; min-height: 48px; }
        .mt-4 { margin-top: 0.5rem; }
        .mt-6 { margin-top: 0.75rem; }
        .chat-container { height: 55dvh; max-height: 450px; padding: 0.75rem; }
        header { margin-bottom: 0.5rem; }
        header img { height: 4rem; }
        footer { margin-top: 2rem; }
        .space-y-3 > * + * { margin-top: 0.5rem; }
        .space-y-4 > * + * { margin-top: 0.75rem; }
        .space-y-6 > * + * { margin-top: 1rem; }
        .space-y-8 > * + * { margin-top: 1.25rem; }
        .digest-card .results-card-body { padding: 1.25rem; }
        .digest-header h2 { font-size: 1.5rem; }
        .digest-item-headline { font-size: 1rem; }
        .suggestion-chips-container { 
            padding-bottom: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .suggestion-chip {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }
    }

    @media (max-width: 768px) {
        .copy-playbook-btn { padding: 0.5rem 0.75rem; font-size: 0.75rem; }
        .copy-playbook-btn svg { width: 1rem; height: 1rem; margin-right: 0.25rem; }
        .results-card-header .flex { flex-direction: column; align-items: flex-start; gap: 0.75rem; }
        .results-card-header .flex > div:first-child { flex: 1; width: 100%; }
        .copy-playbook-btn { align-self: stretch; justify-content: center; width: 100%; }
        .playbook-persona-circle { min-width: 2rem !important; width: 2rem !important; height: 2rem !important; flex-shrink: 0 !important; font-size: 0.75rem !important; }
    }

    /* Responsive fixes */
    .results-card,
    .digest-card {
        box-sizing: border-box !important;
    }

    .results-card-body,
    .digest-card .results-card-body {
        max-width: 100% !important;
        box-sizing: border-box !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
    }

    .digest-header,
    .digest-section,
    .digest-item {
        max-width: 100% !important;
        box-sizing: border-box !important;
    }

    .digest-item > div:nth-child(2) {
        min-width: 0 !important;
        flex: 1 !important;
    }

    .digest-item-summary,
    .digest-item-insight,
    .digest-item-headline,
    .digest-code-block {
        max-width: 100% !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
        box-sizing: border-box !important;
    }

    /* Fix all text content in renderers */
    .results-card p,
    .results-card h1,
    .results-card h2,
    .results-card h3,
    .results-card h4,
    .results-card li,
    .results-card span {
        max-width: 100% !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
    }
    
    /* Structured card in chat - new styles */
    .structured-card {
        background-color: white;
        border-radius: 0.75rem;
        border: 1px solid #E5E7EB;
        overflow: hidden;
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        transition: box-shadow 0.2s;
    }
    
    .structured-card:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .chat-structured-content {
        max-width: 95%;
        margin-top: 0.5rem;
    }
    
    /* Highlighted action text */
    .action-highlight {
        background-color: #FCF8E8;
        border-left: 3px solid #fde047;
        padding: 0.5rem;
        margin: 0.5rem 0;
        border-radius: 0.25rem;
        font-weight: 500;
    }
    
    /* Typing indicator dots */
    .dot-typing {
        position: relative;
        display: inline-block;
        width: 6px;
        height: 6px;
        margin-right: 3px;
        background-color: currentColor;
        border-radius: 50%;
        opacity: 0.7;
        animation: dotTyping 1.5s infinite linear;
    }
    
    @keyframes dotTyping {
        0% { opacity: 0.2; transform: scale(0.8); }
        20% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.2; transform: scale(0.8); }
        100% { opacity: 0.2; transform: scale(0.8); }
    }
    </style>
</head>
<body class="bg-brand-gray-50">
    <div class="main-container pt-4 pb-20">
        <!-- Header -->
        <header class="text-center mb-3">
            <a href="/" aria-label="AskArti Home" class="inline-block">
                <img src="/images/asklite.png" alt="AskArti Logo" class="h-20 w-auto mx-auto sm:h-24">
            </a>
        </header>

        <!-- Main content -->
        <main id="main-content">
            <div class="io-card">
                <!-- Chat container -->
                <div class="chat-container mb-4" id="chat-container">
                    <div id="chat-messages" class="space-y-4">
                        <div class="flex justify-start">
                            <div class="chat-message-arti p-3 text-sm max-w-[85%]">
                                <p id="chat-greeting">Hey! I'm Arti, your federal sales coach. I can help with your sales challenges, analyze deals, or create structured plans. What's on your mind today?</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Suggestion chips container -->
                <div class="suggestion-chips-container flex gap-2 overflow-x-auto pb-3 mb-3 border-b border-gray-200 hidden" id="suggestion-chips-container">
                    <!-- Chips will be dynamically inserted here -->
                </div>
                
                <!-- Input area -->
                <div class="flex gap-2">
                    <input type="text" id="chat-input" class="flex-1 p-3 text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-gray-300 focus:border-gray-300" placeholder="Type your message or paste an article..." maxlength="2500">
                    <button id="chat-send-btn" class="btn btn-primary px-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z" clip-rule="evenodd" /></svg>
                    </button>
                </div>
                
                <!-- Sample prompt tips -->
                <div class="mt-3 text-sm text-gray-600 leading-relaxed">
                    <div class="grid grid-cols-1 gap-2 text-xs">
                        <div class="bg-gray-50 p-2 rounded border-l-3 border-indigo-300">
                            <strong>ðŸ’¡ Try these:</strong> 
                            <a href="#" class="sample-link sample-prompt" data-prompt="Help with a stuck deal">Stuck deal</a> â€¢
                            <a href="#" class="sample-link sample-prompt" data-prompt="Create a sales playbook for cloud services at DoD">Sales playbook</a> â€¢
                            <a href="#" class="sample-link sample-prompt" data-prompt="Analyze this article: [paste article text]">Article analysis</a> â€¢
                            <a href="#" class="sample-link sample-prompt" data-prompt="Get today's federal news briefing">Daily news</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-6 bg-gray-50 p-4 rounded-lg border border-gray-200 text-sm text-gray-600 max-w-none mx-auto">
                <p class="mb-3"><strong>ðŸ‘‹ Hi there!</strong> I'm designed to help with all your federal sales needs. You can chat with me naturally about sales challenges, paste articles or news for actionable intelligence, ask for a "sales playbook" to get comprehensive strategy, request a "daily briefing" for federal market news, ask for deal strategies to unstick your sales opportunities, or even analyze financials for investment insights.</p>
                <p>Try one of the sample prompts above or just ask me anything about federal sales. I'm here to help!</p>
            </div>

            <!-- Error message -->
            <div id="error-message" class="bg-red-100 border border-red-300 rounded-lg p-4 text-center my-4 hidden">
                <p class="text-red-800 font-semibold mb-1">Â¯\_(ãƒ„)_/Â¯ Oops, that didn't work.</p>
                <p class="text-red-700 text-sm" id="error-details">We're having trouble connecting to Arti.</p>
            </div>
        </main>
   
        <!-- Footer -->
        <footer class="text-center mt-8 text-xs text-gray-500">
            <div class="flex justify-center gap-4 mb-4">
                <a href="#" id="about-btn" class="font-medium text-brand-purple hover:underline">About AskArti</a>
                <a href="mailto:mark@subhoo.com" class="font-medium text-brand-purple hover:underline">Contact</a>
            </div>
            <p class="mb-3 text-gray-600">
                You're interacting with an AI assistant trained through June 2024. AskArti offers general guidance for informational purposes only and isn't a substitute for professional advice. Always evaluate recommendations carefully before making decisions.
            </p>
            <p>
                For Federal Sellers by Federal Sellers.
                <br>
                Powered by AWS.
                <br>
                Â© 2025 AskArti.com.
            </p>
        </footer>
    </div>
 
    <!-- About modal -->
    <div id="about-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md p-6">
            <div class="flex justify-between items-start mb-4">
                <h2 class="text-xl font-bold text-gray-900">About AskArti</h2>
                <button id="close-about" class="text-gray-400 hover:text-gray-600">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div class="space-y-4 text-gray-700 text-sm">
                <p>AskArti is your 24/7 AI sales coach, designed for federal sales professionals. Get instant advice on stuck deals, meeting preparation, and sales strategy.</p>
                <div class="mt-4 pt-4 border-t">
                    <h3 class="font-semibold text-gray-800 mb-2">Privacy & Technology</h3>
                    <p class="text-gray-600">AskArti uses advanced AI models. We do not store, log, or persist any conversation data. All processing occurs in-memory and is discarded.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
    // Configuration
    const CONFIG = {
        API_ENDPOINT: 'https://vd823jgh0a.execute-api.us-east-1.amazonaws.com/prod/AskArtiAPI',
        REQUEST_TIMEOUT: 30000,
        MAX_RETRIES: 2,
        RETRY_DELAY: 2000,
        MAX_INPUT_LENGTH: 2500,
        MIN_REQUEST_INTERVAL: 2000,
        LOADING_MESSAGES: [
            "Hang on. I'm...Working Backwards", 
            "...Diving Deep", 
            "...Unpacking This", 
            "...Putting a Pin in it", 
            "...Circling Back", 
            "...Thinking Big"
        ],
        SUGGESTION_TYPES: {
            DEFAULT: [
                "How do I prospect better?",
                "Create a sales playbook",
                "Get today's federal news briefing"
            ],
            DEAL: [
                "What would be the next step?",
                "How to handle pricing objections?",
                "Help me create a follow-up email"
            ],
            PROSPECT: [
                "Who are the key stakeholders?",
                "What partners should I consider?",
                "What's my best approach?"
            ],
            NEWS: [
                "Who are the key people to contact?",
                "What are the next actions?",
                "Create a GTM strategy"
            ],
            DIGEST: [
                "Show me the key opportunities",
                "What are the action items?",
                "Analyze a specific article"
            ],
            PLAYBOOK: [
                "How do I position against competitors?",
                "What are the success metrics?",
                "Who are my target personas?"
            ],
            INVESTMENT: [
                "What's the bull case?",
                "What are the risks?",
                "Show me the key metrics"
            ]
        }
    };

    class AskArti {
        constructor() {
            this.elements = this.getElements();
            this.state = {
                pendingRequest: false,
                lastRequestTime: 0,
                loadingInterval: null,
                abortController: null,
                chatHistory: [],
                lastResponseType: null,
                lastMessage: null
            };
            this.init();
        }

        getElements() {
            return {
                chatContainer: document.getElementById('chat-container'),
                chatMessages: document.getElementById('chat-messages'),
                chatInput: document.getElementById('chat-input'),
                chatSendBtn: document.getElementById('chat-send-btn'),
                suggestionChipsContainer: document.getElementById('suggestion-chips-container'),
                errorMessage: document.getElementById('error-message'),
                errorDetails: document.getElementById('error-details'),
                aboutBtn: document.getElementById('about-btn'),
                aboutModal: document.getElementById('about-modal'),
                closeAbout: document.getElementById('close-about')
            };
        }

        init() {
            this.updateGreeting();
            this.setupEventListeners();
            this.setupMermaid();
            
            // Focus the input field
            this.elements.chatInput.focus();
            
            // Set up sample prompts
            this.setupSamplePrompts();
        }

        setupSamplePrompts() {
            document.querySelectorAll('.sample-prompt').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const promptText = e.currentTarget.dataset.prompt;
                    this.elements.chatInput.value = promptText;
                    this.elements.chatInput.focus();
                    
                    // Auto-send for certain prompts
                    if (promptText.includes('Daily news') || promptText.includes('briefing')) {
                        this.sendMessage();
                    }
                });
            });
        }

        updateGreeting() {
            const hour = new Date().getHours();
            let greeting = '';
            
            if (hour >= 5 && hour < 12) {
                greeting = "Good morning!";
            } else if (hour >= 12 && hour < 17) {
                greeting = "Good afternoon!";
            } else if (hour >= 17 && hour < 21) {
                greeting = "Good evening!";
            } else {
                greeting = "Hello there!";
            }
            
            const chatGreeting = document.getElementById('chat-greeting');
            if (chatGreeting) {
                chatGreeting.textContent = `${greeting} I'm Arti, your federal sales coach. I can help with your sales challenges, analyze deals, or create structured plans. What's on your mind today?`;
            }
        }

        setupMermaid() {
            mermaid.initialize({ 
                startOnLoad: false, 
                securityLevel: 'strict', 
                theme: 'base', 
                themeVariables: {
                    primaryColor: '#F3F4F6',
                    primaryTextColor: '#1F2937',
                    primaryBorderColor: '#D1D5DB',
                    lineColor: '#6B7280',
                    textColor: '#111827',
                    fontSize: '14px'
                }
            });
        }

        setupEventListeners() {
            // Chat send button
            this.elements.chatSendBtn.addEventListener('click', () => {
                this.sendMessage();
            });
            
            // Enter key to send
            this.elements.chatInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    this.sendMessage();
                }
            });
            
            // About modal
            this.elements.aboutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                this.showModal();
            });
            
            this.elements.closeAbout.addEventListener('click', () => {
                this.hideModal();
            });
            
            this.elements.aboutModal.addEventListener('click', (e) => {
                if (e.target === this.elements.aboutModal) {
                    this.hideModal();
                }
            });
            
            // ESC key for modal
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    this.hideModal();
                }
            });
        }

        showModal() {
            this.elements.aboutModal.classList.remove('hidden');
        }

        hideModal() {
            this.elements.aboutModal.classList.add('hidden');
        }

        async sendMessage() {
            const message = this.elements.chatInput.value.trim();
            if (!message || this.state.pendingRequest) return;
            
            // Prevent double-sending
            this.state.pendingRequest = true;
            
            // Store message for potential retry
            this.state.lastMessage = message;
            
            // Clear input and add user message
            this.elements.chatInput.value = '';
            this.addMessage(message, true);
            
            // Add to chat history
            this.state.chatHistory.push({ 
                role: 'user', 
                content: message 
            });
            
            // Show typing indicator
            this.showTypingIndicator();
            
            try {
                // Make API request
                const response = await fetch(CONFIG.API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        situation: message, 
                        mode: 'chat',
                        conversationHistory: this.state.chatHistory
                    }),
                });
                
                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }
                
                const data = await response.json();
                this.hideTypingIndicator();
                
                // Handle the response
                this.handleApiResponse(data);
                
            } catch (error) {
                this.hideTypingIndicator();
                this.handleApiError(error);
            } finally {
                this.state.pendingRequest = false;
            }
        }

        handleApiResponse(data) {
            // Handle chat response with optional structured data
            if (data.message) {
                // Add the chat message
                this.addMessage(data.message);
                
                // Add to history
                this.state.chatHistory.push({ 
                    role: 'assistant', 
                    content: data.message,
                    structuredData: data.structuredData || null
                });
                
                // If there's structured data, render it
                if (data.structuredData) {
                    this.addStructuredCard(data.structuredData);
                }
                
                // Show suggestions if provided
                if (data.suggestions && data.suggestions.length > 0) {
                    this.showSuggestionChips(data.suggestions);
                }
            }
            // Handle direct structured response (legacy)
            else if (data.response_type) {
                // Add intro message
                const intro = this.getIntroForStructuredResponse(data);
                this.addMessage(intro);
                
                // Add structured card
                this.addStructuredCard(data);
                
                // Add to history
                this.state.chatHistory.push({ 
                    role: 'assistant', 
                    content: intro,
                    structuredData: data
                });
                
                // Show appropriate suggestions
                const responseType = data.response_type.toUpperCase();
                if (CONFIG.SUGGESTION_TYPES[responseType]) {
                    this.showSuggestionChips(CONFIG.SUGGESTION_TYPES[responseType]);
                }
            }
        }

        handleApiError(error) {
            console.error('API Error:', error);
            
            let errorMessage = "I'm having trouble processing your request. Please try again.";
            
            if (error.message.includes('Server error')) {
                errorMessage = "There's an issue with the server. Please try again later.";
            } else if (error.message.includes('timeout')) {
                errorMessage = "The request took too long. Please try something shorter or simpler.";
            }
            
            this.addMessage(errorMessage);
            this.showError(error.message || "Connection error", true);
        }

        addMessage(content, isUser = false) {
            let processedContent = '';
            
            if (isUser) {
                processedContent = this.escapeHtml(content);
            } else {
                // Process <action></action> tags
                processedContent = content.replace(/<action>(.*?)<\/action>/g, '<div class="action-highlight">$1</div>');
                
                // Convert markdown
                processedContent = marked.parse(processedContent);
            }
            
            const messageClass = isUser ? 'chat-message-user' : 'chat-message-arti';
            const alignClass = isUser ? 'justify-end' : 'justify-start';
            
            const messageHtml = `
                <div class="flex ${alignClass} fade-in">
                    <div class="${messageClass} p-3 text-sm max-w-[85%]">
                        ${processedContent}
                    </div>
                </div>
            `;
            
            this.elements.chatMessages.insertAdjacentHTML('beforeend', messageHtml);
            this.scrollChatToBottom();
        }

        addStructuredCard(data) {
            if (!data || !data.response_type) return;
            
            const cardType = data.response_type;
            let cardHtml = '';
            
            // Create appropriate card based on response type
            switch (cardType) {
                case 'digest':
                    cardHtml = this.renderDailyDigest(data);
                    break;
                case 'playbook':
                    cardHtml = this.renderSalesPlaybook(data);
                    break;
                case 'news':
                    cardHtml = this.renderNewsAdvice(data);
                    break;
                case 'investment':
                    cardHtml = this.renderMarketAnalysis(data);
                    break;
                case 'prospect':
                    cardHtml = this.renderProspectAdvice(data);
                    break;
                case 'deal':
                case 'interview':
                case 'meeting':
                    cardHtml = this.renderGeneralAdvice(data);
                    break;
                default:
                    return;
            }
            
            // Add the structured card to chat
            const structuredCardHtml = `
                <div class="flex justify-start fade-in chat-structured-content">
                    <div class="structured-card">${cardHtml}</div>
                </div>
            `;
            
            this.elements.chatMessages.insertAdjacentHTML('beforeend', structuredCardHtml);
            this.scrollChatToBottom();
            
            // Setup interactive elements
            this.setupInteractiveElements();
            
            // Render mermaid charts if present
            if (data.mermaid_chart) {
                this.renderMermaidChart();
            }
        }

        showTypingIndicator() {
            const typingHtml = `
                <div id="typing-indicator" class="flex justify-start">
                    <div class="chat-message-arti p-3 text-sm">
                        <span class="inline-flex">
                            <span class="dot-typing"></span>
                            <span class="dot-typing" style="animation-delay: 0.2s"></span>
                            <span class="dot-typing" style="animation-delay: 0.4s"></span>
                        </span>
                    </div>
                </div>
            `;
            this.elements.chatMessages.insertAdjacentHTML('beforeend', typingHtml);
            this.scrollChatToBottom();
        }

        hideTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }

        scrollChatToBottom() {
            this.elements.chatContainer.scrollTop = this.elements.chatContainer.scrollHeight;
        }

        showError(message, canRetry = false) {
            this.elements.errorMessage.classList.remove('hidden');
            this.elements.errorDetails.textContent = message;
            
            if (canRetry) {
                const existingButton = this.elements.errorMessage.querySelector('button');
                if (existingButton) existingButton.remove();
                
                const retryButton = document.createElement('button');
                retryButton.className = 'btn btn-secondary mt-2';
                retryButton.textContent = 'Try Again';
                retryButton.addEventListener('click', () => {
                    this.elements.errorMessage.classList.add('hidden');
                    this.retryLastMessage();
                });
                
                this.elements.errorMessage.appendChild(retryButton);
            }
            
            setTimeout(() => {
                this.elements.errorMessage.classList.add('hidden');
            }, 5000);
        }

        retryLastMessage() {
            if (this.state.lastMessage) {
                this.elements.chatInput.value = this.state.lastMessage;
                this.sendMessage();
            }
        }

        showSuggestionChips(suggestions) {
            if (!suggestions || suggestions.length === 0) {
                this.elements.suggestionChipsContainer.classList.add('hidden');
                return;
            }
            
            // Clear existing chips
            this.elements.suggestionChipsContainer.innerHTML = '';
            
            // Add new chips
            suggestions.forEach(suggestion => {
                const chip = document.createElement('button');
                chip.className = 'suggestion-chip';
                chip.textContent = suggestion;
                chip.addEventListener('click', () => {
                    this.elements.chatInput.value = suggestion;
                    this.elements.chatInput.focus();
                    this.sendMessage();
                });
                
                this.elements.suggestionChipsContainer.appendChild(chip);
            });
            
            // Show the container
            this.elements.suggestionChipsContainer.classList.remove('hidden');
        }

        getIntroForStructuredResponse(data) {
            const type = data.response_type;
            
            switch (type) {
                case 'digest':
                    return "Here's today's federal sales intelligence briefing:";
                case 'playbook':
                    return `I've created a comprehensive sales playbook for ${data.sales_play_title || 'your scenario'}:`;
                case 'news':
                    return "Here's my analysis of the news article with actionable insights:";
                case 'investment':
                    return "I've analyzed the financial information. Here's my investment breakdown:";
                case 'prospect':
                    return "Here's my prospecting intelligence for your target:";
                case 'deal':
                    return "I've created a deal strategy to help you move forward:";
                case 'interview':
                    return "Here's your interview preparation plan:";
                case 'meeting':
                    return "I've prepared a meeting strategy for you:";
                default:
                    return "Here's the structured information you requested:";
            }
        }

        async renderMermaidChart() {
            try {
                await mermaid.run({
                    nodes: document.querySelectorAll('.mermaid')
                });
            } catch (error) {
                console.error('Mermaid rendering error:', error);
                const containers = document.querySelectorAll('.mermaid-container');
                containers.forEach(container => {
                    container.innerHTML = '<p class="text-red-500 text-sm">Could not render visual plan.</p>';
                });
            }
        }

        setupInteractiveElements() {
            // Copy buttons
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(btn => {
                if (btn.dataset.initialized) return;
                btn.dataset.initialized = 'true';
                
                btn.addEventListener('click', (e) => {
                    const target = e.currentTarget.parentElement.querySelector('.copy-target');
                    if (target) {
                        navigator.clipboard.writeText(target.innerText).then(() => {
                            const originalContent = e.currentTarget.innerHTML;
                            e.currentTarget.classList.add('copied');
                            e.currentTarget.innerHTML = `
                                <svg class="checkmark" viewBox="0 0 24 24">
                                    <path d="M9 12l2 2 4-4"></path>
                                </svg>
                                <span>Copied!</span>
                            `;
                            
                            const parent = e.currentTarget.parentElement;
                            parent.classList.add('copy-flash');
                            
                            setTimeout(() => {
                                e.currentTarget.classList.remove('copied');
                                e.currentTarget.innerHTML = originalContent;
                                parent.classList.remove('copy-flash');
                            }, 2000);
                        }).catch(err => {
                            console.error('Failed to copy text: ', err);
                        });
                    }
                });
            });

            // Mermaid download buttons
            const downloadButtons = document.querySelectorAll('#download-png-btn');
            downloadButtons.forEach(btn => {
                if (btn.dataset.initialized) return;
                btn.dataset.initialized = 'true';
                
                btn.addEventListener('click', () => this.downloadMermaidAsPNG(btn));
            });
        }

        downloadMermaidAsPNG(buttonElement) {
            const mermaidContainer = buttonElement.closest('.digest-section').querySelector('.mermaid-container');
            
            if (!mermaidContainer || typeof html2canvas === 'undefined') {
                console.error("Mermaid container or html2canvas library not found.");
                return;
            }
            
            html2canvas(mermaidContainer, { backgroundColor: '#ffffff' }).then(canvas => {
                const a = document.createElement("a");
                a.href = canvas.toDataURL("image/png");
                a.download = "askarti-diagram.png";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
        }

        escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // RENDERER METHODS
        renderDailyDigest(data) {
            const dealDriversHtml = data.deal_drivers && data.deal_drivers.length > 0 
                ? data.deal_drivers.map((driver, index) => `
                    <div class="digest-item">
                        <div class="digest-item-number">${index + 1}.</div>
                        <div>
                            <h3 class="digest-item-headline">
                                ${driver.link ? `<a href="${driver.link}" target="_blank" rel="noopener noreferrer">${driver.headline}</a>` : driver.headline}
                            </h3>
                            <p class="digest-item-summary">${driver.summary}</p>
                            ${driver.action_insight ? `<p class="digest-item-insight">ðŸ’¡ ${driver.action_insight}</p>` : ''}
                            <div class="digest-item-meta">
                                ${driver.source ? `<span class="digest-tag">${driver.source}</span>` : ''}
                                ${driver.keywords && driver.keywords.length > 0 ? driver.keywords.slice(0, 3).map(kw => 
                                    `<span class="digest-tag">${kw}</span>`
                                ).join('') : ''}
                            </div>
                        </div>
                    </div>
                `).join('')
                : '<p class="text-gray-600">No deal drivers available at this time.</p>';

            const quickIntelHtml = data.quick_intel && data.quick_intel.length > 0
                ? data.quick_intel.map(intel => `
                    <div class="border-l-3 border-purple-300 pl-4 py-2 mb-3">
                        <strong class="text-purple-700">${intel.category}:</strong> ${intel.insight}
                    </div>
                `).join('')
                : '';

            const actionItemsHtml = data.action_items && data.action_items.length > 0
                ? data.action_items.map(item => `
                    <div class="digest-item">
                        <div class="digest-item-number text-purple-600">${item.priority}.</div>
                        <div>
                            <p class="font-semibold text-gray-800">${item.action}</p>
                            <p class="text-gray-600 text-sm mt-1">${item.why}</p>
                        </div>
                    </div>
                `).join('')
                : '';

            return `
                <div class="digest-card results-card">
                    <div class="results-card-body">
                        <div class="digest-header">
                            <img src="/images/arti_right.png" alt="AskArti">
                            <div>
                                <h2>Daily Sales Intelligence</h2>
                                <div class="digest-header-meta">${data.digest_date || 'Today'}</div>
                            </div>
                        </div>
                        
                        ${data.key_intelligence ? `
                        <div class="bg-purple-50 border-l-4 border-purple-400 p-4 mb-6 rounded">
                            <p class="text-purple-900 font-medium">${data.key_intelligence}</p>
                        </div>
                        ` : ''}

                        <div class="digest-section">
                            <h3 class="digest-section-title">Deal Drivers</h3>
                            ${dealDriversHtml}
                        </div>

                        ${quickIntelHtml ? `
                        <div class="digest-section">
                            <h3 class="digest-section-title">Quick Intel</h3>
                            ${quickIntelHtml}
                        </div>
                        ` : ''}

                        ${actionItemsHtml ? `
                        <div class="digest-section">
                            <h3 class="digest-section-title">Your Moves Today</h3>
                            ${actionItemsHtml}
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        renderSalesPlaybook(data) {
            const personasHtml = data.target_personas && data.target_personas.length > 0
                ? data.target_personas.map((persona, index) => {
                    const initials = persona.persona_title.split(' ').map(word => word[0]).join('').substring(0, 2);
                    const colors = ['bg-purple-100 text-purple-700', 'bg-blue-100 text-blue-700', 'bg-green-100 text-green-700', 'bg-yellow-100 text-yellow-700'];
                    const color = colors[index % colors.length];
                    
                    return `
                        <div class="border rounded-lg p-4 mb-4">
                            <div class="flex items-start gap-3 mb-3">
                                <div class="playbook-persona-circle ${color} w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm">${initials}</div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-900">${persona.persona_title}</h4>
                                    <div class="text-sm text-gray-600 mt-1">
                                        <strong>Priorities:</strong> ${persona.business_priorities.join(', ')}
                                    </div>
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <div>
                                    <h5 class="text-sm font-semibold text-gray-700 mb-1">Conversation Starters:</h5>
                                    <ul class="text-sm text-gray-600 list-disc list-inside space-y-1">
                                        ${persona.conversation_starters.map(q => `<li>${q}</li>`).join('')}
                                    </ul>
                                </div>
                                
                                ${persona.objections_responses && persona.objections_responses.length > 0 ? `
                                <div>
                                    <h5 class="text-sm font-semibold text-gray-700 mb-1">Objection Handling:</h5>
                                    ${persona.objections_responses.map(obj => `
                                        <div class="bg-gray-50 p-3 rounded mb-2">
                                            <p class="text-sm font-medium text-gray-700">ðŸš« "${obj.objection}"</p>
                                            <p class="text-sm text-gray-600 mt-1">âœ… ${obj.response}</p>
                                        </div>
                                    `).join('')}
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                }).join('')
                : '';

            return `
                <div class="results-card">
                    <div class="results-card-header">
                        <div class="flex justify-between items-center">
                            <div>
                                <h2 class="text-xl font-bold text-gray-900">${data.sales_play_title || 'Sales Playbook'}</h2>
                                <p class="text-sm text-gray-600 mt-1">${data.sales_play_summary || ''}</p>
                            </div>
                            <button class="copy-playbook-btn btn btn-secondary" onclick="window.askArti.copyPlaybook(this)">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                                </svg>
                                Copy Playbook
                            </button>
                        </div>
                    </div>
                    
                    <div class="results-card-body playbook-content">
                       ${data.key_services && data.key_services.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Key Services & Solutions</h3>
                            <div class="grid gap-2">
                                ${data.key_services.map(service => `
                                    <div class="bg-blue-50 border-l-3 border-blue-400 p-3 rounded">
                                        <p class="text-gray-800">${service}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.key_partners && data.key_partners.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Strategic Partners</h3>
                            <div class="flex flex-wrap gap-2">
                                ${data.key_partners.map(partner => `
                                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">${partner}</span>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.competitive_positioning ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Competitive Positioning</h3>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <p class="text-gray-800">${data.competitive_positioning}</p>
                            </div>
                        </div>
                        ` : ''}

                        ${data.success_metrics && data.success_metrics.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Success Metrics</h3>
                            <div class="grid gap-3">
                                ${data.success_metrics.map((metric, i) => `
                                    <div class="flex items-start">
                                        <span class="text-green-600 mr-2">âœ“</span>
                                        <p class="text-gray-700">${metric}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${personasHtml ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Target Personas</h3>
                            ${personasHtml}
                        </div>
                        ` : ''}

                        ${data.insider_tips && data.insider_tips.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Insider Tips</h3>
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <ul class="space-y-2">
                                    ${data.insider_tips.map(tip => `
                                        <li class="flex items-start">
                                            <span class="text-yellow-600 mr-2">ðŸ’¡</span>
                                            <p class="text-gray-700 text-sm">${tip}</p>
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>
                        </div>
                        ` : ''}

                        ${data.next_actions && data.next_actions.length > 0 ? `
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Next Actions</h3>
                            <div class="space-y-2">
                                ${data.next_actions.map((action, i) => `
                                    <div class="bg-purple-50 border-l-3 border-purple-400 p-3 rounded">
                                        <p class="font-medium text-gray-800">${i + 1}. ${action}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        renderNewsAdvice(data) {
            const immediateActionsHtml = data.immediate_actions && data.immediate_actions.length > 0
                ? data.immediate_actions.map((item, i) => `
                    <div class="bg-blue-50 p-4 rounded-lg mb-3">
                        <p class="font-semibold text-gray-800 mb-1">${i + 1}. ${item.action}</p>
                        <p class="text-sm text-gray-600">Why: ${item.why}</p>
                    </div>
                `).join('')
                : '';

            const strategicMovesHtml = data.strategic_moves && data.strategic_moves.length > 0
                ? data.strategic_moves.map((item, i) => `
                    <div class="bg-purple-50 p-4 rounded-lg mb-3">
                        <p class="font-semibold text-gray-800 mb-1">${i + 1}. ${item.action}</p>
                        <p class="text-sm text-gray-600">Why: ${item.why}</p>
                    </div>
                `).join('')
                : '';

            return `
                <div class="results-card">
                    <div class="results-card-header">
                        <h2 class="text-xl font-bold text-gray-900">News Analysis & GTM Strategy</h2>
                    </div>
                    
                    <div class="results-card-body">
                        ${data.quick_take ? `
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded">
                            <p class="text-gray-800 font-medium">${data.quick_take}</p>
                        </div>
                        ` : ''}

                        ${data.background ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Background</h3>
                            <p class="text-gray-700">${data.background}</p>
                        </div>
                        ` : ''}

                        ${data.implications ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Market Implications</h3>
                            <p class="text-gray-700">${data.implications}</p>
                        </div>
                        ` : ''}

                        ${data.key_people_and_titles && data.key_people_and_titles.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Key People Mentioned</h3>
                            <div class="space-y-2">
                                ${data.key_people_and_titles.map(person => `
                                    <div class="flex items-center">
                                        <span class="text-blue-600 mr-2">ðŸ‘¤</span>
                                        <span class="text-gray-700">${person}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.agencies_involved && data.agencies_involved.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Agencies Involved</h3>
                            <div class="flex flex-wrap gap-2">
                                ${data.agencies_involved.map(agency => `
                                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">${agency}</span>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.suggested_discovery_questions && data.suggested_discovery_questions.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Discovery Questions</h3>
                            <ul class="space-y-2">
                                ${data.suggested_discovery_questions.map(q => `
                                    <li class="flex items-start">
                                        <span class="text-green-600 mr-2 mt-1">?</span>
                                        <p class="text-gray-700">${q}</p>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                        ` : ''}

                        ${immediateActionsHtml ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Immediate Actions</h3>
                            ${immediateActionsHtml}
                        </div>
                        ` : ''}

                        ${strategicMovesHtml ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Strategic Moves</h3>
                            ${strategicMovesHtml}
                        </div>
                        ` : ''}

                        ${data.mermaid_chart ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">GTM Strategy Visualization</h3>
                            <div class="mermaid-container">
                                <pre class="mermaid">${data.mermaid_chart}</pre>
                            </div>
                        </div>
                        ` : ''}

                        ${data.next_steps ? `
                        <div class="bg-purple-100 border border-purple-300 rounded-lg p-4">
                            <p class="text-purple-900 font-medium">ðŸŽ¯ ${data.next_steps}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        renderMarketAnalysis(data) {
            const bullSignalsHtml = data.bull_signals && data.bull_signals.length > 0
                ? data.bull_signals.map(signal => `
                    <li class="flex items-start">
                        <span class="text-green-600 mr-2">ðŸ“ˆ</span>
                        <span class="text-gray-700">${signal}</span>
                    </li>
                `).join('')
                : '';

            const bearSignalsHtml = data.bear_signals && data.bear_signals.length > 0
                ? data.bear_signals.map(signal => `
                    <li class="flex items-start">
                        <span class="text-red-600 mr-2">ðŸ“‰</span>
                        <span class="text-gray-700">${signal}</span>
                    </li>
                `).join('')
                : '';

            return `
                <div class="results-card">
                    <div class="results-card-header">
                        <h2 class="text-xl font-bold text-gray-900">Investment Analysis</h2>
                    </div>
                    
                    <div class="results-card-body">
                        ${data.investment_thesis ? `
                        <div class="bg-purple-50 border-l-4 border-purple-400 p-4 mb-6 rounded">
                            <p class="text-gray-800 font-medium">${data.investment_thesis}</p>
                        </div>
                        ` : ''}

                        ${data.executive_summary ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Executive Summary</h3>
                            <p class="text-gray-700">${data.executive_summary}</p>
                        </div>
                        ` : ''}

                        ${data.key_financial_metrics && data.key_financial_metrics.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Key Financial Metrics</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                ${data.key_financial_metrics.map(metric => `
                                    <div class="bg-gray-50 p-3 rounded-lg">
                                        <p class="text-gray-800 font-medium">${metric}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            ${bullSignalsHtml ? `
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900 mb-3">Bull Signals</h3>
                                <ul class="space-y-2">${bullSignalsHtml}</ul>
                            </div>
                            ` : ''}

                            ${bearSignalsHtml ? `
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900 mb-3">Bear Signals</h3>
                                <ul class="space-y-2">${bearSignalsHtml}</ul>
                            </div>
                            ` : ''}
                        </div>

                        ${data.bull_case ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Bull Case</h3>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <p class="text-gray-700">${data.bull_case}</p>
                            </div>
                        </div>
                        ` : ''}

                        ${data.bear_case ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Bear Case</h3>
                            <div class="bg-red-50 p-4 rounded-lg">
                                <p class="text-gray-700">${data.bear_case}</p>
                            </div>
                        </div>
                        ` : ''}

                        ${data.next_catalyst ? `
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <p class="text-blue-900 font-medium">ðŸ”® Next Catalyst: ${data.next_catalyst}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        renderProspectAdvice(data) {
            return `
                <div class="results-card">
                    <div class="results-card-header">
                        <h2 class="text-xl font-bold text-gray-900">Prospecting Intelligence</h2>
                    </div>
                    
                    <div class="results-card-body">
                        ${data.summary ? `
                        <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded">
                            <p class="text-gray-800">${data.summary}</p>
                        </div>
                        ` : ''}

                        ${data.top_s_is && data.top_s_is.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Top Service Providers</h3>
                            <div class="space-y-3">
                                ${data.top_s_is.map(si => `
                                    <div class="border-l-3 border-purple-300 pl-4">
                                        <p class="font-semibold text-gray-800">${si.company}</p>
                                        <p class="text-sm text-gray-600">${si.value}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.top_software_and_cloud && data.top_software_and_cloud.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Software & Cloud Solutions</h3>
                            <div class="space-y-3">
                                ${data.top_software_and_cloud.map(sw => `
                                    <div class="border-l-3 border-blue-300 pl-4">
                                        <p class="font-semibold text-gray-800">${sw.company}</p>
                                        <p class="text-sm text-gray-600">${sw.value}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.naics_codes && data.naics_codes.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Relevant NAICS Codes</h3>
                            <div class="grid gap-2">
                                ${data.naics_codes.map(naics => `
                                    <div class="bg-gray-50 p-3 rounded-lg">
                                        <p class="text-gray-800">${naics}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.prospect_recommendations && data.prospect_recommendations.length > 0 ? `
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Recommendations</h3>
                            <div class="space-y-2">
                                ${data.prospect_recommendations.map((rec, i) => `
                                    <div class="bg-purple-50 border-l-3 border-purple-400 p-3 rounded">
                                        <p class="font-medium text-gray-800">${i + 1}. ${rec}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        renderGeneralAdvice(data) {
            const keyMovesHtml = data.key_moves && data.key_moves.length > 0
                ? data.key_moves.map((move, i) => `
                    <div class="bg-blue-50 p-4 rounded-lg mb-3">
                        <p class="font-semibold text-gray-800 mb-1">${i + 1}. ${move.action}</p>
                        <p class="text-sm text-gray-600">Why: ${move.why}</p>
                    </div>
                `).join('')
                : '';

            return `
                <div class="results-card">
                    <div class="results-card-header">
                        <h2 class="text-xl font-bold text-gray-900">${this.getCardTitle(data.response_type)}</h2>
                    </div>
                    
                    <div class="results-card-body">
                        ${data.quick_take ? `
                        <div class="bg-purple-50 border-l-4 border-purple-400 p-4 mb-6 rounded">
                            <p class="text-gray-800">${data.quick_take}</p>
                        </div>
                        ` : ''}

                        ${keyMovesHtml ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Key Moves</h3>
                            ${keyMovesHtml}
                        </div>
                        ` : ''}

                        ${data.talking_points && data.talking_points.length > 0 ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Talking Points</h3>
                            <ul class="space-y-2">
                                ${data.talking_points.map(point => `
                                    <li class="flex items-start">
                                        <span class="text-green-600 mr-2 mt-1">â€¢</span>
                                        <p class="text-gray-700">${point}</p>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                        ` : ''}

                        ${data.email_template ? `
                        <div class="mb-6 copy-target">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Email Template</h3>
                            <div class="bg-gray-50 p-4 rounded-lg relative">
                                <button class="copy-btn">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                                    </svg>
                                </button>
                                <pre class="whitespace-pre-wrap text-gray-700 text-sm copy-target">${data.email_template}</pre>
                            </div>
                        </div>
                        ` : ''}

                        ${data.mermaid_chart ? `
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Process Flow</h3>
                            <div class="mermaid-container">
                                <pre class="mermaid">${data.mermaid_chart}</pre>
                            </div>
                        </div>
                        ` : ''}

                        ${data.next_steps ? `
                        <div class="bg-purple-100 border border-purple-300 rounded-lg p-4">
                            <p class="text-purple-900 font-medium">ðŸŽ¯ ${data.next_steps}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        getCardTitle(responseType) {
            const titles = {
                'deal': 'Deal Strategy',
                'interview': 'Interview Preparation',
                'meeting': 'Meeting Strategy'
            };
            return titles[responseType] || 'Strategic Advice';
        }

        copyPlaybook(button) {
            const playbookContent = button.closest('.results-card').querySelector('.playbook-content');
            if (playbookContent) {
                const textContent = playbookContent.innerText;
                navigator.clipboard.writeText(textContent).then(() => {
                    const originalContent = button.innerHTML;
                    button.innerHTML = `
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        Copied!
                    `;
                    button.classList.add('bg-green-100', 'text-green-700', 'border-green-300');
                    
                    setTimeout(() => {
                        button.innerHTML = originalContent;
                        button.classList.remove('bg-green-100', 'text-green-700', 'border-green-300');
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy playbook:', err);
                });
            }
        }
    }

    // Initialize the app when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
        const app = new AskArti();
        window.askArti = app; // Make it globally accessible for button handlers
    });
    </script>
</body>
</html> 