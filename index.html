<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AskArti - Your Federal Sales Buddy | Free Sales Strategy Tool</title>
    <!-- Primary Meta Tags -->
    <meta name="description" content="Get personalized federal sales advice from AskArti. Free AI tool provides SMART goals, customer messaging, and deal strategies for government contractors and sales professionals.">
    <meta name="keywords" content="federal sales, government sales, AI sales coach, sales strategy, federal contractors, govcon, sales advice">
    <meta name="author" content="Mark">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://askarti.com">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://askarti.com/">
    <meta property="og:title" content="AskArti - Your Federal Sales Buddy">
    <meta property="og:description" content="Get personalized federal sales advice from AskArti. Free AI tool provides SMART goals, customer messaging, and deal strategies for government contractors and sales professionals.">
    <meta property="og:image" content="https://askarti.com/images/asklite.png">
    <meta property="og:image:alt" content="AskArti Logo">
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://askarti.com/">
    <meta name="twitter:title" content="AskArti - Your Federal Sales Buddy">
    <meta name="twitter:description" content="Get personalized federal sales advice from AskArti. Free AI tool provides SMART goals, customer messaging, and deal strategies for government contractors and sales professionals.">
    <meta name="twitter:image" content="https://askarti.com/images/asklite.png">
    <meta name="twitter:image:alt" content="AskArti Logo">
    <!-- Favicon files -->
    <link rel="icon" href="/images/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="theme-color" content="#523f9e">
    <!-- Chrome Android icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="/images/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/images/android-chrome-512x512.png">
    <!-- Resource hints for faster loading -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Preload critical assets -->
    <link rel="preload" href="/images/asklite.png" as="image">
    <link rel="preload" href="/images/arti_right.png" as="image">
    <!-- Styles and scripts with optimized loading -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"></noscript>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WLGEPY5H4G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-WLGEPY5H4G');
    </script>
	<script>
        tailwind.config = {
            content: ['./**/*.{html,js}'],
            theme: {
                extend: {
                    colors: {
                        primary: '#523f9e',
                        customPurple: {
                            100: '#978bc4',
                            200: '#7465b1',
                            500: '#523f9e',
                            700: '#41327e',
                            900: '#31255e'
                        }
                    }
                }
            },
            variants: {
                extend: {},
            },
            plugins: [],
            corePlugins: {
                container: false,
                objectFit: false
            }
        }
    </script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        window.mermaid = mermaid;
        mermaid.initialize({
            startOnLoad: false,
            theme: 'base',
            themeVariables: {
                primaryColor: '#e9e5f5',
                primaryTextColor: '#31255e',
                primaryBorderColor: '#523f9e',
                lineColor: '#7465b1', 
                secondaryColor: '#f3f4f6',
                tertiaryColor: '#e9e5f5'
            },
            flowchart: {
                classDef: {
                    'highlight': 'fill:#7465b1,stroke:#31255e,stroke-width:2px,color:#ffffff'
                }
            }
        });
    </script>
	<style>
        /* Base styles */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        /* Consolidated animations */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes successPulse {
            0% { box-shadow: 0 0 0 0 rgba(82, 63, 158, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(82, 63, 158, 0); }
            100% { box-shadow: 0 0 0 0 rgba(82, 63, 158, 0); }
        }
        
        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Common element styles */
        .loader, .results-loader {
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        .loader {
            border: 2px solid #e5e7eb;
            border-top: 2px solid #523f9e;
            width: 20px;
            height: 20px;
        }
        
        .results-loader {
            border: 3px solid #e5e7eb;
            border-top: 3px solid #523f9e;
            width: 32px;
            height: 32px;
        }
        
        /* Button styles */
        .prompt-btn {
            transition: all 0.2s ease;
            transform: translateY(0);
        }
        
        .prompt-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Modal animations */
        .modal-backdrop, .modal-content {
            transition: all 0.2s ease;
            opacity: 0;
        }
        
        .modal-backdrop.show {
            opacity: 1;
        }
        
        .modal-content {
            transform: scale(0.95);
        }
        
        .modal-content.show {
            transform: scale(1);
            opacity: 1;
        }
        
        /* Animation classes */
        .success-pulse {
            animation: successPulse 1.5s ease-out;
        }
        
        .error-shake {
            animation: errorShake 0.6s ease-in-out;
        }
        
        /* Utility classes */
        .clear-none {
            clear: none;
        }
        
        /* Responsive adjustments */
        @media (max-width: 640px) {
            .responsive-text {
                font-size: 0.9rem;
            }
            .responsive-heading {
                font-size: 1.1rem;
            }
        }
        
        /* Widget tab styles */
        .widget-tab {
            transition: all 0.2s ease-in-out;
        }
        
        .widget-tab.active {
            background-color: rgba(151, 139, 196, 0.3);
            color: #41327e;
            border-color: #523f9e;
        }
        
        /* Form input styles */
        .qual-option-label:has(input:checked) {
            background-color: #523f9e;
            color: white;
            border-color: #523f9e;
        }
        
        /* Mermaid diagram styling */
        .mermaid {
            display: flex;
            justify-content: center;
            background: #f9fafb;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
            overflow-x: auto;
        }
        
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
        
        /* Custom Mermaid theme colors */
        .mermaid .node rect,
        .mermaid .node circle,
        .mermaid .node ellipse,
        .mermaid .node polygon {
            fill: #e9e5f5 !important;
            stroke: #523f9e !important;
            stroke-width: 2px !important;
        }
        
        .mermaid .edgeLabel {
            background-color: white !important;
            padding: 0.25rem !important;
            border-radius: 0.25rem !important;
        }
        
        .mermaid .flowchart-link {
            stroke: #7465b1 !important;
            stroke-width: 2px !important;
        }
        
        @media (max-width: 640px) {
            .mermaid {
                padding: 1rem;
                font-size: 0.875rem;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <div class="max-w-screen-lg mx-auto px-4 sm:px-6 lg:px-8 pt-3 pb-32">
        <header class="text-center mb-3">
            <div class="flex justify-center items-center mb-1">
               <a href="/" aria-label="Refresh AskArti"><img src="/images/asklite.png" alt="AskArti Logo" class="h-16 w-auto md:h-20 lg:h-24 max-w-full"></a>
            </div>
        </header>
        <main id="main-form" class="bg-white rounded-xl border border-gray-200 p-4 sm:p-6 mb-4 shadow-sm">
            <div class="space-y-3">
                <div>
                    <label for="situation-input" class="block text-sm font-medium text-gray-700 mb-1 text-center">Hi, I'm Arti, your 24/7 sales buddy. Tough quarter? Ghosted? Big interview? Let's crush it.</label>
                    <textarea id="situation-input" rows="4" class="w-full p-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none placeholder-gray-400" placeholder="Stuck selling cyber to DHS. Champion went dark. CIO loves a rival. Or try: 'Find prospects for Cloud at DHS' or 'Help me prep for an interview with XYZ.'"></textarea>
                </div>
            </div>
            <div id="canned-prompts" class="mt-4">
    <div class="flex flex-wrap justify-center gap-1.5">
    <button class="prompt-btn px-3 py-1.5 bg-customPurple-100/30 hover:bg-customPurple-100/50 rounded-full border border-customPurple-200/30 transition-colors text-sm text-customPurple-500 font-medium" 
            data-full-text="COTR at Treasury ghosted me after seeing $3M price. Need this for quota. Already did tech reviews. Boss thinks I can't sell.">
        Buyer went dark...
    </button>
    <button class="prompt-btn px-3 py-1.5 bg-customPurple-100/30 hover:bg-customPurple-100/50 rounded-full border border-customPurple-200/30 transition-colors text-sm text-customPurple-500 font-medium"
            data-full-text="Demo crashed at DOJ FedRAMP review. Champion looks like an idiot. Lead engineer called us vaporware. Need damage control ASAP.">
        Demo disaster...
    </button>
    <button class="prompt-btn px-3 py-1.5 bg-customPurple-100/30 hover:bg-customPurple-100/50 rounded-full border border-customPurple-200/30 transition-colors text-sm text-customPurple-500 font-medium"
            data-full-text="Prime wants 15% more margin on DHS deal. Customer knows we're overpriced. They're threatening to replace us with cheaper vendor. Need negotiation plan.">
        Partner drama...
    </button>
    <button class="prompt-btn px-3 py-1.5 bg-customPurple-100/30 hover:bg-customPurple-100/50 rounded-full border border-customPurple-200/30 transition-colors text-sm text-customPurple-500 font-medium"
            data-full-text="AWS interview tomorrow for Navy AE role. Need STAR story for my $2.7M cloud deal. Help with leadership principles.">
        Job Interview...
    </button>
    <button class="prompt-btn px-3 py-1.5 bg-customPurple-100/30 hover:bg-customPurple-100/50 rounded-full border border-customPurple-200/30 transition-colors text-sm text-customPurple-500 font-medium"
            data-full-text="QBR with DHS next week. Low adoption, bad ROI, missing features. CISO supports us but has no power. IT Director loves competitor. Renewal at risk.">
        Meeting Prep...
    </button>
    <button class="prompt-btn px-3 py-1.5 bg-customPurple-100/30 hover:bg-customPurple-100/50 rounded-full border border-customPurple-200/30 transition-colors text-sm text-customPurple-500 font-medium"
            data-full-text="Selling AI/ML to VA. Need programs to target, contract vehicles, who the primes are, and any inside track.">
        Prospecting...
    </button>
</div>
</div>
        </main>
        <div class="fixed bottom-6 left-1/2 transform -translate-x-1/2 z-10">
            <button id="generate-btn" class="bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium py-3 px-8 rounded-full transition-colors flex items-center gap-2 shadow-lg">
                <span id="btn-text">Ask Arti</span>
                <div id="loader" class="loader hidden"></div>
            </button>
        </div>
        <div id="results-container">
        </div>
        <footer class="text-center pt-3">
            <div class="flex justify-center gap-4 text-sm mb-2">
                <button id="trust-btn" class="text-customPurple-500 hover:text-customPurple-700 font-medium">Privacy</button>
                <button id="sponsor-btn" class="text-customPurple-500 hover:text-customPurple-700 font-medium">Sponsor</button>
                <button id="human-btn" class="text-customPurple-500 hover:text-customPurple-700 font-medium">Connect</button>
                <button id="share-btn" class="text-customPurple-500 hover:text-customPurple-700 font-medium">Share</button>
                <button id="tools-btn" class="text-customPurple-500 hover:text-customPurple-700 font-medium">Tools</button>
            </div>
            <p class="text-xs text-gray-400">AskArti.com results are provided for informational and educational purposes only and do not constitute professional business advice. AI can make errors or provide recommendations that may not suit your specific situation. Please consult qualified professionals before making important business decisions.</p>
            <br>
            <p class="text-xs text-gray-400">© 2025 AskArti. Made for Sellers by Sellers.</p>
            <div class="mt-4 flex justify-center">
                <a href="https://aws.amazon.com/what-is-cloud-computing" target="_blank" rel="noopener noreferrer">
                    <img src="https://d0.awsstatic.com/logos/powered-by-aws.png" alt="Powered by AWS Cloud Computing" style="width: 80px; height: auto;">
                </a>
            </div>
        </footer>
    </div>
	<!-- SPONSOR MODAL -->
    <div id="sponsor-modal" class="hidden fixed inset-0 bg-black/50 modal-backdrop flex items-center justify-center p-4 z-50">
        <div id="sponsor-modal-content" class="bg-white rounded-2xl shadow-xl w-full max-w-md modal-content max-h-[80vh] overflow-y-auto">
            <header class="p-4 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10">
                <h2 class="text-base font-bold text-gray-900 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Sponsor AskArti
                </h2>
                <button id="close-sponsor-modal-btn" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </header>
            <main class="p-4 space-y-4 text-sm">
                <p class="text-xs text-gray-600">Reach federal sales professionals with our tiered sponsorship options:</p>
                <!-- Premium Plan -->
                <div class="bg-customPurple-100/10 border border-customPurple-100/40 rounded-lg p-3">
                    <div class="flex justify-between items-center mb-1">
                        <h4 class="font-semibold text-customPurple-900">Premium</h4>
                        <span class="text-customPurple-700 font-semibold">$299/mo</span>
                    </div>
                    <ul class="space-y-0.5 text-xs text-gray-700">
                        <li class="flex items-start gap-1.5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-customPurple-500 mt-0.5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Top banner position</span>
                        </li>
                        <li class="flex items-start gap-1.5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-customPurple-500 mt-0.5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Category exclusivity</span>
                        </li>
                    </ul>
                </div>
                <!-- Standard Plan -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-3">
                    <div class="flex justify-between items-center mb-1">
                        <h4 class="font-semibold text-gray-900">Standard</h4>
                        <span class="text-customPurple-500 font-semibold">$199/mo</span>
                    </div>
                    <ul class="space-y-0.5 text-xs text-gray-700">
                        <li class="flex items-start gap-1.5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-customPurple-500 mt-0.5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Mid-content placement</span>
                        </li>
                        <li class="flex items-start gap-1.5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-customPurple-500 mt-0.5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Monthly performance report</span>
                        </li>
                    </ul>
                </div>
                <!-- Starter Plan -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-3">
                    <div class="flex justify-between items-center mb-1">
                        <h4 class="font-semibold text-gray-900">Starter</h4>
                        <span class="text-customPurple-500 font-semibold">$99/mo</span>
                    </div>
                    <ul class="space-y-0.5 text-xs text-gray-700">
                        <li class="flex items-start gap-1.5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-customPurple-500 mt-0.5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Footer placement</span>
                        </li>
                        <li class="flex items-start gap-1.5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-customPurple-500 mt-0.5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            <span>10% off yearly</span>
                        </li>
                    </ul>
                </div>
                <!-- Call-to-action -->
                <div class="border-t border-gray-200 pt-3">
                    <a href="mailto:mark@subhoo.com?subject=AskArti Sponsorship Inquiry" class="w-full inline-flex items-center justify-center gap-2 bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium py-2.5 px-4 rounded-lg transition-colors text-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                        </svg>
                        Contact mark@subhoo.com
                    </a>
                </div>
            </main>
        </div>
    </div>
	<!-- Human Consultation Modal -->
    <div id="human-modal" class="hidden fixed inset-0 bg-black/50 modal-backdrop flex items-center justify-center p-4 z-50">
        <div id="human-modal-content" class="bg-white rounded-2xl shadow-xl w-full max-w-md modal-content">
            <header class="p-6 border-b border-gray-200 flex justify-between items-center">
                <h2 class="text-lg font-bold text-gray-900 flex items-center gap-2">
                    <img src="images/mark.png" alt="Mark Flournoy" class="w-6 h-6 rounded-full object-cover">
                    Hi, I'm Mark, creator of AskArti.
                </h2>
                <button id="close-human-modal-btn" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </header>
            <main class="p-6 space-y-6 text-gray-700">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-8 h-8 rounded-xl bg-customPurple-100/30 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900">I've Been There</h3>
                        <p class="text-sm mt-1 text-gray-600">I've worked federal deals for decades as a mission-owner, COTR, and seller.</p>
                    </div>
                </div>
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-8 h-8 rounded-xl bg-customPurple-100/30 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900">Strategy & Deal Reviews</h3>
                        <p class="text-sm mt-1 text-gray-600">Get help with deal strategy, GTM planning, competitive positioning, or just talk through what's blocking your federal sales.</p>
                    </div>
                </div>
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-8 h-8 rounded-xl bg-customPurple-100/30 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900">Free 30-Minute Intro Call</h3>
                        <p class="text-sm mt-1 text-gray-600">No strings attached. Just a conversation about your federal sales challenges and how I might be able to help.</p>
                    </div>
                </div>
                <div class="border-t border-gray-200 pt-4">
                    <a href="https://calendly.com/markflournoy/30min" target="_blank" class="w-full inline-flex items-center justify-center gap-2 bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium py-3 px-4 rounded-xl transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                        Schedule Free Call
                    </a>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Trust/Privacy Modal -->
    <div id="trust-modal" class="hidden fixed inset-0 bg-black/50 modal-backdrop flex items-center justify-center p-4 z-50">
        <div id="trust-modal-content" class="bg-white rounded-2xl shadow-xl w-full max-w-md modal-content">
            <header class="p-6 border-b border-gray-200 flex justify-between items-center">
                <h2 class="text-lg font-bold text-gray-900 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                    Privacy
                </h2>
                <button id="close-trust-modal-btn" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </header>
            <main class="p-6 space-y-6 text-gray-700">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-8 h-8 rounded-xl bg-customPurple-100/30 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900">Your Data</h3>
                        <p class="text-sm mt-1 text-gray-600">We do not store, log, or persist any prompt or response data. All processing occurs in-memory using AWS Lambda and is discarded after execution.</p>
                    </div>
                </div>
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-8 h-8 rounded-xl bg-customPurple-100/30 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v6a2 2 0 002 2h14a2 2 0 002-2v-6a2 2 0 00-2-2m-2-4h.01M17 16h.01" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900">AI Model Information</h3>
                        <p class="text-sm mt-1 text-gray-600">AskArti uses models that may include Gemini, Claude, and ChatGPT. These models may use API inputs to improve responses.</p>
                    </div>
                </div>
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-8 h-8 rounded-xl bg-customPurple-100/30 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900">How Recommendations Work</h3>
                        <p class="text-sm mt-1 text-gray-600">AskArti provides AI-generated sales advice for informational and educational purposes only and does not constitute professional business advice. Users should exercise their own judgment and consider consulting qualified professionals before making important business decisions.</p>
                    </div>
                </div>
            </main>
        </div>
    </div>
	<!-- Bonus Tools Modal -->
    <div id="bonus-tools-modal" class="hidden fixed inset-0 bg-black/50 modal-backdrop flex items-center justify-center p-4 z-50">
        <div id="bonus-tools-modal-content" class="bg-white rounded-2xl shadow-xl w-full max-w-md modal-content">
            <header class="p-6 border-b border-gray-200 flex justify-between items-center">
                <h2 class="text-lg font-bold text-gray-900 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-customPurple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 5z" />
                    </svg>
                    Sales Tools
                </h2>
                <button id="close-bonus-tools-modal-btn" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </header>
            <main class="p-4">
                <!-- Tabs -->
                <div class="flex border-b border-slate-200">
                    <button class="widget-tab flex-1 py-3 px-2 text-sm font-semibold text-slate-600 border-b-2 border-transparent active" data-widget="fy-countdown">FY Countdown</button>
                    <button class="widget-tab flex-1 py-3 px-2 text-sm font-semibold text-slate-600 border-b-2 border-transparent" data-widget="qual-scorecard">Qual Scorecard</button>
                    <button class="widget-tab flex-1 py-3 px-2 text-sm font-semibold text-slate-600 border-b-2 border-transparent" data-widget="golden-hour">Golden Hour</button>
                </div>
                <!-- Widget Content -->
                <div class="p-4">
                    <!-- FY Countdown Widget -->
                    <div id="fy-countdown" class="widget-content">
                        <div class="text-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800 tracking-tight">Q4 Spending Season</h3>
                            <p id="fy-fiscal-year" class="text-customPurple-500 font-semibold text-lg"></p>
                        </div>
                        <div id="fy-countdown-wrapper">
                            <p class="text-center text-gray-600 mb-3">Days Remaining</p>
                            <div class="grid grid-cols-4 gap-2 md:gap-4 text-center mb-6">
                                <div><div class="fy-timer-box rounded-lg p-3 bg-gray-50 border border-gray-200"><div id="fy-days" class="text-3xl font-black text-slate-800">00</div></div><div class="text-xs text-gray-500 mt-2">Days</div></div>
                                <div><div class="fy-timer-box rounded-lg p-3 bg-gray-50 border border-gray-200"><div id="fy-hours" class="text-3xl font-black text-slate-800">00</div></div><div class="text-xs text-gray-500 mt-2">Hours</div></div>
                                <div><div class="fy-timer-box rounded-lg p-3 bg-gray-50 border border-gray-200"><div id="fy-minutes" class="text-3xl font-black text-slate-800">00</div></div><div class="text-xs text-gray-500 mt-2">Minutes</div></div>
                                <div><div class="fy-timer-box rounded-lg p-3 bg-gray-50 border border-gray-200"><div id="fy-seconds" class="text-3xl font-black text-slate-800">00</div></div><div class="text-xs text-gray-500 mt-2">Seconds</div></div>
                            </div>
                        </div>
                        <div id="fy-yearend-message" class="hidden text-center py-8"><h2 class="text-2xl font-bold text-green-600">FY-End Complete!</h2><p class="text-gray-600 mt-2">Time to start planning for the new Fiscal Year.</p></div>
                        <div class="mb-6"><div class="flex justify-between mb-1"><span class="text-sm font-medium text-gray-700">Q4 Progress</span><span id="fy-progress-percent" class="text-sm font-medium text-gray-700">0%</span></div><div class="w-full bg-gray-200 rounded-full h-2.5"><div id="fy-progress-bar" class="bg-customPurple-500 h-2.5 rounded-full" style="width: 0%"></div></div></div>
                        <div class="bg-customPurple-100/20 p-4 rounded-lg border border-customPurple-200/30"><h3 class="font-bold text-customPurple-700 mb-2">Strategic Focus</h3><p id="fy-pro-tip" class="text-sm text-gray-700">Loading tip...</p></div>
                    </div>
                    <!-- Qual Scorecard Widget -->
                    <div id="qual-scorecard" class="widget-content hidden">
                        <div class="text-center mb-3">
                            <h3 class="text-lg font-bold text-gray-800">Lead Qualification Scorecard</h3>
                            <p class="text-xs text-gray-600 mt-1">Score leads to prioritize your pipeline</p>
                        </div>
                        <div id="qual-form" class="space-y-3">
                            <!-- Budget Question - More Compact -->
                            <div class="border-b pb-2 border-gray-100">
                                <div class="flex justify-between items-center mb-1">
                                    <p class="text-sm font-medium text-gray-700">Budget</p>
                                    <div class="flex space-x-1">
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[40px]">
                                            <input type="radio" name="budget" value="3" class="sr-only"> Yes
                                        </label>
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[40px]">
                                            <input type="radio" name="budget" value="1" class="sr-only"> Maybe
                                        </label>
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[40px]">
                                            <input type="radio" name="budget" value="0" class="sr-only" checked> No
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <!-- Authority Question - More Compact -->
                            <div class="border-b pb-2 border-gray-100">
                                <div class="flex justify-between items-center mb-1">
                                    <p class="text-sm font-medium text-gray-700">Authority</p>
                                    <div class="flex space-x-1">
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[40px]">
                                            <input type="radio" name="authority" value="3" class="sr-only"> Yes
                                        </label>
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[60px]">
                                            <input type="radio" name="authority" value="2" class="sr-only"> Influencer
                                        </label>
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[40px]">
                                            <input type="radio" name="authority" value="0" class="sr-only" checked> No
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <!-- Need Question - More Compact -->
                            <div class="border-b pb-2 border-gray-100">
                                <div class="flex justify-between items-center mb-1">
                                    <p class="text-sm font-medium text-gray-700">Need</p>
                                    <div class="flex space-x-1">
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[40px]">
                                            <input type="radio" name="need" value="3" class="sr-only"> High
                                        </label>
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[40px]">
                                            <input type="radio" name="need" value="2" class="sr-only" checked> Med
                                        </label>
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[40px]">
                                            <input type="radio" name="need" value="0" class="sr-only"> Low
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <!-- Timeline Question - More Compact -->
                            <div class="pb-1">
                                <div class="flex justify-between items-center mb-1">
                                    <p class="text-sm font-medium text-gray-700">Timeline</p>
                                    <div class="flex space-x-1">
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[55px]">
                                            <input type="radio" name="timeline" value="3" class="sr-only"> < 3 Mos
                                        </label>
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[55px]">
                                            <input type="radio" name="timeline" value="1" class="sr-only"> 3-6 Mos
                                        </label>
                                        <label class="qual-option-label cursor-pointer text-center py-1 px-2 rounded text-xs font-medium border border-gray-300 min-w-[55px]">
                                            <input type="radio" name="timeline" value="0" class="sr-only" checked> 6+ Mos
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Result Card - Smaller -->
                        <div id="qual-result-card" class="hidden mt-3 rounded-lg p-4 text-center">
                            <div class="flex items-center justify-center">
                                <div id="qual-result-icon" class="text-3xl mr-2"></div>
                                <div class="text-left">
                                    <h2 id="qual-result-title" class="text-lg font-bold"></h2>
                                    <p id="qual-result-description" class="text-sm"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Golden Hour Widget -->
                    <div id="golden-hour" class="widget-content hidden">
                        <div class="text-center mb-6"><h3 class="text-xl font-bold text-gray-800">Prospect Golden Hour</h3><p class="text-gray-600 mt-2">Find the best time to prospect.</p></div>
                        <div class="mb-4"><label for="gh-timezone-select" class="block mb-2 text-sm font-medium text-slate-700">Prospect's Time Zone:</label><select id="gh-timezone-select" class="bg-gray-50 border border-gray-300 text-slate-900 text-sm rounded-lg focus:ring-customPurple-500 focus:border-customPurple-500 block w-full p-2.5"></select></div>
                        <div id="gh-status-card" class="rounded-xl p-6 text-center"><div id="gh-status-icon" class="text-5xl mb-3 mx-auto"></div><h2 id="gh-status-text" class="text-2xl font-bold mb-1"></h2><p id="gh-prospect-time" class="text-lg font-medium text-slate-600"></p><div class="mt-4 pt-4 border-t border-gray-200"><p id="gh-next-golden-hour" class="text-slate-600"></p><p id="gh-your-time-equivalent" class="text-sm text-slate-500"></p></div></div>
                    </div>
                </div>
            </main>
        </div>
    </div>
	<script>
    // --- Reusable UI component templates ---
    const templates = {
        loadingIndicator: `
            <div class="text-center py-2 mt-2">
                <div class="flex justify-center items-center mb-2">
                    <img src="images/arti_right.png" alt="Arti" class="h-16 w-16 animate-pulse">
                </div>
                <p id="loading-message" class="text-customPurple-500 text-lg font-semibold mb-2">Hang on, I'm Working Backwards...</p>
            </div>
        `,
        sponsorAd: (type) => {
            const ads = {
                premium: {
                    name: 'Subhoo.com',
                    text: 'Helping you avoid teaming partners who still fax NDAs.',
                    url: 'https://subhoo.com'
                },
                standard: {
                    name: 'FastTrack Compliance',
                    text: 'Because waiting 18 months for security clearance is so last century.',
                    url: '#'
                },
                starter: {
                    name: 'DeepPockets Funding',
                    text: 'We find money hiding in the couch cushions of Congress.',
                    url: '#'
                }
            };
            
            const ad = ads[type] || ads.starter;
            
            return `
                <div class="bg-customPurple-100/10 border border-customPurple-100/30 rounded-lg p-2.5 mb-4 text-xs">
                    <div class="flex items-center gap-2">
                        <span class="text-xs font-medium text-customPurple-500 bg-customPurple-100/30 px-1.5 py-0.5 rounded">SPONSOR</span>
                        <a href="${ad.url}" class="text-customPurple-700 font-medium hover:text-customPurple-900">${ad.name}</a>
                    </div>
                    <p class="text-gray-600 text-xs mt-1">${ad.text}</p>
                </div>
            `;
        },
        personaCard: (personaData, colorIndex) => {
            const colors = [
                { bg: 'bg-customPurple-100/20', border: 'border-customPurple-100/40', text: 'text-customPurple-900', icon: 'bg-customPurple-500' },
                { bg: 'bg-customPurple-100/20', border: 'border-customPurple-100/40', text: 'text-customPurple-900', icon: 'bg-customPurple-700' }
            ];
            const color = colors[colorIndex % colors.length];
            
            const talkingPointsHTML = personaData.talking_points.map(point => 
                `<li class="flex items-start gap-2 mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500 mt-0.5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    <span class="text-gray-700">${marked.parse(point)}</span>
                </li>`
            ).join('');
            
            return `
                <div class="persona-card bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow">
                    <div class="flex items-start gap-3 mb-4">
                        <div class="${color.icon} w-10 h-10 rounded-xl text-white flex-shrink-0 flex items-center justify-center">
                            <span class="font-bold">${personaData.persona.charAt(0)}</span>
                        </div>
                        <h2 class="text-lg md:text-xl font-semibold text-gray-900 break-words">${personaData.persona}</h2>
                    </div>
                    <div class="space-y-4">
                        <div class="${color.bg} ${color.border} border p-4 rounded-xl">
                            <h3 class="font-medium text-customPurple-700 mb-2">SMART Goal</h3>
                            <div class="text-gray-700">${marked.parse(personaData.smart_goal)}</div>
                        </div>
                        <div>
                            <h3 class="font-medium text-gray-900 mb-3">Key Talking Points</h3>
                            <ul class="space-y-1">${talkingPointsHTML}</ul>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <h3 class="font-medium text-gray-900 mb-2 flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M8 2a1 1 0 000 2h2a1 1 0 100-2H8z" />
                                    <path d="M3 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6h-4.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L10.414 13H15v3a2 2 0 01-2 2H5a2 2 0 01-2-2V5z" />
                                </svg>
                                Shareable Snippet
                            </h3>
                            <div class="relative bg-gray-50 p-3 rounded-lg border border-gray-200">
                                <p class="text-sm text-gray-700 snippet-text">${personaData.suggested_snippet}</p>
                                <button class="copy-snippet-btn absolute top-2 right-2 p-1.5 bg-white/50 hover:bg-gray-200/80 rounded-full transition-colors" data-text="${personaData.suggested_snippet}" title="Copy Snippet">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
    };

    // --- DOM Elements ---
    const elements = {
        situationInput: document.getElementById('situation-input'),
        generateBtn: document.getElementById('generate-btn'),
        resultsContainer: document.getElementById('results-container'),
        btnText: document.getElementById('btn-text'),
        loader: document.getElementById('loader'),
        
        // Modal Elements
        trustBtn: document.getElementById('trust-btn'),
        trustModal: document.getElementById('trust-modal'),
        trustModalContent: document.getElementById('trust-modal-content'),
        closeTrustModalBtn: document.getElementById('close-trust-modal-btn'),
        
        sponsorBtn: document.getElementById('sponsor-btn'),
        sponsorModal: document.getElementById('sponsor-modal'),
        sponsorModalContent: document.getElementById('sponsor-modal-content'),
        closeSponsorModalBtn: document.getElementById('close-sponsor-modal-btn'),
        
        humanBtn: document.getElementById('human-btn'),
        humanModal: document.getElementById('human-modal'),
        humanModalContent: document.getElementById('human-modal-content'),
        closeHumanModalBtn: document.getElementById('close-human-modal-btn'),
        
        toolsBtn: document.getElementById('tools-btn'),
        bonusToolsModal: document.getElementById('bonus-tools-modal'),
        bonusToolsModalContent: document.getElementById('bonus-tools-modal-content'),
        closeBonusToolsModalBtn: document.getElementById('close-bonus-tools-modal-btn'),
        
        shareBtn: document.getElementById('share-btn')
    };
    
    // Global state
    const state = {
        originalSituation: "",
        isLoading: false,
        loadingInterval: null,
        loadingStage: 0,
        loadingMessages: [
            "Diving Deep...",
            "Escalating...",
            "Unpacking This...",
            "Putting a Pin in it...",
            "Circling Back...",
            "Thinking Big..."
        ]
    };
    
    // --- API Configuration ---
    const API_ENDPOINT = 'https://vd823jgh0a.execute-api.us-east-1.amazonaws.com/prod/AskArtiAPI';
    
    // --- Core Utility Functions ---
    
    // Toggle loading state
    const showLoading = (isLoading) => {
        state.isLoading = isLoading;
        elements.btnText.classList.toggle('hidden', isLoading);
        elements.loader.classList.toggle('hidden', !isLoading);
        elements.generateBtn.disabled = isLoading;
    };
    
const fetchCoachingPlan = async (situation) => {
    try {
        const response = await fetch(API_ENDPOINT, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                request_type: 'generate_one_shot_plan',
                situation: situation
            })
        });
        
        // Check if the response is actually ok before proceeding
        if (!response.ok) {
            const errorText = await response.text();
            console.error("API Response not OK:", response.status, errorText);
            throw new Error(`API Error: Status ${response.status}`);
        }
        
        // Try to parse the response
        try {
            return await response.json();
        } catch (parseError) {
            console.error("JSON Parse Error:", parseError);
            throw new Error("Failed to parse API response");
        }
    } catch (error) {
        console.error("API Request Error:", error);
        // Re-throw to let the main error handler deal with it
        throw new Error(`API Error: ${error.message}`);
    }
};
    
    const generatePlan = async () => {
    const situation = elements.situationInput.value.trim();
    
    if (!situation) {
        elements.resultsContainer.innerHTML = `
            <div class="text-center p-6 bg-red-50 border border-red-200 rounded-xl">
                <p class="text-red-700 font-medium">Please describe your sales problem first.</p>
            </div>`;
        
        // Safely add animation class
        setTimeout(() => {
            const errorDiv = elements.resultsContainer.firstChild;
            if (errorDiv && errorDiv.classList) {
                errorDiv.classList.add('error-shake');
            }
        }, 10);
        return;
    }
    
    state.originalSituation = situation;
    showLoading(true);
    
    // Show loading UI
    elements.resultsContainer.innerHTML = templates.loadingIndicator;
    
    // Cycle through loading messages
    state.loadingStage = 0;
    state.loadingInterval = setInterval(() => {
        state.loadingStage = (state.loadingStage + 1) % state.loadingMessages.length;
        const messageEl = document.getElementById('loading-message');
        if (messageEl) {
            messageEl.textContent = state.loadingMessages[state.loadingStage];
        }
    }, 2000);
    
    window.scrollTo({ top: 0, behavior: 'smooth' });
    
    try {
        // Add timeout to prevent hanging
        const timeoutPromise = new Promise((_, reject) => 
            setTimeout(() => reject(new Error("Request timed out after 30 seconds")), 30000)
        );
        
        // Race the API call against the timeout
        const planData = await Promise.race([
            fetchCoachingPlan(state.originalSituation),
            timeoutPromise
        ]);
        
        clearInterval(state.loadingInterval);
        
        // Check if we got valid data
        if (!planData || typeof planData !== 'object') {
            throw new Error("Received invalid data from API");
        }
        
        displayPlan(planData);
    } catch (error) {
        clearInterval(state.loadingInterval);
        handleApiError(error);
    } finally {
        showLoading(false);
    }
};
    
    // Handle canned prompt clicks
    const handleCannedPrompt = (e) => {
        const button = e.currentTarget;
        const fullText = button.getAttribute('data-full-text');
        elements.situationInput.value = fullText;
        setTimeout(() => {
            elements.generateBtn.click();
        }, 200);
    };
	// Display the coaching plan
    const displayPlan = (planData) => {
        // Determine plan type
        if (planData.naics_codes || planData.federal_competitors) {
            displayProspectingResults(planData);
            return;
        }
        
        // Extract data
        const { high_level_recommendation, tldr_summary, coaching_plan } = planData;
        
        // Build HTML for persona cards
        const personaCardsHTML = coaching_plan.map((personaData, index) => 
            templates.personaCard(personaData, index)
        ).join('');
        
        // Construct the full results HTML
        elements.resultsContainer.innerHTML = `
            ${templates.sponsorAd('premium')}
            <div id="coaching-plan-container" class="space-y-6">
                <div class="space-y-6">
                    <!-- Main Recommendation -->
                    <div class="bg-gradient-to-r from-customPurple-100/30 to-customPurple-100/10 p-5 rounded-xl shadow-md border border-customPurple-100/50 success-pulse">
                        <img src="images/arti_right.png" alt="Arti" class="float-left h-12 w-12 mr-4 mb-2">
                        <h3 class="text-lg font-semibold mb-1.5 text-customPurple-900">A few thoughts...</h3>
                        <div class="text-gray-800">${marked.parse(high_level_recommendation)}</div>
                        <div class="clear-both"></div>
                    </div>
                    <!-- TL;DR Section -->
                    <div class="bg-white rounded-xl border border-gray-200 p-4 shadow-sm">
                        <h3 class="font-semibold text-gray-900 mb-1 flex items-center gap-2">
                            <span class="bg-customPurple-500 text-white text-xs font-bold px-2 py-1 rounded">TL;DR</span>
                        </h3>
                        <div class="text-sm text-gray-700">${marked.parse(tldr_summary)}</div>
                    </div>
                    ${generateContextualDiagram(planData, state.originalSituation)}
                    ${templates.sponsorAd('standard')}
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">${personaCardsHTML}</div>
            </div>
            ${templates.sponsorAd('starter')}
            <div class="mt-8 flex flex-col sm:flex-row gap-3">
                <button id="copy-btn" class="flex-1 bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium py-3 px-4 rounded-xl transition-colors flex items-center justify-center gap-2 shadow-sm hover:shadow">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M8 2a1 1 0 000 2h2a1 1 0 100-2H8z" />
                        <path d="M3 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6h-4.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L10.414 13H15v3a2 2 0 01-2 2H5a2 2 0 01-2-2V5zM15 11h2a1 1 0 110 2h-2v-2z" />
                    </svg>
                    Copy Plan
                </button>
                <button id="reset-btn" class="flex-1 bg-white hover:bg-gray-50 text-gray-700 font-medium py-3 px-4 rounded-xl border border-gray-200 transition-colors flex items-center justify-center gap-2 shadow-sm hover:shadow">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                    </svg>
                    Start Over
                </button>
            </div>`;
        
        // Set up event listeners
        document.getElementById('reset-btn').addEventListener('click', resetForm);
        document.getElementById('copy-btn').addEventListener('click', copyPlanToClipboard);
        
        // Set up copy snippet buttons
        document.querySelectorAll('.copy-snippet-btn').forEach(btn => {
            btn.addEventListener('click', copySnippet);
        });
        
        // Initialize Mermaid diagrams
        setTimeout(() => {
            initializeMermaidDiagrams();
        }, 100);
    };
    
    // Display prospecting results
    const displayProspectingResults = (prospectData) => {
        // Safely extract data with defaults
        const { 
            summary = '', 
            company_capabilities = [],
            naics_codes = [], 
            federal_competitors = [], 
            prime_contractors = [],
            prospect_recommendations = [],
            market_insights = ''
        } = prospectData;
        
        // Build the HTML
        elements.resultsContainer.innerHTML = `
            ${templates.sponsorAd('premium')}
            <div id="prospecting-results-container" class="space-y-6">
                <div class="bg-gradient-to-r from-customPurple-100/30 to-customPurple-100/10 p-5 rounded-xl shadow-md border border-customPurple-100/50">
                    <img src="images/arti_right.png" alt="Arti" class="float-left h-12 w-12 mr-4 mb-2">
                    <h3 class="text-lg font-semibold mb-2 text-customPurple-900">Prospect Research & Competitive Intelligence</h3>
                    <div class="text-gray-800">${marked.parse(summary)}</div>
                    <div class="clear-both"></div>
                </div>
                ${generateContextualDiagram(prospectData, state.originalSituation)}
                ${company_capabilities.length > 0 ? `
                <div class="bg-white rounded-xl border border-gray-200 p-4 shadow-sm">
                    <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm2 6a1 1 0 011 1v3a1 1 0 11-2 0v-3a1 1 0 011-1z" clip-rule="evenodd" />
                        </svg>
                        Core Capabilities
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        ${company_capabilities.map(cap => `<span class="px-3 py-1 bg-gray-100 rounded-full text-sm text-gray-700">${marked.parse(cap).replace(/<\/?p>/g, '')}</span>`).join('')}
                    </div>
                </div>
                ` : ''}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-white rounded-xl border border-gray-200 p-4 shadow-sm">
                        <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
                            </svg>
                            Relevant NAICS Codes
                        </h3>
                        <ul class="space-y-1">
                            ${naics_codes.map(code => `<li class="text-sm text-gray-700"><span class="font-medium">${marked.parse(code).replace(/<\/?p>/g, '')}</span></li>`).join('')}
                        </ul>
                    </div>
                    <div class="bg-white rounded-xl border border-gray-200 p-4 shadow-sm">
                        <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M13 7H7v6h6V7z" />
                                <path fill-rule="evenodd" d="M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-2H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5a2 2 0 012-2h2V2z" clip-rule="evenodd" />
                            </svg>
                            Prospect Recommendations
                        </h3>
                        <ul class="space-y-2">
                            ${prospect_recommendations.map(rec => `<li class="text-sm text-gray-700 flex items-start gap-2"><span class="text-customPurple-500">•</span><span>${marked.parse(rec).replace(/<\/?p>/g, '')}</span></li>`).join('')}
                        </ul>
                    </div>
                </div>
                ${templates.sponsorAd('standard')}
                ${federal_competitors.length > 0 ? `
                <div class="bg-white rounded-xl border border-gray-200 p-4 shadow-sm">
                    <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z" />
                        </svg>
                        Federal Competitors & Similar Companies
                    </h3>
                    <div class="space-y-3">
                        ${federal_competitors.map(comp => `
                            <div class="border-l-4 border-customPurple-200 pl-3">
                                <h4 class="font-medium text-gray-900">${comp.company}</h4>
                                <p class="text-sm text-gray-600 mt-1">${marked.parse(comp.strengths).replace(/<\/?p>/g, '')}</p>
                                ${comp.contract_vehicles ? `<p class="text-xs text-gray-500 mt-1">Vehicles: ${comp.contract_vehicles}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}
                ${prime_contractors.length > 0 ? `
                <div class="bg-white rounded-xl border border-gray-200 p-4 shadow-sm">
                    <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
                        </svg>
                        Prime Contractors & Partners
                    </h3>
                    <div class="space-y-2">
                        ${prime_contractors.map(prime => `
                            <div class="flex items-start gap-2">
                                <span class="font-medium text-gray-900">${prime.company}:</span>
                                <span class="text-sm text-gray-600">${marked.parse(prime.relationship).replace(/<\/?p>/g, '')}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}
                ${market_insights ? `
                <div class="bg-customPurple-100/20 rounded-xl border border-customPurple-100/40 p-4">
                    <h3 class="text-sm font-semibold text-customPurple-800 mb-2 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                        </svg>
                        Market Insight
                    </h3>
                    <p class="text-sm text-customPurple-900">${marked.parse(market_insights).replace(/<\/?p>/g, '')}</p>
                </div>
                ` : ''}
                ${templates.sponsorAd('starter')}
                <div class="mt-6 flex flex-col sm:flex-row gap-3">
                    <button id="copy-prospecting-btn" class="flex-1 bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium py-3 px-4 rounded-xl transition-colors flex items-center justify-center gap-2 shadow-sm hover:shadow">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M8 2a1 1 0 000 2h2a1 1 0 100-2H8z" />
                            <path d="M3 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6h-4.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L10.414 13H15v3a2 2 0 01-2 2H5a2 2 0 01-2-2V5zM15 11h2a1 1 0 110 2h-2v-2z" />
                        </svg>
                        Copy Research
                    </button>
                    <button id="reset-btn" class="flex-1 bg-white hover:bg-gray-50 text-gray-700 font-medium py-3 px-4 rounded-xl border border-gray-200 transition-colors flex items-center justify-center gap-2 shadow-sm hover:shadow">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                        </svg>
                        Start Over
                    </button>
                </div>
            </div>`;
            
        // Set up event listeners
        document.getElementById('reset-btn').addEventListener('click', resetForm);
        document.getElementById('copy-prospecting-btn').addEventListener('click', copyProspectingResults);
        
        // Initialize Mermaid diagrams
        setTimeout(() => {
            initializeMermaidDiagrams();
        }, 100);
    };
	// Reset the form
    const resetForm = () => {
        elements.situationInput.value = '';
        state.originalSituation = '';
        elements.resultsContainer.innerHTML = '';
        window.scrollTo({ top: 0, behavior: 'smooth' });
    };
    
    // Fix the handleApiError function to safely check for the existence of the element
const handleApiError = (error) => {
    console.error("API Error:", error);
    
    elements.resultsContainer.innerHTML = `
        <div class="text-center p-8 bg-red-50 border border-red-200 rounded-xl">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-red-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <p class="text-red-700 font-medium">Something went wrong</p>
            <p class="text-red-600 text-sm mt-1">Please try again in a moment</p>
        </div>`;
        
    // Safely add the error-shake class
    setTimeout(() => {
        const errorDiv = elements.resultsContainer.firstChild;
        if (errorDiv && errorDiv.classList) {
            errorDiv.classList.add('error-shake');
        }
    }, 10);
};
    
    // Copy snippet to clipboard
    const copySnippet = (e) => {
        const button = e.currentTarget;
        const textToCopy = button.dataset.text;
        
        navigator.clipboard.writeText(textToCopy).then(() => {
            const originalIcon = button.innerHTML;
            button.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>`;
            setTimeout(() => { 
                button.innerHTML = originalIcon; 
            }, 2000);
        });
    };
    
    // Copy plan to clipboard
    const copyPlanToClipboard = () => {
        const planContainer = document.getElementById('coaching-plan-container');
        if (!planContainer) return;
        
        // Extract recommendation
        const thoughtsSection = planContainer.querySelector('.bg-gradient-to-r div');
        const recommendation = thoughtsSection ? thoughtsSection.textContent.trim() : '';
        
        let fullText = `ARTI'S THOUGHTS:\n${recommendation}\n\n--- DETAILED PLAN ---\n\n`;
        
        // Extract all persona data
        const personaCards = document.querySelectorAll('.persona-card');
        personaCards.forEach(card => {
            const persona = card.querySelector('h2').textContent.trim();
            
            // Extract goal - find the container with the smart goal
            const smartGoalH3 = Array.from(card.querySelectorAll('h3')).find(h3 => 
                h3.textContent.trim() === 'SMART Goal');
            let goal = 'No goal available.';
            if (smartGoalH3) {
                const goalContainer = smartGoalH3.nextElementSibling;
                if (goalContainer) {
                    goal = goalContainer.textContent.trim();
                }
            }
            
            // Extract talking points
            const points = Array.from(card.querySelectorAll('ul li span'))
                .map(span => `- ${span.textContent.trim()}`)
                .join('\n');
                
            // Extract snippet
            const snippet = card.querySelector('.snippet-text')?.textContent.trim() || 'No snippet available.';
            
            // Format card data
            fullText += `--- ${persona.toUpperCase()} ---\n\n`;
            fullText += `SMART GOAL:\n${goal}\n\n`;
            fullText += `KEY TALKING POINTS:\n${points}\n\n`;
            fullText += `SUGGESTED SNIPPET:\n${snippet}\n\n`;
        });
        
        // Copy to clipboard and show feedback
        navigator.clipboard.writeText(fullText.trim()).then(() => {
            const copyBtn = document.getElementById('copy-btn');
            const originalHtml = copyBtn.innerHTML;
            copyBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>Copied!`;
            copyBtn.classList.add('success-pulse');
            setTimeout(() => {
                copyBtn.innerHTML = originalHtml;
                copyBtn.classList.remove('success-pulse');
            }, 2000);
        });
    };
    
    // Copy prospecting results to clipboard
    const copyProspectingResults = () => {
        const container = document.getElementById('prospecting-results-container');
        if (!container) return;
        
        let fullText = "ARTI'S PROSPECTING RESEARCH\n\n";
        
        // Helper function to find a section and extract its text
        const addSectionToText = (title) => {
            const allH3s = Array.from(container.querySelectorAll('h3'));
            const titleH3 = allH3s.find(h3 => h3.textContent.trim().includes(title));
            if (!titleH3) return; 
            
            // Find the parent container
            const card = titleH3.closest('.bg-white, .bg-gradient-to-r, .bg-customPurple-100\\/20');
            if (!card) return;
            
            fullText += `--- ${title.toUpperCase()} ---\n`;
            
            // Special case for main summary
            if (title === "Prospect Research") {
                const summaryContent = card.querySelector('.text-gray-800');
                if (summaryContent) {
                    fullText += `${summaryContent.textContent.trim().replace(/\s+/g, ' ')}\n\n`;
                }
                return;
            }
            
            // Extract list items or content blocks
            const items = card.querySelectorAll('li, .flex-wrap > span, .space-y-3 > div, .space-y-2 > div, p.text-customPurple-900');
            if (items.length > 0) {
                items.forEach(item => {
                    fullText += `- ${item.textContent.trim().replace(/\s+/g, ' ')}\n`;
                });
            }
            
            fullText += '\n';
        };
        
        // Extract each section
        addSectionToText("Prospect Research");
        addSectionToText("Core Capabilities");
        addSectionToText("Relevant NAICS Codes");
        addSectionToText("Prospect Recommendations");
        addSectionToText("Federal Competitors");
        addSectionToText("Prime Contractors");
        addSectionToText("Market Insight");
        
        // Copy to clipboard and show feedback
        navigator.clipboard.writeText(fullText.trim()).then(() => {
            const copyBtn = document.getElementById('copy-prospecting-btn');
            const originalHtml = copyBtn.innerHTML;
            copyBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>Copied!`;
            copyBtn.classList.add('success-pulse');
            setTimeout(() => {
                copyBtn.innerHTML = originalHtml;
                copyBtn.classList.remove('success-pulse');
            }, 2000);
        });
    };
    
    // Handle share button click
    const handleShare = () => {
        const shareText = "Just got some good advice from AskArti.";
        const shareUrl = "https://askarti.com/";
        
        if (navigator.share) {
            navigator.share({
                title: 'AskArti - Your Federal Sales Buddy',
                text: shareText,
                url: shareUrl
            });
        } else {
            navigator.clipboard.writeText(`${shareText} ${shareUrl}`).then(() => {
                const shareBtn = document.getElementById('share-btn');
                const originalText = shareBtn.textContent;
                shareBtn.textContent = 'Copied!';
                setTimeout(() => {
                    shareBtn.textContent = originalText;
                }, 2000);
            });
        }
    };
	// --- Modal Handling ---
    
    // Open a modal
    const openModal = (modal, content) => {
        modal.classList.remove('hidden');
        setTimeout(() => {
            modal.classList.add('show');
            content.classList.add('show');
        }, 10);
    };
    
    // Close a modal
    const closeModal = (modal, content) => {
        modal.classList.remove('show');
        content.classList.remove('show');
        setTimeout(() => { 
            modal.classList.add('hidden'); 
        }, 200);
    };
    
    // --- Mermaid Chart Generation ---
    
    // Generate contextual diagram based on content
    const generateContextualDiagram = (planData, originalQuery) => {
        // Extract themes from data, not just keywords
        const query = originalQuery.toLowerCase();
        
        // For prospecting response
        if (planData.naics_codes || planData.federal_competitors) {
            return generateProspectingFlowDiagram();
        }
        
        // Extract key themes from the plan content
        const hasBuyerPersonas = planData.coaching_plan?.some(p => 
            p.persona.toLowerCase().includes('champion') || 
            p.persona.toLowerCase().includes('buyer') ||
            p.persona.toLowerCase().includes('decision'));
            
        const hasTimeline = planData.coaching_plan?.some(p => 
            p.smart_goal?.toLowerCase().includes('timeline') || 
            p.smart_goal?.toLowerCase().includes('schedule') ||
            p.smart_goal?.toLowerCase().includes('date'));
            
        const hasBlocker = planData.coaching_plan?.some(p => 
            p.persona.toLowerCase().includes('blocker') || 
            p.persona.toLowerCase().includes('competitor'));
        
        // Prioritize by context and situation, not just keywords
        if (hasBuyerPersonas && (query.includes('champion') || 
                               query.includes('stakeholder') || 
                               query.includes('influence'))) {
            return generateStakeholderMap(planData);
        }
        
        if (hasTimeline || query.includes('timeline') || query.includes('schedule')) {
            return generateTimelineDiagram();
        }
        
        if (hasBlocker || query.includes('competitor') || query.includes('decision')) {
            return generateDecisionTree();
        }
        
        // Default to process flow for general sales questions
        if (query.includes('process') || query.includes('how') || query.includes('steps')) {
            return generateProcessDiagram();
        }
        
        // No diagram if none fit well
        return '';
    };
    
    // Create a diagram container
    const createDiagramContainer = (diagramCode, title, type = "flowchart") => {
        const uniqueId = 'mermaid-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        
        return `
            <div class="bg-white rounded-xl border border-gray-200 p-4 shadow-sm mt-6">
                <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-customPurple-500" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z" />
                    </svg>
                    ${title}
                </h3>
                <div class="mermaid" id="${uniqueId}">
                    ${diagramCode}
                </div>
            </div>
        `;
    };
    
    // Generate a process diagram
    const generateProcessDiagram = () => {
        const diagramCode = `
        flowchart TD
            A[Identify Opportunity] --> B[Research Agency/Stakeholders]
            B --> C[Initial Outreach]
            C --> D{Qualified?}
            D -->|Yes| E[Build Champion]
            D -->|No| F[Nurture/Exit]
            E --> G[Map Stakeholders]
            G --> H[Align to Mission]
            H --> I[Navigate Procurement]
            I --> J[Win & Expand]
            
            class A,B,C,G,H,I,J node;
            class E highlight;
        `;
        
        return createDiagramContainer(diagramCode, "Federal Sales Process Flow");
    };
    
    // Generate a stakeholder map
    const generateStakeholderMap = (planData) => {
        // Extract stakeholders from coaching plan if possible
        const stakeholders = [];
        let hasChampion = false;
        let hasBlocker = false;
        
        if (planData.coaching_plan) {
            planData.coaching_plan.forEach(p => {
                const persona = p.persona.toLowerCase();
                if (persona.includes('champion')) {
                    stakeholders.push({ id: 'CH', label: 'Champion<br/>' + p.persona.replace('Champion', '').trim(), isChampion: true });
                    hasChampion = true;
                } else if (persona.includes('economic') || persona.includes('buyer')) {
                    stakeholders.push({ id: 'EB', label: 'Economic Buyer<br/>' + p.persona.replace('Economic Buyer', '').trim() });
                } else if (persona.includes('technical')) {
                    stakeholders.push({ id: 'TB', label: 'Technical Buyer<br/>' + p.persona.replace('Technical Buyer', '').trim() });
                } else if (persona.includes('blocker')) {
                    stakeholders.push({ id: 'BL', label: 'Blocker<br/>' + p.persona.replace('Blocker', '').trim(), isBlocker: true });
                    hasBlocker = true;
                }
            });
        }
        
        // Use defaults if we couldn't extract enough
        if (stakeholders.length < 2) {
            stakeholders.push({ id: 'EB', label: 'Economic Buyer<br/>CIO/Director' });
            stakeholders.push({ id: 'TB', label: 'Technical Buyer<br/>CISO/Tech Lead' });
            
            if (!hasChampion) {
                stakeholders.push({ id: 'CH', label: 'Champion<br/>Program Manager', isChampion: true });
            }
            
            stakeholders.push({ id: 'INF', label: 'Influencer<br/>End Users' });
            
            if (!hasBlocker) {
                stakeholders.push({ id: 'BL', label: 'Blocker<br/>Incumbent Vendor', isBlocker: true });
            }
        }
        
        // Generate diagram code
        let diagramCode = 'graph TB\n';
        
        // Add nodes
        stakeholders.forEach(s => {
            diagramCode += `    ${s.id}[${s.label}]\n`;
        });
        
        // Add connections
        diagramCode += '\n';
        const championId = stakeholders.find(s => s.isChampion)?.id || 'CH';
        const blockerId = stakeholders.find(s => s.isBlocker)?.id || 'BL';
        
        stakeholders.forEach(s => {
            if (s.id !== championId && s.id !== blockerId) {
                diagramCode += `    ${championId} -->|Advocates| ${s.id}\n`;
            }
        });
        
        if (hasBlocker) {
            stakeholders.forEach(s => {
                if (s.id !== blockerId && s.id !== championId) {
                    diagramCode += `    ${blockerId} -.->|Resists| ${s.id}\n`;
                }
            });
        }
        
        // Add classes
        diagramCode += `\n    class ${championId} highlight;\n`;
        if (hasBlocker) {
            diagramCode += `    class ${blockerId} blocker;\n`;
        }
        
        return createDiagramContainer(diagramCode, "Stakeholder Relationship Map");
    };
    
    const generateTimelineDiagram = () => {
    return `
    gantt
        title Federal Sales Timeline
        dateFormat  YYYY-MM-DD
        axisFormat %b
        tickInterval 1month
        
        section Discovery
        Initial Research    :a1, 2024-01-01, 30d
        Stakeholder Mapping :a2, after a1, 45d
        
        section Engagement
        Champion Building   :b1, after a2, 60d
        Technical Validation:b2, after b1, 45d
        
        section Procurement
        RFP Response       :crit, c1, after b2, 30d
        Contract Negotiation:crit, c2, after c1, 45d
        Award              :milestone, after c2, 0d
    `;
};
    
    // Generate a decision tree
    const generateDecisionTree = () => {
        const diagramCode = `
        flowchart TD
            A[Deal at Risk] --> B{Champion Status?}
            B -->|Strong| C[Double Down]
            B -->|Weak| D{Other Allies?}
            B -->|Gone| E{Replacement?}
            
            C --> F[Expand Access]
            D -->|Yes| G[Activate Allies]
            D -->|No| H[Strategic Retreat]
            E -->|Yes| I[Rebuild Relationship]
            E -->|No| J[Exit Strategy]
            
            F --> K[Push for Close]
            G --> K
            I --> K
            H --> L[Nurture Long-term]
            J --> L
            
            class A start;
            class K,L ending;
        `;
        
        return createDiagramContainer(diagramCode, "Deal Recovery Decision Tree");
    };
    
    // Generate a prospecting flow diagram
    const generateProspectingFlowDiagram = () => {
        const diagramCode = `
        flowchart TD
            A[Market Research] --> B[Identify Agencies]
            B --> C[Find Contract Vehicles]
            C --> D[Map Incumbents]
            D --> E[Identify Gaps/Pain]
            E --> F[Target Stakeholders]
            F --> G[Craft Outreach]
            G --> H[Initial Contact]
            H --> I{Response?}
            I -->|Yes| J[Qualify]
            I -->|No| K[Follow-up Sequence]
            K --> H
            
            class A,B,C,D,E,F,G,H node;
            class J highlight;
        `;
        
        return createDiagramContainer(diagramCode, "Federal Prospecting Flow");
    };
    
    // Initialize Mermaid diagrams
    const initializeMermaidDiagrams = () => {
        if (typeof window.mermaid !== 'undefined') {
            try {
                window.mermaid.init();
            } catch (e) {
                console.error("Mermaid initialization error:", e);
            }
        }
    };
	// --- FY Countdown Widget ---
    const initializeFYCountdown = () => {
        const elements = {
            fiscalYearEl: document.getElementById('fy-fiscal-year'),
            daysEl: document.getElementById('fy-days'),
            hoursEl: document.getElementById('fy-hours'),
            minutesEl: document.getElementById('fy-minutes'),
            secondsEl: document.getElementById('fy-seconds'),
            proTipEl: document.getElementById('fy-pro-tip'),
            countdownWrapper: document.getElementById('fy-countdown-wrapper'),
            yearendMessage: document.getElementById('fy-yearend-message'),
            progressBar: document.getElementById('fy-progress-bar'),
            progressPercent: document.getElementById('fy-progress-percent')
        };
        
        // Skip if elements aren't present yet
        if (!elements.fiscalYearEl) return;
        
        const getFiscalYearData = (date) => {
            const year = date.getUTCFullYear();
            const month = date.getUTCMonth();
            const fiscalYear = month >= 9 ? year + 1 : year;
            return { 
                fiscalYear, 
                endDate: new Date(`October 1, ${fiscalYear} 03:59:59 GMT`) 
            };
        };
        
        const updateStrategicTip = (month) => {
            let tip = '';
            switch (month) {
                case 6: tip = "Agencies are finalizing requirements. Focus on RFIs/Sources Sought notices and solidify relationships."; break;
                case 7: tip = "The buying season is in full swing. RFPs are dropping daily. Prioritize high-PWin opportunities."; break;
                case 8: tip = "It's award season! Follow up on submitted proposals and watch for last-minute simplified acquisitions."; break;
                default: tip = "Focus on building your pipeline and strategy for the next fiscal year. Analyze wins and losses.";
            }
            elements.proTipEl.textContent = tip;
        };
        
        const updateTimer = () => {
            const now = new Date();
            const { fiscalYear, endDate } = getFiscalYearData(now);
            elements.fiscalYearEl.textContent = `Fiscal Year ${fiscalYear}`;
            
            const totalSeconds = (endDate - now) / 1000;
            if (totalSeconds > 0) {
                elements.daysEl.textContent = String(Math.floor(totalSeconds / 3600 / 24)).padStart(2, '0');
                elements.hoursEl.textContent = String(Math.floor(totalSeconds / 3600) % 24).padStart(2, '0');
                elements.minutesEl.textContent = String(Math.floor(totalSeconds / 60) % 60).padStart(2, '0');
                elements.secondsEl.textContent = String(Math.floor(totalSeconds) % 60).padStart(2, '0');
                
                const q4StartDate = new Date(`July 1, ${fiscalYear} 00:00:00 GMT-0400`);
                const progress = Math.min(100, Math.max(0, ((now - q4StartDate) / (endDate - q4StartDate)) * 100));
                elements.progressBar.style.width = `${progress}%`;
                elements.progressPercent.textContent = `${Math.round(progress)}%`;
            } else {
                elements.countdownWrapper.classList.add('hidden');
                elements.yearendMessage.classList.remove('hidden');
                elements.progressBar.style.width = '100%';
                elements.progressPercent.textContent = '100%';
                clearInterval(timerInterval);
            }
            
            updateStrategicTip(now.getUTCMonth());
        };
        
        const timerInterval = setInterval(updateTimer, 1000);
        updateTimer();
        
        return timerInterval;
    };
    
    // --- Qual Scorecard Widget ---
    const initializeQualScorecard = () => {
        const elements = {
            form: document.getElementById('qual-form'),
            resultCard: document.getElementById('qual-result-card'),
            resultIcon: document.getElementById('qual-result-icon'),
            resultTitle: document.getElementById('qual-result-title'),
            resultDescription: document.getElementById('qual-result-description')
        };
        
        // Skip if elements aren't present yet
        if (!elements.form) return;
        
        const scoreThresholds = { hot: 9, warm: 5 };
        
        const calculateScore = () => {
            const budget = parseInt(elements.form.querySelector('input[name="budget"]:checked').value);
            const authority = parseInt(elements.form.querySelector('input[name="authority"]:checked').value);
            const need = parseInt(elements.form.querySelector('input[name="need"]:checked').value);
            const timeline = parseInt(elements.form.querySelector('input[name="timeline"]:checked').value);
            
            updateResult(budget + authority + need + timeline);
        };
        
        const updateResult = (score) => {
            elements.resultCard.classList.remove(
                'hidden', 'bg-red-100', 'text-red-800', 
                'bg-yellow-100', 'text-yellow-800', 
                'bg-green-100', 'text-green-800'
            );
            
            if (score >= scoreThresholds.hot) {
                elements.resultCard.classList.add('bg-customPurple-100/30', 'text-customPurple-700');
                elements.resultIcon.textContent = '🔥';
                elements.resultTitle.textContent = `Hot Lead (Score: ${score})`;
                elements.resultDescription.textContent = "Pursue this lead immediately. They are a great fit.";
            } else if (score >= scoreThresholds.warm) {
                elements.resultCard.classList.add('bg-yellow-100', 'text-yellow-800');
                elements.resultIcon.textContent = '🤔';
                elements.resultTitle.textContent = `Warm Lead (Score: ${score})`;
                elements.resultDescription.textContent = "Good potential. Nurture and develop this relationship.";
            } else {
                elements.resultCard.classList.add('bg-red-100', 'text-red-800');
                elements.resultIcon.textContent = '❄️';
                elements.resultTitle.textContent = `Cold Lead (Score: ${score})`;
                elements.resultDescription.textContent = "Low priority. Add to a long-term nurture campaign.";
            }
            
            elements.resultCard.classList.remove('hidden');
        };
        
        elements.form.addEventListener('change', calculateScore);
        calculateScore();
    };
    
    // --- Golden Hour Widget ---
    const initializeGoldenHour = () => {
        const elements = {
            timezoneSelect: document.getElementById('gh-timezone-select'),
            statusCard: document.getElementById('gh-status-card'),
            statusIcon: document.getElementById('gh-status-icon'),
            statusText: document.getElementById('gh-status-text'),
            prospectTime: document.getElementById('gh-prospect-time'),
            nextGoldenHour: document.getElementById('gh-next-golden-hour'),
            yourTimeEquivalent: document.getElementById('gh-your-time-equivalent')
        };
        
        // Skip if elements aren't present yet
        if (!elements.timezoneSelect) return;
        
        const timezones = {
            "USA & Canada": [
                "America/New_York", "America/Chicago", "America/Denver", 
                "America/Phoenix", "America/Los_Angeles", "America/Anchorage", 
                "Pacific/Honolulu"
            ], 
            "Europe": [
                "Europe/London", "Europe/Paris", "Europe/Berlin", "Europe/Helsinki"
            ], 
            "Asia & Australia": [
                "Asia/Dubai", "Asia/Kolkata", "Asia/Singapore", "Asia/Tokyo", 
                "Australia/Sydney", "Australia/Perth"
            ]
        };
        
        const GOLDEN_HOURS = [{ start: 8, end: 9 }, { start: 13, end: 14 }];
        
        const populateTimezones = () => {
            for (const region in timezones) {
                const optgroup = document.createElement('optgroup');
                optgroup.label = region;
                
                timezones[region].forEach(tz => {
                    const option = document.createElement('option');
                    option.value = tz;
                    option.textContent = tz.replace(/_/g, ' ');
                    optgroup.appendChild(option);
                });
                
                elements.timezoneSelect.appendChild(optgroup);
            }
            
            try {
                const userTz = Intl.DateTimeFormat().resolvedOptions().timeZone;
                if (Object.values(timezones).flat().includes(userTz)) {
                    elements.timezoneSelect.value = userTz;
                } else {
                    elements.timezoneSelect.value = "America/New_York";
                }
            } catch(e) { 
                elements.timezoneSelect.value = "America/New_York"; 
            }
        };
        
        const analyzeTime = () => {
            const selectedTz = elements.timezoneSelect.value;
            const now = new Date();
            const prospectHour = parseInt(now.toLocaleTimeString('en-US', { 
                timeZone: selectedTz, 
                hour: '2-digit', 
                hourCycle: 'h23' 
            }), 10);
            
            elements.prospectTime.textContent = `Their time: ${now.toLocaleTimeString('en-US', { 
                timeZone: selectedTz, 
                hour: '2-digit', 
                minute: '2-digit', 
                hour12: true 
            })}`;
            
            const isGoldenHour = GOLDEN_HOURS.some(w => prospectHour >= w.start && prospectHour <= w.end);
            
            if (isGoldenHour) {
                updateUI('golden');
            } else {
                let nextStartHour = GOLDEN_HOURS.find(w => prospectHour < w.start)?.start ?? GOLDEN_HOURS[0].start;
                updateUI('wait', { nextStartHour, selectedTz, now });
            }
        };
        
        const updateUI = (status, data = {}) => {
            elements.statusCard.className = 'rounded-xl p-6 text-center';
            
            if (status === 'golden') {
                elements.statusCard.classList.add('bg-customPurple-100/30');
                elements.statusIcon.textContent = '✅';
                elements.statusText.textContent = "It's a Golden Hour!";
                elements.statusText.className = 'text-2xl font-bold mb-1 text-customPurple-700';
                elements.nextGoldenHour.textContent = 'A great time to make contact.';
                elements.yourTimeEquivalent.textContent = '';
            } else {
                elements.statusCard.classList.add('bg-amber-100');
                elements.statusIcon.textContent = '⏳';
                elements.statusText.textContent = 'Hold Off For Now';
                elements.statusText.className = 'text-2xl font-bold mb-1 text-amber-800';
                
                const { nextStartHour, selectedTz, now } = data;
                const nextDate = new Date(now);
                nextDate.toLocaleString('en-US', {timeZone: selectedTz});
                nextDate.setHours(nextStartHour, 0, 0, 0);
                
                if (nextDate < now) nextDate.setDate(nextDate.getDate() + 1);
                
                elements.nextGoldenHour.textContent = `Next golden hour at ${nextDate.toLocaleTimeString('en-US', { 
                    timeZone: selectedTz, 
                    hour: 'numeric', 
                    hour12: true 
                })}.`;
                
                elements.yourTimeEquivalent.textContent = `(That's ${nextDate.toLocaleTimeString('en-US', { 
                    hour: 'numeric', 
                    minute: '2-digit', 
                    hour12: true, 
                    timeZoneName: 'short' 
                })} your time)`;
            }
        };
        
        populateTimezones();
        analyzeTime();
        
        elements.timezoneSelect.addEventListener('change', analyzeTime);
        const intervalId = setInterval(analyzeTime, 60000);
        
        return intervalId;
    };
	// --- Event Listeners ---
    
    // Setup event listeners for canned prompts (Using event delegation)
    document.getElementById('canned-prompts').addEventListener('click', (e) => {
        const button = e.target.closest('.prompt-btn');
        if (button) {
            handleCannedPrompt({ currentTarget: button });
        }
    });
    
    // Main button click handler
    elements.generateBtn.addEventListener('click', generatePlan);
    
    // Share button handler
    elements.shareBtn.addEventListener('click', handleShare);
    
    // Modal event listeners
    elements.trustBtn.addEventListener('click', () => openModal(elements.trustModal, elements.trustModalContent));
    elements.closeTrustModalBtn.addEventListener('click', () => closeModal(elements.trustModal, elements.trustModalContent));
    elements.trustModal.addEventListener('click', (e) => {
        if(e.target === elements.trustModal) {
            closeModal(elements.trustModal, elements.trustModalContent);
        }
    });
    
    elements.sponsorBtn.addEventListener('click', () => openModal(elements.sponsorModal, elements.sponsorModalContent));
    elements.closeSponsorModalBtn.addEventListener('click', () => closeModal(elements.sponsorModal, elements.sponsorModalContent));
    elements.sponsorModal.addEventListener('click', (e) => {
        if(e.target === elements.sponsorModal) {
            closeModal(elements.sponsorModal, elements.sponsorModalContent);
        }
    });
    
    elements.humanBtn.addEventListener('click', () => openModal(elements.humanModal, elements.humanModalContent));
    elements.closeHumanModalBtn.addEventListener('click', () => closeModal(elements.humanModal, elements.humanModalContent));
    elements.humanModal.addEventListener('click', (e) => {
        if(e.target === elements.humanModal) {
            closeModal(elements.humanModal, elements.humanModalContent);
        }
    });
    
    elements.toolsBtn.addEventListener('click', () => {
        openModal(elements.bonusToolsModal, elements.bonusToolsModalContent);
        // Initialize tools on first open
        if (!elements.bonusToolsModal.dataset.initialized) {
            initializeFYCountdown();
            initializeQualScorecard();
            initializeGoldenHour();
            elements.bonusToolsModal.dataset.initialized = 'true';
        }
    });
    elements.closeBonusToolsModalBtn.addEventListener('click', () => closeModal(elements.bonusToolsModal, elements.bonusToolsModalContent));
    elements.bonusToolsModal.addEventListener('click', (e) => {
        if(e.target === elements.bonusToolsModal) {
            closeModal(elements.bonusToolsModal, elements.bonusToolsModalContent);
        }
    });
    
    // Tab switching for tools
    document.addEventListener('click', (e) => {
        const tab = e.target.closest('.widget-tab');
        if (tab) {
            const tabs = document.querySelectorAll('.widget-tab');
            const widgetContents = document.querySelectorAll('.widget-content');
            const widgetId = tab.dataset.widget;
            
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            widgetContents.forEach(content => {
                content.classList.toggle('hidden', content.id !== widgetId);
            });
        }
    });
    
    // Escape key to close modals
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            const openModals = [
                { modal: elements.trustModal, content: elements.trustModalContent },
                { modal: elements.sponsorModal, content: elements.sponsorModalContent },
                { modal: elements.humanModal, content: elements.humanModalContent },
                { modal: elements.bonusToolsModal, content: elements.bonusToolsModalContent }
            ];
            
            openModals.forEach(({ modal, content }) => {
                if (!modal.classList.contains('hidden')) {
                    closeModal(modal, content);
                }
            });
        }
    });
    </script>
</body>
</html>