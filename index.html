<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AskArti - Your 24/7 Sales Buddy</title>
    
    <meta name="description" content="Get personalized federal sales advice from AskArti. Free AI tool provides SMART goals, customer messaging, and deal strategies for government contractors and sales professionals.">
    <meta name="keywords" content="federal sales, government sales, AI sales coach, sales strategy, federal contractors, govcon, sales advice">
    <meta name="author" content="Mark">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://askarti.com">
    
    <meta property="og:title" content="AskArti - Your Federal Sales Buddy">
    <meta property="og:description" content="Get personalized federal sales advice from AskArti.">
    <meta property="og:image" content="https://askarti.com/images/arti_right.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AskArti - Your Federal Sales Buddy">
    <meta name="twitter:description" content="Get personalized federal sales advice from AskArti.">
    <meta name="twitter:image" content="https://askarti.com/images/arti_right.png">
    
    <link rel="icon" href="/images/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="/images/arti_right.png" as="image">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script> 
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WLGEPY5H4G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-WLGEPY5H4G');
    </script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
    'brand-purple': '#8E88A7',
    'brand-purple-faint': '#E1DDEE', // A lighter tint of the new purple
    'brand-gray': {
        50: '#F9FAFB',
        100: '#F3F4F6',
        200: '#E5E7EB',
        400: '#9CA3AF',
        600: '#4B5563',
        800: '#1F2937',
        900: '#111827',
    },
    'brand-yellow': { // Muted to a warm "parchment"
        bg: '#FCF8E8',
        text: '#7A6A34',
        border: '#F5EED8',
    },
    'brand-blue': { // Muted to a "slate" blue
        bg: '#E8EDF2',
        text: '#3A4F6A',
        border: '#D4DCE6',
    },
    'brand-green': { // Muted to a "sage" green
        bg: '#EBF0EA',
        text: '#4A5C4A',
        border: '#D8E2D9',
    }
}
                }
            }
        }
    </script>

<style>
   :root {
       --brand-purple: #8E88A7;
       --brand-gray-50: #F9FAFB;
       --brand-gray-100: #F3F4F6;
       --brand-gray-800: #1F2937;
   }
   html {
       scroll-behavior: smooth;
   }
   body {
       background-color: var(--brand-gray-50);
       font-family: 'Inter', sans-serif;
       color: var(--brand-gray-800);
       -webkit-font-smoothing: antialiased;
       -moz-osx-font-smoothing: grayscale;
   }
   .main-container {
       max-width: 768px;
       margin: 0 auto;
       padding: 1rem;
   }
   .fade-in {
       animation: fadeIn 0.5s ease-in-out;
   }
   @keyframes fadeIn {
       from { opacity: 0; transform: translateY(10px); }
       to { opacity: 1; transform: translateY(0); }
   }
   
   /* --- Enhanced Card Styles --- */
   .io-card {
       background-color: white;
       border-radius: 1rem;
       border: 0px solid #E5E7EB;
       padding: 1.5rem;
       box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
       transition: box-shadow 0.2s ease;
   }
   
   .results-card {
       background-color: white;
       border-radius: 1rem;
       border: 1px solid #E5E7EB;
       overflow: hidden;
       margin-top: 1.5rem;
   }
   .results-card-header {
       padding: 1rem 1.5rem;
       border-bottom: 1px solid #E5E7EB;
   }
   .results-card-body {
       padding: 1.5rem;
   }
   
   /* --- Enhanced Typography --- */
   h1, h2, h3, h4, h5, h6 {
       font-weight: 700;
       margin-bottom: 1rem;
   }
   p, li, span {
       font-weight: 400;
       line-height: 1.6;
   }
   .results-card-body > div {
       margin-bottom: 1.5rem;
   }
   
   /* --- Form Elements --- */
   textarea, input[type="text"] {
       font-size: 16px !important; /* Prevent iOS zoom */
       transition: all 0.2s ease;
   }
   .textarea-container {
    position: relative;
}
.clear-btn {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(229, 231, 235, 0.7);
    border-radius: 0.375rem;
    padding: 0.25rem;
    min-width: 28px;
    min-height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6B7280;
    cursor: pointer;
    transition: all 0.2s ease;
    opacity: 0;
    visibility: hidden;
    backdrop-filter: blur(8px);
}
.clear-btn:hover {
    background-color: rgba(255, 255, 255, 0.95);
    border-color: rgba(156, 163, 175, 0.8);
    color: #374151;
    transform: scale(1.05);
}
.clear-btn:active {
    transform: scale(0.95);
}
.clear-btn.show {
    opacity: 1;
    visibility: visible;
}
   
   /* --- Enhanced Quick Prompts --- */
   .quick-prompt {
       transition: all 0.2s ease-in-out;
       border: 1px solid var(--brand-gray-100);
       padding: 0.75rem 1rem;
       min-height: 44px;
       display: flex;
       align-items: center;
       justify-content: center;
       text-align: center;
   }
   .quick-prompt:hover {
       transform: translateY(-2px);
       box-shadow: 0 4px 8px rgba(0,0,0,0.1);
       border-color: #E5E7EB;
   }
   .quick-prompt:active {
       transform: scale(0.95);
   }
   
   /* --- Enhanced Button Styles --- */
   .btn {
       display: inline-flex;
       align-items: center;
       justify-content: center;
       font-weight: 600;
       border-radius: 0.75rem;
       padding: 0.75rem 1.5rem;
       min-height: 44px;
       min-width: 44px;
       transition: all 0.2s ease;
       cursor: pointer;
       user-select: none;
       -webkit-tap-highlight-color: transparent;
   }
   .btn:active {
       transform: scale(0.95);
   }
   .btn-primary {
       background-color: var(--brand-purple);
       color: white;
       box-shadow: 0 2px 4px rgba(0,0,0,0.1);
   }
   .btn-primary:hover {
   background-color: #7A7391; /* Corrected hover color */
   transform: translateY(-1px);
   box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}
   .btn-primary:active {
       transform: scale(0.95);
       box-shadow: 0 2px 4px rgba(0,0,0,0.1);
   }
   .btn-secondary {
       background-color: white;
       color: #374151;
       border: 1px solid #D1D5DB;
       box-shadow: 0 1px 3px rgba(0,0,0,0.1);
   }
   .btn-secondary:hover {
       background-color: #F9FAFB;
       border-color: #9CA3AF;
       transform: translateY(-1px);
       box-shadow: 0 4px 8px rgba(0,0,0,0.1);
   }
   .btn-secondary:active {
       transform: scale(0.95);
       box-shadow: 0 1px 3px rgba(0,0,0,0.1);
   }
   
   /* --- Enhanced Copy Button --- */
   .copy-btn {
       position: absolute;
       top: 0.5rem;
       right: 0.5rem;
       background-color: rgba(255, 255, 255, 0.7);
       border: 1px solid #E5E7EB;
       border-radius: 0.5rem;
       padding: 0.5rem;
       min-width: 44px;
       min-height: 44px;
       display: flex;
       align-items: center;
       justify-content: center;
       font-size: 0.75rem;
       color: #4B5563;
       cursor: pointer;
       transition: all 0.2s ease;
       user-select: none;
       -webkit-tap-highlight-color: transparent;
   }
   .copy-btn:hover {
       background-color: white;
       border-color: #9CA3AF;
       transform: translateY(-1px);
       box-shadow: 0 2px 4px rgba(0,0,0,0.1);
   }
   .copy-btn:active {
       transform: scale(0.95);
   }
   .copy-btn.copied {
       background-color: #10B981;
       color: white;
       border-color: #10B981;
   }
   .copy-btn.copied:hover {
       background-color: #059669;
       border-color: #059669;
   }
   
   /* --- Copy Flash Animation --- */
   @keyframes copyFlash {
       0% { background-color: rgba(16, 185, 129, 0.1); }
       50% { background-color: rgba(16, 185, 129, 0.3); }
       100% { background-color: rgba(16, 185, 129, 0.1); }
   }
   .copy-flash {
       animation: copyFlash 0.6s ease-in-out;
   }
   
   /* --- Mode Button Enhancements --- */
   .mode-btn {
       min-height: 44px;
       transition: all 0.2s ease;
       -webkit-tap-highlight-color: transparent;
   }
   .mode-btn:active {
       transform: scale(0.95);
   }
   
   /* --- Recommended Button Style --- */
   .btn-recommended {
       border-width: 2px;
       border-color: var(--brand-purple);
       box-shadow: 0 4px 12px rgba(124, 107, 190, 0.2);
   }
   
   /* --- Loader --- */
   .loader {
       border: 2px solid rgba(255, 255, 255, 0.3);
       border-top: 2px solid white;
       border-radius: 50%;
       width: 1.25rem;
       height: 1.25rem;
       animation: spin 1s linear infinite;
   }
   .btn-secondary .loader {
       border-color: rgba(0, 0, 0, 0.1);
       border-top-color: var(--brand-purple);
   }
   @keyframes spin {
       0% { transform: rotate(0deg); }
       100% { transform: rotate(360deg); }
   }
   
   /* --- Chat specific styles --- */
   .chat-container {
       height: 60dvh;
       max-height: 500px;
       overflow-y: auto;
       padding: 1rem;
       background-color: #F9FAFB;
       border-radius: 1rem;
       border: 0px solid #E5E7EB;
   }
   .chat-message-user {
       background-color: var(--brand-purple);
       color: white;
       border-radius: 1rem 1rem 0.25rem 1rem;
   }
   .chat-message-arti {
       background-color: white;
       color: #1f2937;
       border: 1px solid #e5e7eb;
       border-radius: 1rem 1rem 1rem 0.25rem;
   }
   
   /* --- Enhanced Checkmark Icon --- */
   .checkmark {
       width: 16px;
       height: 16px;
       stroke: currentColor;
       stroke-width: 2;
       stroke-linecap: round;
       stroke-linejoin: round;
       fill: none;
   }
   
   /* --- Responsive & Mobile --- */
@media (max-width: 640px) {
    .main-container { 
        padding: 0.5rem; 
        padding-bottom: 0.5rem;
    }
    .io-card, .results-card-body { 
        padding: 0.75rem; 
    }
    .results-card-header {
        padding: 0.75rem 1rem;
    }
    .results-card-body > div {
        margin-bottom: 1rem;
    }
    .btn { 
        padding: 0.75rem 1rem; 
        font-size: 0.9rem; 
    }
    .copy-btn { 
        padding: 0.625rem;
        min-width: 48px;
        min-height: 48px;
    }
    .clear-btn {
        padding: 0.25rem; 
        min-width: 32px; 
        min-height: 32px; 
    }
    .quick-prompt {
        padding: 0.5rem 0.625rem;
        min-height: 36px;
        font-size: 0.8rem;
    }
    .mt-4 { margin-top: 0.5rem; }
    .mt-6 { margin-top: 0.75rem; }
    .chat-container {
        height: 45dvh;
        max-height: 350px;
        padding: 0.75rem;
    }
    .mode-btn {
        padding: 0.5rem 0.75rem;
        font-size: 0.8rem;
        min-height: 40px;
    }
    header {
        margin-bottom: 0.5rem;
    }
    header img {
        height: 4rem;
    }
    footer {
        margin-top: 2rem;
    }
    /* Reduce spacing on mobile */
    .space-y-3 > * + * { margin-top: 0.5rem; }
    .space-y-4 > * + * { margin-top: 0.75rem; }
    .space-y-6 > * + * { margin-top: 1rem; }
    .space-y-8 > * + * { margin-top: 1.25rem; }
}
/* Auto-expanding textarea */
.auto-expand {
    min-height: calc(3 * 1.5em + 1.5rem); /* 3 rows + padding */
    max-height: calc(6 * 1.5em + 1.5rem); /* 6 rows + padding */
    transition: height 0.2s ease;
    overflow-y: hidden;
    resize: none;
}

.auto-expand.scrollable {
    overflow-y: auto;
    transition: none; /* Remove transition when scrolling is needed */
}
/* Fix for mobile playbook circles */
@media (max-width: 768px) {
    .copy-playbook-btn {
        padding: 0.5rem 0.75rem;
        font-size: 0.75rem;
    }
    
    .copy-playbook-btn svg {
        width: 1rem;
        height: 1rem;
        margin-right: 0.25rem;
    }
    
    .results-card-header .flex {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.75rem;
    }
    
    .results-card-header .flex > div:first-child {
        flex: 1;
        width: 100%;
    }
    
    .copy-playbook-btn {
        align-self: stretch;
        justify-content: center;
        width: 100%;
    }
    
    /* Fix numbered circles on mobile */
    .playbook-persona-circle {
        min-width: 2rem !important;
        width: 2rem !important;
        height: 2rem !important;
        flex-shrink: 0 !important;
        font-size: 0.75rem !important;
    }
}
/* News-enhanced response indicator */
.news-enhanced-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    background-color: #EBF8FF;
    color: #2B6CB0;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    border: 1px solid #BEE3F8;
}

.news-enhanced-badge .pulse-dot {
    width: 0.5rem;
    height: 0.5rem;
    background-color: #3182CE;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

/* News freshness indicator */
.news-indicator {
    background: linear-gradient(90deg, #10B981, #059669);
    color: white;
    border-radius: 0.5rem;
    padding: 0.5rem 0.75rem;
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.news-indicator .pulse-dot {
    width: 0.5rem;
    height: 0.5rem;
    background-color: #FFFFFF;
    border-radius: 50%;
    animation: pulse 2s infinite;
}
</style>

</head>
<body class="bg-brand-gray-50">

   <div class="main-container pt-4 pb-20">
       
       <header class="text-center mb-3">
    <a href="/" aria-label="AskArti Home" class="inline-block">
        <img src="/images/asklite.png" alt="AskArti Logo" class="h-20 w-auto mx-auto sm:h-24">
    </a>
</header>

       <main id="main-content">
    <div id="quick-mode" class="mode-content fade-in">
        <div class="io-card">
            <label for="situation-input" class="block text-sm font-bold text-brand-gray-700 mb-3" id="greeting-label">
                Hey, I'm Arti! You can ask me anything.
            </label>
            <div class="textarea-container">
                <textarea 
                    id="situation-input" 
                    rows="3"
                    class="w-full p-3 pr-12 text-xs font-light border border-gray-300 rounded-lg resize-none placeholder-gray-500 auto-expand focus:outline-none focus:ring-1 focus:ring-gray-300 focus:border-gray-300"
                    placeholder='Type "Create a sales playbook for selling AI services to HHS." or "Prospect for cyber opps at DHS". Or start with a sample prompt below and modify it.'
                    maxlength="2500"></textarea>
                <button id="clear-btn" class="clear-btn" title="Clear input" aria-label="Clear input">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
</button>
                    </div>
                    <div class="text-xs text-gray-500 mt-1.5">
    <span class="hint-text">💡 Click a sample below and swap in your agency, company, or goals. Add "playbook", "earnings", "prospect" or "news" to your prompt for specific plans.</span>
    <span id="char-count" class="hidden">0/2500</span>
</div>

                    <div class="mt-4">
    <div class="flex flex-wrap gap-2">
        <button class="quick-prompt px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-full text-sm text-gray-700" data-text="Playbook: Create a comprehensive sales playbook for selling cloud migration services to the Department of Veterans Affairs. Focus on healthcare modernization, data analytics, and patient experience improvements. Include key stakeholders like CIOs, CTOs, and healthcare administrators.">Sales Playbook</button>
        <button class="quick-prompt px-3 py-1.5 bg-blue-50 hover:bg-blue-100 rounded-full text-sm text-blue-700 border border-blue-200" data-text="Give me today's federal sales briefing with the top headlines and opportunities I should know about.">📰 Daily Brief</button>
		<button class="quick-prompt px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-full text-sm text-gray-700" data-text="Buyer at VA ghosted me after I sent pricing. CISO loves our competitor.">Stuck Deal</button>
        <button class="quick-prompt px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-full text-sm text-gray-700" data-text="Internal partner and account reps are fighting over customer access, pipeline, and revenue. Sales are hurting.">Partner Drama</button>
        <button class="quick-prompt px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-full text-sm text-gray-700" data-text="News: Today, the Chief Digital and Artificial Intelligence Office (CDAO) announced contract awards to leading U.S. frontier AI companies to accelerate Department of Defense (DoD) adoption of advanced AI capabilities to address critical national security challenges. Frontier AI companies lead development of the most advanced AI models and technologies, conduct insightful research into the use of frontier AI, and pioneer efforts to address both the potential benefits and risks of frontier AI technologies. 

The awards to Anthropic, Google, OpenAI, and xAI – each with a $200M ceiling – will enable the Department to leverage the technology and talent of U.S. frontier AI companies to develop agentic AI workflows across a variety of mission areas.  Establishing these partnerships will broaden DoD use of and experience in frontier AI capabilities and increase the ability of these companies to understand and address critical national security needs with the most advanced AI capabilities U.S. industry has to offer. 

“The adoption of AI is transforming the Department’s ability to support our warfighters and maintain strategic advantage over our adversaries,” said Chief Digital and AI Officer Dr. Doug Matty. “Leveraging commercially available solutions into an integrated capabilities approach will accelerate the use of advanced AI as part of our Joint mission essential tasks in our warfighting domain as well as intelligence, business, and enterprise information systems.” 

DoD is implementing a commercial-first approach to accelerating DoD adoption of AI. Today’s awards bring in the best U.S.-based frontier AI talent to help apply cutting-edge AI to solve DoD use cases.  CDAO is also providing access to many of the latest generative AI (GenAI) models for general purpose use to Combatant Commands, the Office of the Secretary of Defense, and the Joint Staff via Army’s Enterprise Large Language Model Workspace powered by Ask Sage, and to the broader enterprise via embedded AI models within DoD enterprise data and AI platforms, including the Advancing Analytics (Advana) platform, Maven Smart System, and Edge Data Mesh nodes, which enable AI integration into workflows that occur within these data environments themselves. Finally, DoD is partnering with the General Services Administration (GSA) to bring the best AI technologies to the federal government while leveraging whole-of-government buying power for AI production and compute resources.  ">News or Text</button>
        <button class="quick-prompt px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-full text-sm text-gray-700" data-text="Earnings: (NASDAQ: AMZN) today announced financial results for
its first quarter ended March 31, 2025.
- Net sales increased 9% to $155.7 billion in the first quarter, compared with $143.3 billion in first quarter 2024.
Excluding the $1.4 billion unfavorable impact from year-over-year changes in foreign exchange rates throughout the
quarter, net sales increased 10% compared with first quarter 2024.
- North America segment sales increased 8% year-over-year to $92.9 billion.
- International segment sales increased 5% year-over-year to $33.5 billion, or increased 8% excluding changes
in foreign exchange rates.
- AWS segment sales increased 17% year-over-year to $29.3 billion.
- Operating income increased to $18.4 billion in the first quarter, compared with $15.3 billion in first quarter 2024.
- North America segment operating income was $5.8 billion, compared with $5.0 billion in first quarter 2024.
- International segment operating income was $1.0 billion, compared with $0.9 billion in first quarter 2024.
- AWS segment operating income was $11.5 billion, compared with $9.4 billion in first quarter 2024.
- Net income increased to $17.1 billion in the first quarter, or $1.59 per diluted share, compared with $10.4 billion, or
$0.98 per diluted share, in first quarter 2024.
- Operating cash flow increased 15% to $113.9 billion for the trailing twelve months, compared with $99.1 billion for
the trailing twelve months ended March 31, 2024.
- Free cash flow decreased to $25.9 billion for the trailing twelve months, compared with $50.1 billion for the trailing
twelve months ended March 31, 2024.
We're pleased with the start to 2025, especially our pace of innovation and progress in continuing to improve customer
experiences, said Andy Jassy, President and CEO, Amazon.">Bull or Bear</button>
        <button class="quick-prompt px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-full text-sm text-gray-700" data-text="Prospect: Just took over Fed Sales at Staples. Prospect for office supplies at the VA.">Prospect</button>
    </div>
</div>

                    <div class="mt-4 border-t border-gray-200 pt-4">
    <button id="game-plan-btn" class="btn btn-primary w-full">
        <span id="game-plan-text">Ask Arti</span>
        <div id="game-plan-loader" class="loader hidden"></div>
    </button>
</div>
                </div>
            </div>
		
            <div id="chat-mode" class="mode-content hidden fade-in">
                <div class="io-card">
                    <div class="chat-container mb-4" id="chat-container">
                        <div id="chat-messages" class="space-y-4">
                            <div class="flex justify-start">
                                <div class="chat-message-arti p-3 text-sm max-w-[85%]">
                                    <p id="chat-greeting">Hey! I'm Arti. I can help with stuck deals, boss problems, or whatever's on your mind. If you need a structured plan, flip to the "Game Plans" tab.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex gap-2">
    <input type="text" id="chat-input" class="flex-1 p-3 text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-gray-300 focus:border-gray-300" placeholder="Type your message..." maxlength="2000">
    <button id="chat-send-btn" class="btn btn-primary px-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z" clip-rule="evenodd" /></svg>
    </button>
</div>
                </div>
				</div>
       </main>

        <div id="loading-message-container" class="text-center py-6 hidden">
            <p id="loading-message" class="text-gray-600 font-medium"></p>
        </div>
        <div id="error-message" class="bg-red-100 border border-red-300 rounded-lg p-4 text-center my-6 hidden">
            <p class="text-red-800 font-semibold mb-1">¯\_(ツ)_/¯ Oops, that didn't work.</p>
            <p class="text-red-700 text-sm" id="error-details">We're having trouble connecting to Arti.</p>
        </div>

       <div id="results-container" class="fade-in"></div>

       <div class="mt-8 text-center">
           <p class="text-sm text-gray-500 mb-2">Need something different? Switch modes.</p>
           <div class="io-card max-w-sm mx-auto p-2">
                <div class="flex bg-brand-gray-100 p-1 rounded-xl">
                    <button class="mode-btn flex-1 px-3 py-2 rounded-lg font-semibold text-sm transition-all active" data-mode="quick">
                        ⚡️ Game Plans
                    </button>
                    <button class="mode-btn flex-1 px-3 py-2 rounded-lg font-semibold text-sm transition-all" data-mode="chat">
                        💬 Chat with Arti
                    </button>
                </div>
           </div>
       </div>
	   <!-- Add this at the very bottom, before your existing footer -->
<details class="mt-8 mb-4">
    <summary class="cursor-pointer text-sm text-gray-600 hover:text-gray-800 font-medium">
        📰 Recent Federal Headlines (click to expand)
    </summary>
    <div class="mt-3 max-h-96 overflow-y-auto bg-gray-50 rounded-lg p-4">
        <div id="footer-headlines" class="space-y-2 text-xs">
            <!-- Headlines load here -->
        </div>
    </div>
</details>
       <footer class="text-center mt-12 text-xs text-gray-500">
    <div class="flex justify-center gap-4 mb-4">
        <a href="#" id="about-btn" class="font-medium text-brand-purple hover:underline">About AskArti</a>
        <a href="mailto:mark@subhoo.com" class="font-medium text-brand-purple hover:underline">Contact</a>
    </div>
    <p class="mb-3 text-gray-600">
    You're interacting with an AI assistant trained through June 2024. AskArti offers general guidance for informational purposes only and isn't a substitute for professional advice. Always evaluate recommendations carefully before making decisions.
</p>
    <p>
        For Federal Sellers by Federal Sellers.
        <br>
        Powered by AWS.
        <br>
        © 2025 AskArti.com.
    </p>
</footer>

  </div>
  
  <div id="about-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
      <div class="bg-white rounded-xl shadow-xl w-full max-w-md p-6">
          <div class="flex justify-between items-start mb-4">
              <h2 class="text-xl font-bold text-gray-900">About AskArti</h2>
              <button id="close-about" class="text-gray-400 hover:text-gray-600">
                  <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
              </button>
          </div>
          <div class="space-y-4 text-gray-700 text-sm">
              <p>AskArti is your 24/7 AI sales coach, designed for federal sales professionals. Get instant advice on stuck deals, meeting preparation, and sales strategy.</p>
              <div class="mt-4 pt-4 border-t">
                  <h3 class="font-semibold text-gray-800 mb-2">Privacy & Technology</h3>
                  <p class="text-gray-600">AskArti uses advanced AI models. We do not store, log, or persist any conversation data. All processing occurs in-memory and is discarded.</p>
              </div>
          </div>
      </div>
  </div>
<script>
// --- Time-based greeting functionality ---
function getTimeBasedGreeting() {
   const hour = new Date().getHours();
   const name = "I'm Arti!";
   
   if (hour >= 5 && hour < 12) {
       return `Good morning! ${name} Ready to tackle the day?`;
   } else if (hour >= 12 && hour < 17) {
       return `Good afternoon! ${name} How can I help?`;
   } else if (hour >= 17 && hour < 21) {
       return `Good evening! ${name} What's on your mind?`;
   } else {
       return `Burning the midnight oil? ${name} I'm here to help.`;
   }
}

function updateGreetings() {
   const greeting = getTimeBasedGreeting();
   const greetingLabel = document.getElementById('greeting-label');
   const chatGreeting = document.getElementById('chat-greeting');
   
   if (greetingLabel) {
       greetingLabel.textContent = greeting;
   }
   
   if (chatGreeting) {
       const chatText = greeting.replace('Hey, I\'m Arti!', 'I\'m Arti.');
       chatGreeting.textContent = `${chatText} I can help with stuck deals, boss problems, or whatever's on your mind. If you need a structured plan, flip to the "Game Plans" tab.`;
   }
}

// --- Mode Toggle Active State ---
const modeButtons = document.querySelectorAll('.mode-btn');
modeButtons.forEach(btn => {
   btn.addEventListener('click', () => {
       modeButtons.forEach(b => b.classList.remove('active', 'bg-white', 'text-brand-purple'));
       btn.classList.add('active', 'bg-white', 'text-brand-purple');
       const inactiveBtn = [...modeButtons].find(b => !b.classList.contains('active'));
       if(inactiveBtn) {
           inactiveBtn.classList.add('text-gray-600');
           inactiveBtn.classList.remove('bg-white', 'text-brand-purple');
       }
   });
});
document.querySelector('.mode-btn[data-mode="quick"]').classList.add('bg-white', 'text-brand-purple');
document.querySelector('.mode-btn[data-mode="chat"]').classList.add('text-gray-600');

const CONFIG = {
 API_ENDPOINT: 'https://vd823jgh0a.execute-api.us-east-1.amazonaws.com/prod/AskArtiAPI',
 REQUEST_TIMEOUT: 30000,
 MAX_RETRIES: 2,
 RETRY_DELAY: 2000,
 MAX_INPUT_LENGTH: 2500,
 MIN_REQUEST_INTERVAL: 2000,
 LOADING_MESSAGES: [
     "Hang on. I'm...Working Backwards", 
     "...Diving Deep", 
     "...Unpacking This", 
     "...Putting a Pin in it", 
     "...Circling Back", 
     "...Thinking Big"
 ]
};

class AskArti {
 constructor() {
  this.elements = this.getElements();
  this.state = {
      pendingRequest: false,
      lastRequestTime: 0,
      loadingInterval: null,
      abortController: null,
      lastQuery: '',
      currentMode: 'quick',
      chatHistory: [],
  };
  this.init();
}

 getElements() {
    return {
        situationInput: document.getElementById('situation-input'),
        clearBtn: document.getElementById('clear-btn'),
        gamePlanBtn: document.getElementById('game-plan-btn'),
        gamePlanText: document.getElementById('game-plan-text'),
        gamePlanLoader: document.getElementById('game-plan-loader'),
        charCount: document.getElementById('char-count'),
        loadingMessageContainer: document.getElementById('loading-message-container'),
        loadingMessage: document.getElementById('loading-message'),
        errorMessage: document.getElementById('error-message'),
        errorDetails: document.getElementById('error-details'),
        resultsContainer: document.getElementById('results-container'),
        aboutBtn: document.getElementById('about-btn'),
        aboutModal: document.getElementById('about-modal'),
        closeAbout: document.getElementById('close-about'),
        quickPromptBtns: document.querySelectorAll('.quick-prompt'),
        modeButtons: document.querySelectorAll('.mode-btn'),
        quickMode: document.getElementById('quick-mode'),
        chatMode: document.getElementById('chat-mode'),
        chatMessages: document.getElementById('chat-messages'),
        chatInput: document.getElementById('chat-input'),
        chatSendBtn: document.getElementById('chat-send-btn'),
    };
}

 init() {
    updateGreetings();
    
    mermaid.initialize({ startOnLoad: false, securityLevel: 'strict', theme: 'base', themeVariables: {
          primaryColor: '#F3F4F6',
          primaryTextColor: '#1F2937',
          primaryBorderColor: '#D1D5DB',
          lineColor: '#6B7280',
          textColor: '#111827',
          fontSize: '14px'
    }});
    this.setupEventListeners();
    this.setupAutoExpand(); // Add this line
    this.elements.situationInput.focus();
    this.updateCharCount();
}

   updateCharCount() {
       if (!this.elements.situationInput) return;
       const current = this.elements.situationInput.value.length;
       const max = CONFIG.MAX_INPUT_LENGTH;
       this.elements.charCount.textContent = `${current}/${max}`;
       
       if (current > 0) {
           this.elements.clearBtn.classList.add('show');
       } else {
           this.elements.clearBtn.classList.remove('show');
       }
   }

   

   clearInput() {
    this.elements.situationInput.value = '';
    this.elements.situationInput.style.height = 'auto'; // Reset height
    this.elements.situationInput.classList.remove('scrollable');
    this.updateCharCount();
    this.elements.situationInput.focus();
}

   setupEventListeners() {
    this.elements.situationInput.addEventListener('input', () => {
        this.updateCharCount();
    });
    this.elements.situationInput.addEventListener('focus', () => {
        this.updateCharCount();
    });

    this.elements.situationInput.addEventListener('blur', () => {
        this.elements.clearBtn.classList.remove('show');
    });
    this.elements.clearBtn.addEventListener('click', () => this.clearInput());

    this.elements.quickPromptBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
            const button = e.currentTarget;
            this.elements.situationInput.value = button.dataset.text;
            this.updateCharCount();
            this.getAdvice(null, this.elements.gamePlanBtn);
        });
    });

    this.elements.gamePlanBtn.addEventListener('click', (e) => this.getAdvice(null, e.currentTarget));

    this.elements.situationInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            this.getAdvice(null, this.elements.gamePlanBtn);
        }
    });

    // Rest of your event listeners remain the same...
    this.elements.aboutBtn.addEventListener('click', () => this.showModal());
    this.elements.closeAbout.addEventListener('click', () => this.hideModal());
    this.elements.aboutModal.addEventListener('click', (e) => {
        if (e.target === this.elements.aboutModal) this.hideModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') this.hideModal();
    });

    this.elements.modeButtons.forEach(btn => {
        btn.addEventListener('click', (e) => this.switchMode(e.target.dataset.mode));
    });

    this.elements.chatSendBtn.addEventListener('click', () => this.sendChatMessage());
    this.elements.chatInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            this.sendChatMessage();
        }
    });
}

setupAutoExpand() {
    const textarea = this.elements.situationInput;
    
    const adjustHeight = () => {
        // Reset height to auto to get the correct scrollHeight
        textarea.style.height = 'auto';
        
        const minHeight = parseFloat(getComputedStyle(textarea).lineHeight) * 3 + 24; 
        const maxHeight = parseFloat(getComputedStyle(textarea).lineHeight) * 6 + 24; 
        
        let newHeight = Math.max(minHeight, textarea.scrollHeight);
        
        if (newHeight > maxHeight) {
            newHeight = maxHeight;
            textarea.classList.add('scrollable');
        } else {
            textarea.classList.remove('scrollable');
        }
        
        textarea.style.height = newHeight + 'px';
    };
    
    // Adjust on input
    textarea.addEventListener('input', adjustHeight);
    
    // Adjust on paste (with slight delay to ensure content is pasted)
    textarea.addEventListener('paste', () => {
        setTimeout(adjustHeight, 10);
    });
    
    // Initial adjustment
    adjustHeight();
}
   switchMode(mode) {
       this.state.currentMode = mode;
       this.elements.resultsContainer.innerHTML = '';
       this.elements.errorMessage.classList.add('hidden');
       this.hideLoadingMessages();

       if (mode === 'quick') {
           this.elements.quickMode.classList.remove('hidden');
           this.elements.chatMode.classList.add('hidden');
           this.elements.situationInput.focus();
       } else {
           this.elements.quickMode.classList.add('hidden');
           this.elements.chatMode.classList.remove('hidden');
           this.elements.chatInput.focus();
       }
   }

   addChatMessage(content, isUser = false) {
       let processedContent = isUser ? content : marked.parse(content.replace(/<action>(.*?)<\/action>/g, '<span class="bg-yellow-50 px-1 py-0.5 rounded">$1</span>'));
       const messageClass = isUser ? 'chat-message-user justify-end' : 'chat-message-arti justify-start';
       const alignClass = isUser ? 'justify-end' : 'justify-start';

       const messageHtml = `
           <div class="flex ${alignClass} fade-in">
               <div class="${messageClass} p-3 text-sm max-w-[85%]">
                   ${processedContent}
               </div>
           </div>
       `;
       this.elements.chatMessages.insertAdjacentHTML('beforeend', messageHtml);
       this.scrollChatToBottom();
   }
   
   showTypingIndicator() {
       const typingHtml = `<div id="typing-indicator" class="flex justify-start"><div class="chat-message-arti p-3 text-sm">...</div></div>`;
       this.elements.chatMessages.insertAdjacentHTML('beforeend', typingHtml);
       this.scrollChatToBottom();
   }

   hideTypingIndicator() {
       const indicator = document.getElementById('typing-indicator');
       if (indicator) indicator.remove();
   }

   scrollChatToBottom() {
       const chatContainer = document.getElementById('chat-container');
       if (chatContainer) {
           chatContainer.scrollTop = chatContainer.scrollHeight;
       }
   }

   async sendChatMessage() {
       const message = this.elements.chatInput.value.trim();
       if (!message || this.state.pendingRequest) return;

       this.state.pendingRequest = true;
       this.addChatMessage(message, true);
       this.state.chatHistory.push({ role: 'user', content: message });
       this.elements.chatInput.value = '';
       this.showTypingIndicator();

       try {
           const response = await fetch(CONFIG.API_ENDPOINT, {
               method: 'POST',
               headers: { 'Content-Type': 'application/json' },
               body: JSON.stringify({ situation: message, mode: 'chat', conversationHistory: this.state.chatHistory }),
           });
           if (!response.ok) throw new Error(`Server error (${response.status})`);
           
           const data = await response.json();
           this.hideTypingIndicator();
           this.addChatMessage(data.message);
           this.state.chatHistory.push({ role: 'assistant', content: data.message });

       } catch (error) {
           this.hideTypingIndicator();
           this.addChatMessage("Sorry, I'm having trouble connecting right now. Please try again in a moment.", false);
       } finally {
           this.state.pendingRequest = false;
       }
   }

   setButtonLoading(loading, clickedButton) {
    this.state.pendingRequest = loading;
    this.elements.errorMessage.classList.add('hidden');

    this.elements.gamePlanBtn.disabled = loading;

    if (loading) {
        this.elements.gamePlanText.classList.add('hidden');
        this.elements.gamePlanLoader.classList.remove('hidden');
    } else {
        this.elements.gamePlanText.classList.remove('hidden');
        this.elements.gamePlanLoader.classList.add('hidden');
    }
}

   showLoadingMessages() {
       this.elements.loadingMessageContainer.classList.remove('hidden');
       let i = 0;
       this.elements.loadingMessage.textContent = CONFIG.LOADING_MESSAGES[i];
       this.state.loadingInterval = setInterval(() => {
           i = (i + 1) % CONFIG.LOADING_MESSAGES.length;
           this.elements.loadingMessage.textContent = CONFIG.LOADING_MESSAGES[i];
       }, 2000);
   }

   hideLoadingMessages() {
       clearInterval(this.state.loadingInterval);
       this.elements.loadingMessageContainer.classList.add('hidden');
   }

   showError(message) {
       this.elements.errorMessage.classList.remove('hidden');
       this.elements.errorDetails.textContent = message;
   }
   
   async getAdvice(forceType = null, clickedButton = null) {
    let situation = this.elements.situationInput.value.trim();
    situation = situation.replace(/[""]/g, '"').replace(/['']/g, "'");
    if (!situation) { this.showError("Please type or paste something into the box above."); return; }
    if (this.state.pendingRequest) return;
    
    const buttonToLoad = clickedButton || this.elements.gamePlanBtn; // Fixed this line

    this.state.lastQuery = situation;
    this.elements.resultsContainer.innerHTML = '';
    this.setButtonLoading(true, buttonToLoad);
    this.showLoadingMessages();

    try {
        const body = { situation };
        if (forceType) body.forceType = forceType;

        const response = await fetch(CONFIG.API_ENDPOINT, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body),
        });
        
        if (!response.ok) {
            let errorMessage = `Server error: ${response.status}`;
            try {
                const errorData = await response.json();
                errorMessage = errorData.error || errorData.message || errorMessage;
            } catch (parseError) {
                console.error('Error parsing error response:', parseError);
            }
            throw new Error(errorMessage);
        }
        
        const data = await response.json();
        if(data.error) throw new Error(data.message || data.error);
        
        this.displayAdvice(data);

    } catch (error) {
        console.error('Request failed:', error);
        this.showError(error.message || "An unknown error occurred.");
    } finally {
        this.setButtonLoading(false, buttonToLoad);
        this.hideLoadingMessages();
    }
}

   displayAdvice(data) {
    const { response_type } = data;
    let html = '';

    if (response_type === 'playbook') {
        html = this.renderSalesPlaybook(data);
    } else if (response_type === 'news') {
        html = this.renderNewsAdvice(data);
    } else if (response_type === 'investment') {
        html = this.renderMarketAnalysis(data);
    } else if (response_type === 'prospect') {
        html = this.renderProspectAdvice(data);
    } else if (response_type === 'briefing') {
        html = this.renderDailyBriefing(data);
    } else {
        html = this.renderGeneralAdvice(data);
    }
       
       this.elements.resultsContainer.innerHTML = html;
       
       this.setupInteractiveElements();

       if (data.mermaid_chart) {
           this.renderMermaidChart().then(() => {
               this.setupMermaidDownloadButton();
           });
       }
       this.elements.resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
   }

   renderSalesPlaybook(data) {
    const { 
        sales_play_title, sales_play_summary, key_services, key_partners, target_personas,
        competitive_positioning, success_metrics, timeline_milestones, insider_tips, 
        risk_mitigation, next_actions 
    } = data;

    const renderList = (items) => items.map(item => `<li class="text-sm text-gray-700 leading-relaxed">${item}</li>`).join('');
    
    const renderPersonas = (personas) => {
    if (!personas || personas.length === 0) return '<p class="text-sm text-gray-500">No persona data available.</p>';
    return personas.map((p, index) => `
        <div class="bg-white border border-gray-200 rounded-lg p-4 mb-4">
            <div class="flex items-center gap-3 mb-4">
                <div class="playbook-persona-circle w-8 h-8 bg-brand-purple text-white rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0">${index + 1}</div>
                <h4 class="font-bold text-lg text-gray-900">${p.persona_title}</h4>
            </div>
            
            <div class="space-y-4">
                <div>
                    <h5 class="font-semibold text-gray-800 mb-2">Business Priorities</h5>
                    <ul class="list-disc list-inside space-y-1 text-sm text-gray-700 ml-2">${renderList(p.business_priorities)}</ul>
                </div>
                
                <div>
                    <h5 class="font-semibold text-gray-800 mb-2">Conversation Starters</h5>
                    <ul class="list-disc list-inside space-y-1 text-sm text-gray-700 ml-2">${renderList(p.conversation_starters)}</ul>
                </div>
                
                <div>
                    <h5 class="font-semibold text-gray-800 mb-2">Objections & Responses</h5>
                    <div class="space-y-3">
                        ${p.objections_responses.map(o => `
                            <div class="border-l-3 border-gray-300 pl-4 py-2">
                                <p class="font-medium text-gray-800 text-sm mb-1"><strong>Objection:</strong> "${o.objection}"</p>
                                <p class="text-gray-600 text-sm"><strong>Response:</strong> ${o.response}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        </div>
    `).join('');
};

    return `
    <div class="results-card">
        <div class="results-card-header">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="font-bold text-xl text-gray-900">${sales_play_title}</h2>
                    <p class="text-gray-600 text-sm mt-1">Sales Playbook</p>
                </div>
                <button class="copy-playbook-btn btn btn-secondary text-xs py-2 px-3" title="Copy entire playbook">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                    </svg>
                    Copy
                </button>
            </div>
        </div>
        <div class="results-card-body space-y-6" id="playbook-content">
                
                <div class="border-l-4 border-brand-purple pl-4 py-2">
                    <h3 class="font-bold text-gray-900 mb-2">Executive Summary</h3>
                    <p class="text-gray-700 leading-relaxed">${sales_play_summary}</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h3 class="font-bold text-gray-900 mb-3">Success Metrics</h3>
                        <ul class="list-disc list-inside space-y-2">${renderList(success_metrics || ['Define success metrics'])}</ul>
                    </div>
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h3 class="font-bold text-gray-900 mb-3">Timeline Milestones</h3>
                        <ul class="list-disc list-inside space-y-2">${renderList(timeline_milestones || ['Define timeline'])}</ul>
                    </div>
                </div>

                ${competitive_positioning ? `
                <div class="border-l-4 border-yellow-400 pl-4 py-2">
                    <h3 class="font-bold text-gray-900 mb-2">Competitive Positioning</h3>
                    <p class="text-gray-700 leading-relaxed">${competitive_positioning}</p>
                </div>
                ` : ''}

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-bold text-gray-900 mb-3">Key Services</h3>
                        <ul class="list-disc list-inside space-y-2">${renderList(key_services)}</ul>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-900 mb-3">Strategic Partners</h3>
                        <ul class="list-disc list-inside space-y-2">${renderList(key_partners)}</ul>
                    </div>
                </div>

                <div>
                    <h3 class="font-bold text-lg text-gray-900 mb-4">Stakeholder Guide</h3>
                    <div class="space-y-4">
                        ${renderPersonas(target_personas)}
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    ${insider_tips ? `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h3 class="font-bold text-gray-900 mb-3">Insider Tips</h3>
                        <ul class="list-disc list-inside space-y-2">${renderList(insider_tips)}</ul>
                    </div>
                    ` : ''}
                    
                    ${risk_mitigation ? `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h3 class="font-bold text-gray-900 mb-3">Risk Mitigation</h3>
                        <ul class="list-disc list-inside space-y-2">${renderList(risk_mitigation)}</ul>
                    </div>
                    ` : ''}
                </div>

                ${next_actions ? `
                <div class="border-2 border-brand-purple rounded-lg p-4">
                    <h3 class="font-bold text-gray-900 mb-3">Next 7 Days</h3>
                    <ul class="list-decimal list-inside space-y-2">${renderList(next_actions)}</ul>
                </div>
                ` : ''}
            </div>
        </div>
    `;
}

setupCopyPlaybookButton() {
    const copyBtn = document.querySelector('.copy-playbook-btn');
    if (!copyBtn) return;

    copyBtn.addEventListener('click', () => {
        const playbookContent = document.getElementById('playbook-content');
        if (!playbookContent) return;

        // Create clean text version
        const cleanText = this.convertPlaybookToText(playbookContent);
        
        navigator.clipboard.writeText(cleanText).then(() => {
            const originalContent = copyBtn.innerHTML;
            copyBtn.classList.add('copied');
            copyBtn.innerHTML = `
                <svg class="checkmark w-4 h-4 mr-1" viewBox="0 0 24 24">
                    <path d="M9 12l2 2 4-4"></path>
                </svg>
                Copied!
            `;
            
            setTimeout(() => {
                copyBtn.classList.remove('copied');
                copyBtn.innerHTML = originalContent;
            }, 2000);
        }).catch(err => {
            console.error('Failed to copy playbook: ', err);
        });
    });
}

convertPlaybookToText(element) {
    const title = document.querySelector('.results-card-header h2')?.textContent || 'Sales Playbook';
    let text = `${title}\n${'='.repeat(title.length)}\n\n`;
    
    // Process each section
    const sections = element.querySelectorAll('h3, h4, h5');
    sections.forEach(section => {
        const sectionTitle = section.textContent.trim();
        text += `${sectionTitle}\n${'-'.repeat(sectionTitle.length)}\n`;
        
        // Get content after this heading until next heading
        let nextElement = section.nextElementSibling;
        while (nextElement && !['H3', 'H4', 'H5'].includes(nextElement.tagName)) {
            if (nextElement.tagName === 'UL') {
                const items = nextElement.querySelectorAll('li');
                items.forEach(item => {
                    text += `• ${item.textContent.trim()}\n`;
                });
            } else if (nextElement.tagName === 'P' || nextElement.classList.contains('border-l-4')) {
                text += `${nextElement.textContent.trim()}\n`;
            } else if (nextElement.classList.contains('border-l-3')) {
                text += `  ${nextElement.textContent.trim()}\n`;
            }
            nextElement = nextElement.nextElementSibling;
        }
        text += '\n';
    });
    
    return text;
}
   renderMarketAnalysis(data) {
       const {
           investment_thesis, financial_health, market_position, growth_catalysts,
           identified_risks, management_outlook, key_financial_metrics, bull_case, bear_case, next_steps
       } = data;

       return `
           <div class="results-card">
               <div class="results-card-header flex items-center gap-4 bg-brand-blue-bg">
                   <img src="/images/arti_right.png" alt="Arti" class="h-10 w-10 rounded-full border-2 border-white">
                   <h2 class="font-bold text-lg text-brand-blue-text">Market Analysis Summary</h2>
               </div>
               <div class="results-card-body space-y-8">
                   <div class="p-4 bg-brand-blue-bg/50 rounded-lg text-brand-blue-text">
                       ${marked.parse(investment_thesis)}
                   </div>

                   <div>
                       <h3 class="font-bold mb-3">Key Financial Metrics</h3>
                       <div class="flex flex-wrap gap-2">
                           ${key_financial_metrics && key_financial_metrics.length > 0 ? key_financial_metrics.map(metric => `
                               <span class="text-sm font-medium bg-gray-100 text-gray-800 px-3 py-1.5 rounded-lg">${metric}</span>`
                           ).join('') : '<p class="text-gray-500 text-sm">None mentioned.</p>'}
                       </div>
                   </div>

                   <div class="space-y-3 text-sm">
                       <p><strong>Financial Health:</strong> ${financial_health || 'Not detailed.'}</p>
                       <p><strong>Market Position:</strong> ${market_position || 'Not detailed.'}</p>
                       <p><strong>Management Outlook:</strong> ${management_outlook || 'Not detailed.'}</p>
                   </div>

                   <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                       <div>
                          <h4 class="font-bold text-green-700 mb-3">Growth Catalysts</h4>
                          <ul class="space-y-2 text-sm">${growth_catalysts && growth_catalysts.length > 0 ? growth_catalysts.map(c => `<li class="flex gap-2 items-start"><span class="text-green-500 mt-1">▲</span><span>${c}</span></li>`).join('') : '<li>None identified.</li>'}</ul>
                       </div>
                       <div>
                          <h4 class="font-bold text-red-700 mb-3">Identified Risks</h4>
                          <ul class="space-y-2 text-sm">${identified_risks && identified_risks.length > 0 ? identified_risks.map(r => `<li class="flex gap-2 items-start"><span class="text-red-500 mt-1">▼</span><span>${r}</span></li>`).join('') : '<li>None identified.</li>'}</ul>
                       </div>
                   </div>

                   <div>
                       <h3 class="font-bold mb-3">Bull vs. Bear Case</h3>
                       <div class="space-y-4">
                            <div class="p-3 bg-green-50 border-l-4 border-green-400">
                               <p class="font-bold text-green-800">Bull Case</p>
                               <p class="text-sm text-gray-700">${bull_case}</p>
                            </div>
                            <div class="p-3 bg-red-50 border-l-4 border-red-400">
                               <p class="font-bold text-red-800">Bear Case</p>
                               <p class="text-sm text-gray-700">${bear_case}</p>
                            </div>
                       </div>
                   </div>
                   
                   <div class="pt-4 border-t">
                       <p class="text-sm font-bold text-gray-800">${next_steps}</p>
                   </div>
                   
                   <div class="p-3 mt-4 text-xs text-gray-500 bg-gray-50 rounded-lg border border-gray-200">
                       <strong>Disclaimer:</strong> This content is for informational purposes only and does not constitute financial or investment advice. It is not a recommendation to buy or sell any security. You should always conduct your own research and consult a qualified financial professional before making any investment decisions.
                   </div>
               </div>
           </div>
       `;
   }
   renderDailyBriefing(data) {
    const { 
        quick_take, agency_headlines, industry_headlines, 
        last_updated, summary, opportunities_spotted 
    } = data;

    return `
        <div class="results-card">
            <div class="results-card-header flex items-center gap-4 bg-blue-50">
                <img src="/images/arti_right.png" alt="Arti" class="h-10 w-10 rounded-full border-2 border-white">
                <div>
                    <h2 class="font-bold text-lg text-blue-800">📰 Daily Federal Sales Briefing</h2>
                    <p class="text-sm text-blue-600">${last_updated ? new Date(last_updated).toLocaleDateString() : 'Today'}</p>
                </div>
            </div>
            <div class="results-card-body space-y-6">
                <div class="p-4 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                    <p class="text-blue-800 font-medium">${quick_take}</p>
                </div>

                ${opportunities_spotted > 0 ? `
                <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                    <p class="text-green-800 font-semibold">🎯 ${opportunities_spotted} potential opportunities spotted in today's news</p>
                </div>
                ` : ''}

                ${agency_headlines && agency_headlines.length > 0 ? `
                <div>
                    <h3 class="font-bold text-gray-900 mb-3">🏛️ Agency Headlines</h3>
                    <div class="space-y-3">
                        ${agency_headlines.map(item => `
                            <div class="border-l-3 border-blue-400 pl-4 py-2 bg-gray-50 rounded-r">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">${item.source}</span>
                                    <span class="text-xs text-gray-500">${item.date}</span>
                                </div>
                                <h4 class="font-semibold text-gray-900 mb-1">${item.headline}</h4>
                                <p class="text-sm text-gray-600">${item.summary}</p>
                                ${item.keywords && item.keywords.length > 0 ? `
                                <div class="flex flex-wrap gap-1 mt-2">
                                    ${item.keywords.map(keyword => 
                                        `<span class="text-xs bg-gray-200 text-gray-700 px-1.5 py-0.5 rounded">${keyword}</span>`
                                    ).join('')}
                                </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                ${industry_headlines && industry_headlines.length > 0 ? `
                <div>
                    <h3 class="font-bold text-gray-900 mb-3">📡 Industry Headlines</h3>
                    <div class="space-y-3">
                        ${industry_headlines.map(item => `
                            <div class="border-l-3 border-green-400 pl-4 py-2 bg-gray-50 rounded-r">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">${item.source}</span>
                                    <span class="text-xs text-gray-500">${item.date}</span>
                                </div>
                                <h4 class="font-semibold text-gray-900 mb-1">${item.headline}</h4>
                                <p class="text-sm text-gray-600">${item.summary}</p>
                                ${item.keywords && item.keywords.length > 0 ? `
                                <div class="flex flex-wrap gap-1 mt-2">
                                    ${item.keywords.map(keyword => 
                                        `<span class="text-xs bg-gray-200 text-gray-700 px-1.5 py-0.5 rounded">${keyword}</span>`
                                    ).join('')}
                                </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                ${(!agency_headlines || agency_headlines.length === 0) && (!industry_headlines || industry_headlines.length === 0) ? `
                <div class="text-center py-8">
                    <p class="text-gray-500">No recent federal news available. The RSS system may need to collect fresh data.</p>
                </div>
                ` : ''}

                <div class="pt-4 border-t text-center">
                    <p class="text-sm text-gray-600">${summary}</p>
                </div>
            </div>
        </div>
    `;
}
   renderGeneralAdvice(data) {
       const { quick_take, key_moves, mermaid_chart, talking_points, email_template, next_steps, response_type } = data;
       const title = response_type === 'interview' ? 'Your Interview Plan' : 'Your Game Plan';
       const talkingPointsTitle = response_type === 'interview' ? 'What They May Ask' : 'Key Questions to Ask';

       return `
           <div class="results-card">
               <div class="results-card-header flex items-center gap-4">
                   <img src="/images/arti_right.png" alt="Arti" class="h-10 w-10 rounded-full border-2 border-white">
                   <h2 class="font-bold text-lg text-brand-gray-900">${title}</h2>
               </div>
               <div class="results-card-body space-y-8">
                   <div class="p-4 bg-brand-purple/10 rounded-lg">${marked.parse(quick_take)}</div>
                   <div>
                       <h3 class="font-bold mb-3">Your Next 3 Moves</h3>
                       <div class="space-y-3">${key_moves.map((m, i) => `
                           <div class="flex gap-3 items-start">
                               <span class="flex-shrink-0 w-6 h-6 bg-brand-purple text-white rounded-full flex items-center justify-center text-xs font-bold mt-1">${i + 1}</span>
                              <div>
                                  <p class="font-medium text-gray-900">${m.action}</p>
                                  <p class="text-sm text-gray-600">${m.why}</p>
                              </div>
                          </div>`).join('')}
                      </div>
                  </div>
                  ${mermaid_chart ? `
                  <div>
                      <h3 class="font-bold mb-2">Visual Strategy</h3>
                      <div class="mermaid-container p-4 bg-white border rounded-lg">
                         <div id="mermaid-diagram" class="mermaid">${mermaid_chart}</div>
                      </div>
                      <div class="flex justify-end gap-2 mt-2">
                         <button class="btn btn-secondary text-xs py-1 px-2" id="download-png-btn">Download PNG</button>
                      </div>
                  </div>` : ''}
                  ${talking_points?.length > 0 ? `
                  <div>
                      <h3 class="font-bold mb-2">${talkingPointsTitle}</h3>
                      <ul class="list-disc list-inside space-y-1 text-sm text-gray-700">${talking_points.map(t => `<li>${t}</li>`).join('')}</ul>
                  </div>
                  ` : ''}
                  ${email_template ? `
                  <div>
                      <h3 class="font-bold mb-2">Email Template</h3>
                      <div class="relative">
                          <div class="copy-target bg-gray-50 rounded-lg p-3 font-mono text-xs text-gray-700 whitespace-pre-wrap border">${email_template}</div>
                           <button class="copy-btn" title="Copy to clipboard">
                              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                           </button>
                      </div>
                  </div>
                  ` : ''}
              </div>
          </div>
      `;
  }
  
  renderProspectAdvice(data) {
      const { summary, top_s_is, top_software_and_cloud, company_capabilities, naics_codes, prospect_recommendations } = data;
      const renderList = (items) => {
           if (!items || items.length === 0) return '<p class="text-sm text-gray-500">No data available</p>';
           return `<div class="space-y-3">${items.map(item => `
              <div class="p-3 bg-gray-50 border rounded-md">
                  <p class="font-bold text-sm text-gray-800">${item.company || 'N/A'}</p>
                  <p class="text-xs text-gray-600">${item.value || ''}</p>
              </div>
           `).join('')}</div>`;
      };

      return `
           <div class="results-card">
              <div class="results-card-header flex items-center gap-4 bg-brand-green-bg">
                  <img src="/images/arti_right.png" alt="Arti" class="h-10 w-10 rounded-full border-2 border-white">
                  <h2 class="font-bold text-lg text-brand-green-text">Prospecting Intelligence</h2>
              </div>
              <div class="results-card-body space-y-8">
                  <div class="p-4 bg-brand-green-bg/50 rounded-lg text-brand-green-text">${marked.parse(summary)}</div>
                  <div>
                      <h3 class="font-bold mb-3">Top Contractors (SIs)</h3>
                      ${renderList(top_s_is)}
                  </div>
                  <div>
                      <h3 class="font-bold mb-3">Top Software & Cloud Partners</h3>
                      ${renderList(top_software_and_cloud)}
                  </div>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                      <div>
                         <h4 class="font-bold text-gray-800 mb-3">Relevant Capabilities</h4>
                         <ul class="space-y-2 text-sm">${company_capabilities.map(c => `<li class="flex gap-2 items-center"><svg class="w-4 h-4 text-green-500 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>${c}</li>`).join('')}</ul>
                      </div>
                      <div>
                         <h4 class="font-bold text-gray-800 mb-3">NAICS Codes</h4>
                         <ul class="space-y-2 text-sm">${naics_codes.map(n => `<li class="flex gap-2 items-center"><svg class="w-4 h-4 text-green-500 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>${n.code ? `${n.code} - ${n.description}`: n}</li>`).join('')}</ul>
                      </div>
                  </div>
                  <div>
                      <h3 class="font-bold mb-3">Recommendations</h3>
                      <div class="p-4 bg-gray-50 border rounded-lg text-sm space-y-2">${prospect_recommendations.map(r => `<p>${r}</p>`).join('')}</div>
                  </div>
              </div>
          </div>
      `;
  }

  renderNewsAdvice(data) {
      const { 
          quick_take, background, implications, suggested_opening_lines, immediate_actions, strategic_moves, mermaid_chart,
          key_people_and_titles, suggested_discovery_questions, money_keywords 
      } = data;
      
      return `
          <div class="results-card">
              <div class="results-card-header flex items-center gap-4 bg-brand-blue-bg">
                  <img src="/images/arti_right.png" alt="Arti" class="h-10 w-10 rounded-full border-2 border-white">
                  <h2 class="font-bold text-lg text-brand-blue-text">News Analysis Summary</h2>
              </div>
              <div class="results-card-body space-y-8">
                  <div class="p-4 bg-brand-blue-bg/50 rounded-lg text-brand-blue-text">${marked.parse(quick_take)}</div>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                      <div>
                          <h3 class="font-bold mb-3">Key People & Titles</h3>
                          <div class="space-y-2 text-sm">
                              ${key_people_and_titles && key_people_and_titles.length > 0 ? key_people_and_titles.map(person => `
                                  <div class="flex items-center gap-2">
                                      <svg class="h-4 w-4 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" /></svg>
                                      <span>${person}</span>
                                  </div>`).join('') : '<p class="text-gray-500">None mentioned.</p>'}
                          </div>
                      </div>
                      <div>
                          <h3 class="font-bold mb-3">Money Keywords</h3>
                          <div class="flex flex-wrap gap-2">
                              ${money_keywords && money_keywords.length > 0 ? money_keywords.map(keyword => `
                                  <span class="text-xs font-medium bg-green-100 text-green-800 px-2.5 py-1 rounded-full">${keyword}</span>`
                              ).join('') : '<p class="text-gray-500">No funding keywords found.</p>'}
                          </div>
                      </div>
                  </div>
                  <div>
                      <h3 class="font-bold mb-3">Suggested Discovery Questions</h3>
                      <div class="space-y-2">
                          ${suggested_discovery_questions && suggested_discovery_questions.length > 0 ? suggested_discovery_questions.map(q => `
                              <div class="p-3 bg-gray-50 border rounded-md text-sm text-gray-800 flex gap-2">
                                  <span class="font-bold text-brand-purple">Q.</span>
                                  <span>${q}</span>
                              </div>`).join('') : '<p class="text-gray-500">No questions suggested.</p>'}
                      </div>
                  </div>
                  <div>
                      <h3 class="font-bold mb-3">Email Openers</h3>
                      <div class="space-y-2">${suggested_opening_lines.map((line, i) => `
                          <div class="relative p-3 bg-gray-50 border rounded-md text-sm text-gray-700">
                               <span class="copy-target"><strong>Option ${i + 1}:</strong> ${line}</span>
                               <button class="copy-btn" title="Copy to clipboard">
                                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                               </button>
                          </div>`).join('')}
                      </div>
                  </div>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                      <div>
                          <h4 class="font-bold text-gray-800 mb-3">Immediate Actions</h4>
                          <div class="space-y-3">${immediate_actions.map((action, i) => `
                              <div class="flex gap-3 items-start">
                                  <span class="flex-shrink-0 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs font-bold mt-1">${i + 1}</span>
                                  <div>
                                      <p class="font-medium text-sm text-gray-900">${action.action}</p>
                                      <p class="text-xs text-gray-600">${action.why}</p>
                                  </div>
                              </div>`).join('')}
                          </div>
                      </div>
                      <div>
                          <h4 class="font-bold text-gray-800 mb-3">Strategic Moves</h4>
                          <div class="space-y-3">${strategic_moves.map((move, i) => `
                              <div class="flex gap-3 items-start">
                                  <span class="flex-shrink-0 w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold mt-1">${i + 1}</span>
                                  <div>
                                      <p class="font-medium text-sm text-gray-900">${move.action}</p>
                                      <p class="text-xs text-gray-600">${move.why}</p>
                                  </div>
                              </div>`).join('')}
                          </div>
                      </div>
                  </div>
                  ${mermaid_chart ? `
                  <div>
                      <h3 class="font-bold mb-2">GTM Flow</h3>
                      <div class="mermaid-container p-4 bg-white border rounded-lg">
                          <div id="mermaid-diagram" class="mermaid">${mermaid_chart}</div>
                      </div>
                      <div class="flex justify-end gap-2 mt-2">
                         <button class="btn btn-secondary text-xs py-1 px-2" id="download-png-btn">Download PNG</button>
                      </div>
                  </div>` : ''}
              </div>
          </div>
      `;
  }

  setupInteractiveElements() {
      this.setupCopyButtons();
	  this.setupCopyPlaybookButton();
  }

  setupCopyButtons() {
      const copyButtons = this.elements.resultsContainer.querySelectorAll('.copy-btn');
      copyButtons.forEach(btn => {
          btn.addEventListener('click', (e) => {
              const target = e.currentTarget.parentElement.querySelector('.copy-target');
              if (target) {
                  navigator.clipboard.writeText(target.innerText).then(() => {
                      const originalContent = e.currentTarget.innerHTML;
                      e.currentTarget.classList.add('copied');
                      e.currentTarget.innerHTML = `
                          <svg class="checkmark" viewBox="0 0 24 24">
                              <path d="M9 12l2 2 4-4"></path>
                          </svg>
                          <span>Copied!</span>
                      `;
                      
                      const parent = e.currentTarget.parentElement;
                      parent.classList.add('copy-flash');
                      
                      setTimeout(() => {
                          e.currentTarget.classList.remove('copied');
                          e.currentTarget.innerHTML = originalContent;
                          parent.classList.remove('copy-flash');
                      }, 2000);
                  }).catch(err => {
                      console.error('Failed to copy text: ', err);
                  });
              }
          });
      });
  }

  setupMermaidDownloadButton() {
      const downloadPngBtn = document.getElementById('download-png-btn');

      if (downloadPngBtn) {
          downloadPngBtn.addEventListener('click', () => this.downloadMermaidAsPNG());
      }
  }

  downloadMermaidAsPNG() {
      const mermaidContainer = document.querySelector('.mermaid-container');
      if (!mermaidContainer || typeof html2canvas === 'undefined') {
          console.error("Mermaid container or html2canvas library not found.");
          return;
      }
      html2canvas(mermaidContainer, { backgroundColor: '#ffffff' }).then(canvas => {
          const a = document.createElement("a");
          a.href = canvas.toDataURL("image/png");
          a.download = "askarti-diagram.png";
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
      });
  }

  async renderMermaidChart() {
      try {
          await mermaid.run({
              nodes: document.querySelectorAll('.mermaid'),
          });
      } catch (error) {
          console.error('Mermaid rendering error:', error);
          const container = document.querySelector('.mermaid-container');
          if (container) container.innerHTML = '<p class="text-red-500 text-sm">Could not render visual plan.</p>';
      }
  }

  showModal() { 
      this.elements.aboutModal.classList.remove('hidden'); 
  }
  
  hideModal() { 
      this.elements.aboutModal.classList.add('hidden'); 
  }
}

// Initialize the app when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
  const app = new AskArti();
});
// Add this to your existing JavaScript, right after your AskArti class definition

// Enhanced AskArti class methods for news integration
AskArti.prototype.checkNewsStatus = async function() {
    try {
        // Check if we have recent news data by making a quick test call
        const testResponse = await fetch(CONFIG.API_ENDPOINT, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                situation: "test news availability",
                mode: "news-check"
            }),
        });
        
        // For now, just show the indicator since we know RSS is working
        const indicator = document.getElementById('news-freshness-indicator');
        const statusText = document.getElementById('news-status-text');
        
        if (indicator && statusText) {
            indicator.classList.remove('hidden');
            
            // Simulate fresh data timestamp
            const now = new Date();
            const updateTime = new Date(now.getTime() - (2 * 60 * 60 * 1000)); // 2 hours ago
            statusText.textContent = `Fresh federal news loaded • Updated ${this.getTimeAgo(updateTime)}`;
        }
    } catch (error) {
        console.log('News status check skipped:', error);
    }
};

AskArti.prototype.getTimeAgo = function(date) {
    const now = new Date();
    const diffMs = now - date;
    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
    const diffMins = Math.floor(diffMs / (1000 * 60));

    if (diffHours > 0) {
        return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
    } else if (diffMins > 0) {
        return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`;
    } else {
        return 'just now';
    }
};

// Enhanced displayAdvice to show news enhancement badge
const originalDisplayAdvice = AskArti.prototype.displayAdvice;
AskArti.prototype.displayAdvice = function(data) {
    // Call original function
    originalDisplayAdvice.call(this, data);
    
    // Add news enhancement badge if response likely used news context
    if (this.responseIncludesNewsContext(data)) {
        this.addNewsEnhancedBadge();
    }
};

AskArti.prototype.responseIncludesNewsContext = function(data) {
    // Check if response likely used news context
    const responseText = JSON.stringify(data).toLowerCase();
    const newsIndicators = [
        'recent news', 'announced', 'press release', 
        'this week', 'yesterday', 'today', 'latest',
        'recent', 'current', 'breaking', 'just reported'
    ];
    
    return newsIndicators.some(indicator => responseText.includes(indicator));
};

AskArti.prototype.addNewsEnhancedBadge = function() {
    const header = document.querySelector('.results-card-header h2');
    if (header && !header.querySelector('.news-enhanced-badge')) {
        const badge = document.createElement('span');
        badge.className = 'news-enhanced-badge ml-2';
        badge.innerHTML = `
            <div class="pulse-dot"></div>
            Enhanced with latest news
        `;
        header.appendChild(badge);
    }
};

// Update your initialization to check news status
document.addEventListener('DOMContentLoaded', () => {
    const app = new AskArti();
    
    // Check news status after a short delay
    setTimeout(() => {
        app.checkNewsStatus();
    }, 1000);
    
    // Store app globally for other functions
    window.askArti = app;
});
</script>
</body>
</html>