<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AskArti - Your 24/7 Sales Buddy</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="Get personalized federal sales advice from AskArti. Free AI tool provides SMART goals, customer messaging, and deal strategies for government contractors and sales professionals.">
    <meta name="keywords" content="federal sales, government sales, AI sales coach, sales strategy, federal contractors, govcon, sales advice">
    <meta name="author" content="Mark">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://askarti.com">
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://askarti.com/">
    <meta property="og:title" content="AskArti - Your Federal Sales Buddy">
    <meta property="og:description" content="Get personalized federal sales advice from AskArti. Free AI tool provides SMART goals, customer messaging, and deal strategies for government contractors and sales professionals.">
    <meta property="og:image" content="https://askarti.com/images/asklite.png">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://askarti.com/">
    <meta name="twitter:title" content="AskArti - Your Federal Sales Buddy">
    <meta name="twitter:description" content="Get personalized federal sales advice from AskArti.">
    <meta name="twitter:image" content="https://askarti.com/images/asklite.png">
    
    <!-- Favicons -->
    <link rel="icon" href="/images/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="theme-color" content="#523f9e">
    
    <!-- Preconnect -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Preload critical assets -->
    <link rel="preload" href="/images/asklite.png" as="image">
    <link rel="preload" href="/images/arti_right.png" as="image">
    
    <!-- Styles and Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WLGEPY5H4G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-WLGEPY5H4G');
    </script> 
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5A4E8C',
                        secondary: '#4A90E2',
                        light: '#F8F9FA',
                        text: {
                            DEFAULT: '#212529',
                            muted: '#6C757D'
                        }
                    }
                }
            }
        }
    </script>
    
<style>
    body { font-family: 'Inter', sans-serif; background-color: #F8F9FA; -webkit-font-smoothing: antialiased; }
    .loader { border: 3px solid #E9ECEF; border-top: 3px solid #5A4E8C; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .fade-in { animation: fadeIn 0.4s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .chat-message-user { background-color: #5A4E8C; color: white; border-radius: 18px 18px 4px 18px; }
    .chat-message-arti { background-color: #FFFFFF; color: #212529; border-radius: 18px 18px 18px 4px; border: 1px solid #DEE2E6; }
    .briefing-card { background-color: white; border-radius: 12px; border: 1px solid #E9ECEF; padding: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    .card-header { display: flex; align-items: center; gap: 0.75rem; padding-bottom: 0.75rem; margin-bottom: 1rem; border-bottom: 1px solid #E9ECEF; }
    .card-icon { color: #5A4E8C; flex-shrink: 0; }
    .card-title { font-size: 1.125rem; font-weight: 600; color: #212529; }
</style>
</head>
<body class="text-text">
    <div class="max-w-4xl mx-auto px-4 py-8">
        <header class="text-center mb-4">
            <a href="/" aria-label="AskArti Home" class="inline-block">
                <img src="/images/asklite.png" alt="AskArti" class="h-16 w-auto md:h-20 lg:h-24">
            </a>
        </header>

        <main class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-6">
            <div class="p-4 sm:p-6">
                <div id="chat-messages" class="max-h-[50vh] overflow-y-auto mb-4 pr-2">
                    <div class="flex items-start gap-3 mb-4">
                        <img src="/images/arti_right.png" alt="Arti" class="w-9 h-9 rounded-full flex-shrink-0">
                        <div class="chat-message-arti px-4 py-3 max-w-[85%]">
                            <p class="text-sm">What information do you need?</p>
                        </div>
                    </div>
                </div>
                <div class="flex gap-2">
                    <textarea id="chat-input" class="flex-1 px-4 py-2.5 bg-light border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary outline-none transition-all resize-none" placeholder="e.g., Who are the top contractors at DHS? or Help me build a strategy to compete with the incumbent..." rows="2"></textarea>
                    <button id="chat-send-btn" class="px-5 py-2.5 bg-primary hover:bg-opacity-90 text-white font-medium rounded-lg transition-colors flex items-center justify-center">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    </button>
                </div>
            </div>
        </main>
        
        <div id="results-container" class="space-y-6"></div>
        
    </div>

<script>
class StrategicAdvisorApp {
    constructor() {
        this.elements = {
            chatMessages: document.getElementById('chat-messages'),
            chatInput: document.getElementById('chat-input'),
            chatSendBtn: document.getElementById('chat-send-btn'),
            resultsContainer: document.getElementById('results-container'),
        };
        this.state = {
            isProcessing: false,
            conversationHistory: []
        };
        this.apiEndpoint = 'https://vd823jgh0a.execute-api.us-east-1.amazonaws.com/prod/AskArtiAPI';
        this.init();
    }

    init() {
    mermaid.initialize({ 
        startOnLoad: false, 
        securityLevel: 'strict',
        theme: 'base', // Use the base theme as a starting point for customization
        themeVariables: {
            // Chart background color
            background: '#FFFFFF', 

            // Default styles for nodes
            primaryColor: '#F6F5FB',      // Muted purple background
            primaryTextColor: '#403866',  // Deep purple for text
            primaryBorderColor: '#D8D2EF', // Soft purple border

            // Style for arrows and lines
            lineColor: '#5A4E8C',         
            
            // Extra colors you can use with classDef
            secondaryColor: '#E8E4F7',    
            tertiaryColor: '#D8D2EF'      
        }
    });
    this.setupEventListeners();
}

    setupEventListeners() {
        this.elements.chatSendBtn.addEventListener('click', () => this.getResponse());
        this.elements.chatInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                this.getResponse();
            }
        });
    }

    showLoading() {
        this.elements.resultsContainer.innerHTML = `
            <div class="flex justify-center items-center p-8 fade-in">
                <div class="loader"></div>
                <p class="ml-4 text-text-muted font-medium">Analyzing...</p>
            </div>`;
    }

    addChatMessage(content, role) {
        const isUser = role === 'user';
        const messageHtml = `
            <div class="flex items-start gap-3 mb-4 fade-in ${isUser ? 'justify-end' : ''}">
                ${!isUser ? `<img src="/images/arti_right.png" alt="Arti" class="w-9 h-9 rounded-full flex-shrink-0">` : ''}
                <div class="${isUser ? 'chat-message-user' : 'chat-message-arti'} px-4 py-3 max-w-[85%] text-sm">${content}</div>
            </div>`;
        this.elements.chatMessages.insertAdjacentHTML('beforeend', messageHtml);
        this.elements.chatMessages.scrollTop = this.elements.chatMessages.scrollHeight;
    }

    async getResponse() {
        const situation = this.elements.chatInput.value.trim();
        if (!situation || this.state.isProcessing) return;

        this.state.isProcessing = true;
        this.elements.chatSendBtn.disabled = true;
        this.elements.chatSendBtn.innerHTML = `<div class="loader w-6 h-6"></div>`;

        this.addChatMessage(situation, 'user');
        this.state.conversationHistory.push({ role: 'user', content: situation });
        this.elements.chatInput.value = '';
        this.showLoading();

        try {
            const response = await fetch(this.apiEndpoint, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    situation,
                    conversationHistory: this.state.conversationHistory
                })
            });

            if (!response.ok) throw new Error(`API Error: ${response.statusText}`);
            
            const data = await response.json();
            // We don't add the full JSON to history anymore to keep it clean.
            // A summary message could be added if desired.
            
            this.displayResponse(data);

        } catch (error) {
            console.error('Error fetching response:', error);
            this.elements.resultsContainer.innerHTML = `<div class="briefing-card text-red-500"><strong>Error:</strong> Failed to generate a response. Please check the console for details.</div>`;
        } finally {
            this.state.isProcessing = false;
            this.elements.chatSendBtn.disabled = false;
            this.elements.chatSendBtn.innerHTML = `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>`;
        }
    }
    
    // --- NEW RESPONSE ROUTER ---
    displayResponse(data) {
        switch(data.response_type) {
            case 'list':
                this.displayList(data);
                break;
            case 'briefing':
                this.displayStrategicBriefing(data);
                break;
            default:
                this.elements.resultsContainer.innerHTML = `<div class="briefing-card text-orange-500"><strong>Warning:</strong> Received an unknown response type.</div>`;
                console.warn("Unknown response type:", data);
        }
    }

    // --- NEW: Function to display a simple list ---
    displayList(data) {
        const { title, items } = data;
        let html = this.createCard(title, 'M3 4h18M3 8h18M3 12h18M3 16h18', 
            `<ul class="list-disc list-inside space-y-2 text-text-muted">
                ${items.map(item => `<li>${item}</li>`).join('')}
            </ul>`
        );
        this.elements.resultsContainer.innerHTML = html;
    }

    // --- Function to display a complex briefing ---
    displayStrategicBriefing(data) {
        const { executiveSummary, keyChallenges, strategicRecommendations, actionPlan, successMetrics, mermaidChart } = data;
        let html = '';

        if (executiveSummary) {
            html += this.createCard('Executive Summary', 'M21 12a9 9 0 11-18 0 9 9 0 0118 0z', `<div class="prose prose-sm max-w-none">${marked.parse(executiveSummary)}</div>`);
        }
        if (strategicRecommendations && strategicRecommendations.length) {
            html += this.createCard('Strategic Recommendations', 'M13 10V3L4 14h7v7l9-11h-7z',
                `<div class="space-y-4">${strategicRecommendations.map(p => `<div><h4 class="font-semibold text-text">${p.recommendation}</h4><p class="text-text-muted text-sm">${p.rationale}</p></div>`).join('')}</div>`
            );
        }
        if (actionPlan && actionPlan.length) {
            html += this.createCard('Action Plan', 'M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2',
                `<ul class="list-none space-y-3">${actionPlan.map(a => `<li class="flex items-start gap-3"><span class="text-secondary font-bold mt-1">→</span><span><strong>${a.owner}:</strong> ${a.task}</span></li>`).join('')}</ul>`
            );
        }
        if (mermaidChart) {
             html += this.createCard('Visual Model', 'M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341A6.002 6.002 0 006 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9', 
                `<div class="bg-light p-4 rounded-lg overflow-x-auto"><div class="mermaid">${mermaidChart}</div></div>`
            );
        }

        this.elements.resultsContainer.innerHTML = `<div class="space-y-6">${html}</div>`;
        if (mermaidChart) {
            setTimeout(() => mermaid.run(), 100);
        }
    }

    createCard(title, iconPath, content) {
        return `
            <div class="briefing-card fade-in">
                <div class="card-header">
                    <svg class="card-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${iconPath}"></path></svg>
                    <h3 class="card-title">${title}</h3>
                </div>
                <div>${content}</div>
            </div>`;
    }
}

document.addEventListener('DOMContentLoaded', () => new StrategicAdvisorApp());
</script>
</body>
</html>