<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AskArti - Your Fed Sales Buddy</title>
    
    <meta name="description" content="When your customer ghosts you and your boss wants impossible quota. Real federal sales advice that actually works.">
    <link rel="canonical" href="https://askarti.com">
    <link rel="icon" href="/images/favicon.ico" sizes="any">
    
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Serif+4:opsz,wght@8..60,400;8..60,600;8..60,700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Source Serif 4', 'serif'],
                    },
                    colors: {
                        primary: '#7C6BBE',
                        customPurple: { 50: '#F6F5FB', 100: '#E8E4F7', 200: '#D8D2EF', 300: '#C0B6E3', 500: '#7C6BBE', 700: '#5A4E8C', 900: '#403866' }
                    }
                }
            }
        }
    </script>
    
<style>
    body { font-family: 'Inter', sans-serif; background-color: #FAFBFC; -webkit-font-smoothing: antialiased; }
    .loader { border: 2px solid #E5E7EB; border-top: 2px solid #7C6BBE; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .fade-in { animation: fadeIn 0.3s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    .chat-message-user { background-color: #7C6BBE; color: white; border-radius: 18px 18px 4px 18px; }
    .chat-message-arti { background-color: #F3F4F6; color: #1F2937; border-radius: 18px 18px 18px 4px; }
    .result-card { background-color: white; border-radius: 12px; border: 1px solid #E5E7EB; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); }
    .account-plan-header { background: linear-gradient(135deg, #F6F5FB 0%, #E8E4F7 100%); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem; }
    
    /* --- NEW HBR ARTICLE STYLES --- */
    .hbr-article { padding: 2rem 2.5rem; }
    .hbr-article h1 { font-family: 'Source Serif 4', serif; font-size: 2rem; font-weight: 700; color: #111827; margin-bottom: 0.5rem; line-height: 1.2; }
    .hbr-article h2 { font-family: 'Source Serif 4', serif; font-size: 1.5rem; font-weight: 600; color: #111827; margin-top: 2rem; margin-bottom: 1rem; border-bottom: 1px solid #E5E7EB; padding-bottom: 0.5rem; }
    .hbr-article p, .hbr-article li { font-family: 'Source Serif 4', serif; font-size: 1.125rem; line-height: 1.7; color: #374151; }
    .hbr-article p { margin-bottom: 1.25rem; }
    .hbr-article ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1.25rem; }
    .hbr-article strong { font-weight: 700; color: #111827; }

    @media print { .no-print { display: none !important; } .result-card { box-shadow: none; } }
</style>

</head>
<body class="bg-gray-50 text-gray-900">
   <div class="max-w-3xl mx-auto px-4 py-6 min-h-screen">
       <header class="text-center mb-6">
           <a href="/" aria-label="AskArti Home"><img src="/images/asklite.png" alt="AskArti" class="h-16 sm:h-20 mx-auto"></a>
       </header>

       <main class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-6">
           <div class="p-4 sm:p-6">
               <div class="chat-container mb-4" id="chat-history">
                   <div class="flex items-start gap-3 mb-4">
                       <img src="/images/arti_right.png" alt="Arti" class="w-8 h-8 rounded-full flex-shrink-0">
                       <div class="chat-message-arti px-4 py-2.5 max-w-[85%]">
                           <p class="text-sm">Hey, I'm Arti. How can I help you strategize today?</p>
                       </div>
                   </div>
               </div>
               <div class="flex gap-2">
                   <input type="text" id="chat-input" class="flex-1 px-4 py-2.5 text-gray-900 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-customPurple-500 focus:border-transparent outline-none transition-all" placeholder="e.g., help me prep for an AWS interview" maxlength="500">
                   <button id="chat-send-btn" class="px-4 sm:px-6 py-2.5 bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium rounded-lg transition-colors flex items-center gap-2 no-print">
                       <span class="hidden sm:inline">Ask</span>
                       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>
                   </button>
               </div>
           </div>
       </main>

       <div id="results-container" class="space-y-4"></div>

       <footer class="text-center mt-12 space-y-4 pb-8 no-print">
            <p class="text-xs text-gray-500 max-w-xl mx-auto">© 2025 AskArti · AI can make errors. Please consult qualified professionals before making important business decisions.</p>
       </footer>
   </div>

<script>
class AskArtiApp {
    constructor() {
        this.elements = {
            chatHistory: document.getElementById('chat-history'),
            chatInput: document.getElementById('chat-input'),
            chatSendBtn: document.getElementById('chat-send-btn'),
            resultsContainer: document.getElementById('results-container'),
        };
        this.state = { conversationHistory: [] };
        this.apiEndpoint = 'https://vd823jgh0a.execute-api.us-east-1.amazonaws.com/prod/AskArtiAPI';
        this.setupEventListeners();
    }

    setupEventListeners() {
        this.elements.chatSendBtn.addEventListener('click', () => this.sendMessage());
        this.elements.chatInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                this.sendMessage();
            }
        });
    }

    addMessageToUI(content, isUser) {
        const messageClass = isUser ? 'chat-message-user' : 'chat-message-arti';
        const justifyClass = isUser ? 'justify-end' : 'justify-start';
        const messageHtml = `
            <div class="flex ${justifyClass} mb-4 fade-in">
                ${!isUser ? '<img src="/images/arti_right.png" alt="Arti" class="w-8 h-8 rounded-full flex-shrink-0 mr-3">' : ''}
                <div class="${messageClass} px-4 py-2.5 max-w-[85%] text-sm">${content}</div>
            </div>`;
        this.elements.chatHistory.insertAdjacentHTML('beforeend', messageHtml);
        this.elements.chatHistory.scrollTop = this.elements.chatHistory.scrollHeight;
    }

    showLoading() {
        this.elements.resultsContainer.innerHTML = `
            <div class="result-card text-center p-6">
                <div class="loader mx-auto mb-3"></div>
                <p class="text-sm text-gray-600 font-medium">Analyzing... a moment of brilliance is on its way.</p>
            </div>`;
    }

    async sendMessage() {
        const message = this.elements.chatInput.value.trim();
        if (!message) return;

        this.addMessageToUI(message, true);
        this.elements.chatInput.value = '';
        this.showLoading();

        this.state.conversationHistory.push({ role: 'user', content: message });

        try {
            const response = await fetch(this.apiEndpoint, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    situation: message,
                    conversationHistory: this.state.conversationHistory
                })
            });
            if (!response.ok) throw new Error('API request failed');
            
            const data = await response.json();
            
            this.state.conversationHistory.push({ role: 'assistant', content: "Generated response." }); // Add placeholder
            this.displayResponse(data);

        } catch (error) {
            console.error('Error:', error);
            this.elements.resultsContainer.innerHTML = `<div class="result-card text-center text-red-600">Error generating response. Please try again.</div>`;
        }
    }

    displayResponse(data) {
        this.elements.resultsContainer.innerHTML = ''; // Clear loading indicator
        
        // --- ROUTING LOGIC ON FRONTEND ---
        if (data.response_type === 'analysis' && data.analysis_markdown) {
            this.displayHbrArticle(data.analysis_markdown);
        } else {
            this.displaySalesPlan(data);
        }
    }

    displayHbrArticle(markdown) {
        const articleHtml = `
            <div class="result-card hbr-article fade-in">
                ${marked.parse(markdown)}
            </div>`;
        this.elements.resultsContainer.innerHTML = articleHtml;
    }

    displaySalesPlan(data) {
        const { account_name, executive_summary, strategic_assessment, partner_ecosystem, next_steps } = data;
        let html = `
            <div class="account-plan-header">
                <h2 class="text-xl font-bold text-gray-900">${account_name || 'Strategic Sales Plan'}</h2>
            </div>
            ${executive_summary ? `<div class="result-card"><h3>Executive Summary</h3><p>${executive_summary}</p></div>` : ''}
            
            ${strategic_assessment ? `<div class="result-card">
                <h3>Strategic Assessment</h3>
                <h4>Current State</h4><p>${strategic_assessment.current_state || ''}</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                    <div><h4>Key Challenges</h4><ul class="list-disc list-inside">${(strategic_assessment.key_challenges || []).map(c => `<li>${c}</li>`).join('')}</ul></div>
                    <div><h4>Opportunities</h4><ul class="list-disc list-inside">${(strategic_assessment.opportunities || []).map(o => `<li>${o}</li>`).join('')}</ul></div>
                </div>
            </div>` : ''}
            
            ${partner_ecosystem ? `<div class="result-card">
                <h3>Partner Ecosystem</h3>
                <div class="space-y-4">
                    <div><h4>Top Prime Contractors</h4><p>${(partner_ecosystem.top_prime_contractors || []).join(', ')}</p></div>
                    <div><h4>Potential ISV Partners</h4><p>${(partner_ecosystem.potential_isv_partners || []).join(', ')}</p></div>
                    <div><h4>Competitive Landscape</h4><p>${partner_ecosystem.competitive_landscape || ''}</p></div>
                </div>
            </div>` : ''}

            ${next_steps ? `<div class="result-card">
                <h3>Next Steps</h3>
                <div class="space-y-4">${(next_steps || []).map(step => `
                    <div class="border-l-4 border-customPurple-500 pl-4 py-2">
                        <h4 class="font-semibold text-gray-900">${step.action}</h4>
                        <p class="text-sm text-gray-700">${step.rationale} <span class="font-medium text-customPurple-700">(${step.timeline})</span></p>
                    </div>`).join('')}
                </div>
            </div>` : ''}`;

        this.elements.resultsContainer.innerHTML = html;
    }
}

document.addEventListener('DOMContentLoaded', () => {
    new AskArtiApp();
});
</script>
</body>
</html>