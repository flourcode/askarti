<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AskArti - Your Fed Sales Buddy</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="When your customer ghosts you and your boss wants impossible quota. Real federal sales advice that actually works.">
    <meta name="keywords" content="federal sales, government sales, sales strategy, federal contractors, govcon">
    <meta name="author" content="Mark">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://askarti.com">
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://askarti.com/">
    <meta property="og:title" content="AskArti - Your Federal Sales Buddy">
    <meta property="og:description" content="Real federal sales advice from someone who gets it. No BS, just results.">
    <meta property="og:image" content="https://askarti.com/images/asklite.png">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://askarti.com/">
    <meta name="twitter:title" content="AskArti - Your Federal Sales Buddy">
    <meta name="twitter:description" content="Real federal sales advice that actually works.">
    <meta name="twitter:image" content="https://askarti.com/images/asklite.png">
    
    <!-- Favicons -->
    <link rel="icon" href="/images/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="theme-color" content="#7C6BBE">
    
    <!-- Preconnect -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Preload critical assets -->
    <link rel="preload" href="/images/asklite.png" as="image">
    <link rel="preload" href="/images/arti_right.png" as="image">
    
    <!-- Styles and Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WLGEPY5H4G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-WLGEPY5H4G');
    </script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#7C6BBE',
                        customPurple: {
                            50: '#F6F5FB',
                            100: '#E8E4F7',
                            200: '#D8D2EF',
                            300: '#C0B6E3',
                            500: '#7C6BBE',
                            700: '#5A4E8C',
                            900: '#403866'
                        }
                    }
                }
            }
        }
    </script>
    
<style>
    body {
        font-family: 'Inter', sans-serif;
        margin: 0;
        padding: 0;
        background-color: #FAFBFC;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    /* Clean, professional loader */
    .loader {
        border: 2px solid #E5E7EB;
        border-top: 2px solid #7C6BBE;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Subtle animations */
    .fade-in {
        animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(8px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Clean chat messages */
    .chat-message-user {
        background-color: #7C6BBE;
        color: white;
        border-radius: 18px 18px 4px 18px;
    }

    .chat-message-arti {
        background-color: #F3F4F6;
        color: #1F2937;
        border-radius: 18px 18px 18px 4px;
    }

    /* Typing indicator */
    .typing-indicator {
        display: flex;
        gap: 4px;
        padding: 12px 16px;
        background-color: #F3F4F6;
        border-radius: 18px 18px 18px 4px;
        width: fit-content;
    }

    .typing-dot {
        width: 8px;
        height: 8px;
        background-color: #9CA3AF;
        border-radius: 50%;
        animation: typing 1.4s infinite ease-in-out;
    }

    .typing-dot:nth-child(1) { animation-delay: -0.32s; }
    .typing-dot:nth-child(2) { animation-delay: -0.16s; }

    @keyframes typing {
        0%, 80%, 100% {
            transform: scale(0.8);
            opacity: 0.5;
        }
        40% {
            transform: scale(1);
            opacity: 1;
        }
    }

    /* Clean cards */
    .result-card {
        background-color: white;
        border-radius: 12px;
        border: 1px solid #E5E7EB;
        padding: 1.5rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        margin-bottom: 1rem;
    }

    /* Playbook specific styles */
    .playbook-header {
        background: linear-gradient(135deg, #7C6BBE 0%, #5A4E8C 100%);
        color: white;
        border-radius: 12px;
        padding: 2rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }

    .playbook-header::before {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 100px;
        height: 100px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        transform: translate(50%, -50%);
    }

    .playbook-section {
        border-left: 4px solid #7C6BBE;
        padding-left: 1.5rem;
        margin-bottom: 2rem;
    }

    .timeline-item {
        position: relative;
        padding-left: 2rem;
        padding-bottom: 1.5rem;
    }

    .timeline-item::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0.5rem;
        width: 12px;
        height: 12px;
        background: #7C6BBE;
        border-radius: 50%;
        border: 3px solid white;
        box-shadow: 0 0 0 3px #E5E7EB;
    }

    .timeline-item::after {
        content: '';
        position: absolute;
        left: 5px;
        top: 1.5rem;
        width: 2px;
        height: calc(100% - 1rem);
        background: #E5E7EB;
    }

    .timeline-item:last-child::after {
        display: none;
    }

    .metric-highlight {
        background: linear-gradient(135deg, #F6F5FB 0%, #E8E4F7 100%);
        border-radius: 8px;
        padding: 1rem;
        text-align: center;
        border: 1px solid #D8D2EF;
    }

    .metric-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: #7C6BBE;
        margin-bottom: 0.25rem;
    }

    .metric-label {
        font-size: 0.75rem;
        color: #6B7280;
        font-weight: 500;
    }

    /* Scenario buttons */
    .scenario-btn {
        background-color: #F3F4F6;
        color: #374151;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s ease;
        border: 1px solid transparent;
        cursor: pointer;
        text-align: center;
        display: block;
        width: 100%;
    }

    .scenario-btn:hover {
        background-color: #7C6BBE;
        color: white;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(124, 107, 190, 0.3);
    }

    .scenario-btn.active {
        background-color: #7C6BBE;
        color: white;
    }

    /* Progress indicators */
    .progress-bar {
        width: 100%;
        height: 8px;
        background: #E5E7EB;
        border-radius: 4px;
        overflow: hidden;
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #7C6BBE 0%, #5A4E8C 100%);
        border-radius: 4px;
        transition: width 0.5s ease;
    }

    /* Action items */
    .action-item {
        background: #F9FAFB;
        border: 1px solid #E5E7EB;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 0.75rem;
        position: relative;
    }

    .action-item.urgent {
        border-left: 4px solid #EF4444;
        background: #FEF2F2;
    }

    .action-item.high-impact {
        border-left: 4px solid #10B981;
        background: #F0FDF4;
    }

    /* Mobile optimizations */
    @media (max-width: 640px) {
        .result-card {
            padding: 1rem;
        }

        .playbook-header {
            padding: 1.5rem;
        }

        .playbook-section {
            padding-left: 1rem;
        }

        .scenario-btn {
            font-size: 0.8125rem;
            padding: 0.5rem 1rem;
        }
    }

    /* Print styles */
    @media print {
        body {
            background-color: white;
        }
        
        .no-print {
            display: none !important;
        }
        
        .result-card {
            box-shadow: none;
            border: 1px solid #E5E7EB;
            break-inside: avoid;
        }
    }
</style>

</head>
<body class="bg-gray-50 text-gray-900">
    <div class="max-w-4xl mx-auto px-4 py-6 min-h-screen">
        <!-- Clean header -->
        <header class="text-center mb-6">
            <a href="/" aria-label="AskArti Home">
                <img src="/images/asklite.png" alt="AskArti" class="h-16 sm:h-20 mx-auto">
            </a>
        </header>

        <!-- Scenario Selection -->
        <div id="scenario-selector" class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-6">
            <div class="p-4 sm:p-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4 text-center">What's your situation?</h2>
                
                <!-- Quick Input -->
                <div class="mb-6">
                    <div class="flex gap-2">
                        <input 
                            type="text" 
                            id="situation-input"
                            class="flex-1 px-4 py-3 text-gray-900 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-customPurple-500 focus:border-transparent outline-none transition-all"
                            placeholder="e.g., 'Selling cybersecurity to DHS' or 'Partner team conflict on deals'"
                            maxlength="200">
                        <button 
                            id="generate-playbook-btn" 
                            class="px-6 py-3 bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium rounded-lg transition-colors">
                            Generate Playbook
                        </button>
                    </div>
                </div>

                <!-- Common Scenarios -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <button class="scenario-btn" data-scenario="federal-cyber-sale">
                        🛡️ <strong>Federal Cyber Sale</strong><br>
                        <span class="text-sm opacity-75">Selling cybersecurity to federal agencies</span>
                    </button>
                    <button class="scenario-btn" data-scenario="partner-alignment">
                        🤝 <strong>Partner Alignment</strong><br>
                        <span class="text-sm opacity-75">Resolving partner/account team conflicts</span>
                    </button>
                    <button class="scenario-btn" data-scenario="gtm-strategy">
                        🎯 <strong>GTM Strategy</strong><br>
                        <span class="text-sm opacity-75">Building go-to-market plans</span>
                    </button>
                    <button class="scenario-btn" data-scenario="deal-rescue">
                        🚨 <strong>Deal Rescue</strong><br>
                        <span class="text-sm opacity-75">Saving stalled or at-risk deals</span>
                    </button>
                    <button class="scenario-btn" data-scenario="stakeholder-mapping">
                        👥 <strong>Stakeholder Mapping</strong><br>
                        <span class="text-sm opacity-75">Navigating complex decision processes</span>
                    </button>
                    <button class="scenario-btn" data-scenario="competitive-displacement">
                        ⚔️ <strong>Competitive Displacement</strong><br>
                        <span class="text-sm opacity-75">Displacing entrenched incumbents</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Loading state -->
        <div id="loading-container" class="hidden text-center py-8">
            <div class="inline-flex items-center gap-3 text-gray-600">
                <div class="loader"></div>
                <span id="loading-message" class="text-sm font-medium">Building your personalized playbook...</span>
            </div>
        </div>

        <!-- Error state -->
        <div id="error-message" class="hidden bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
            <p class="text-red-700 font-medium text-sm">Something went wrong. Let's try that again.</p>
            <button id="retry-btn" class="mt-2 text-red-700 underline text-sm">Try again</button>
        </div>

        <!-- Playbook Container -->
        <div id="playbook-container" class="hidden space-y-4"></div>

        <!-- Footer -->
        <footer class="text-center mt-12 space-y-4 pb-8 no-print">
            <div class="flex justify-center gap-6 text-sm">
                <button id="about-btn" class="text-customPurple-500 hover:text-customPurple-700 font-medium">About</button>
                <button id="share-btn" class="text-customPurple-500 hover:text-customPurple-700 font-medium">Share</button>
                <a href="mailto:mark@subhoo.com" class="text-customPurple-500 hover:text-customPurple-700 font-medium">Contact</a>
            </div>

            <!-- Sponsor message -->
            <div class="max-w-xl mx-auto bg-customPurple-50 border border-customPurple-200 rounded-lg p-4 text-sm">
                <p class="text-customPurple-900 font-medium mb-1">Hey there! Enjoying these results?</p>
                <p class="text-customPurple-700">
                   By the time I pay off all my scientists, all the lab coats, and my AWS bill…I'm losin' money every time you Ask Arti something...Sponsor this spot for $99/mo.
                </p>
                <a href="mailto:mark@subhoo.com" class="text-customPurple-500 hover:text-customPurple-700 font-medium underline">
                    Help keep Arti alive →
                </a>
            </div>

            <p class="text-xs text-gray-500 max-w-xl mx-auto">
                AskArti.com results are provided for informational and educational purposes only and do not constitute professional business advice. AI can make errors that may not suit your specific situation. Please consult qualified professionals before making important business decisions.
            </p>

            <p class="text-xs text-gray-400">
                © 2025 AskArti · Built by sellers, for sellers
            </p>
        </footer>
    </div>

    <!-- About Modal -->
    <div id="about-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md p-6">
            <div class="flex justify-between items-start mb-4">
                <div class="flex items-center gap-3">
                    <img src="images/oldmark.jpg" alt="Mark" class="w-12 h-12 rounded-full">
                    <div>
                        <h2 class="text-lg font-bold text-gray-900">Hi, I'm Mark</h2>
                        <p class="text-xs text-gray-600">Retired Federal Sales Guy</p>
                    </div>
                </div>
                <button id="close-about" class="text-gray-400 hover:text-gray-600">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="space-y-3 text-sm text-gray-700">
                <p>
                    I built AskArti to help sellers spend more time with their customers. Arti's not perfect but is available 24/7 when you need to strategize or just vent.
                </p>
                
                <div class="bg-gray-50 rounded-lg p-3 text-xs">
                    <p class="font-medium text-gray-800 mb-1">Privacy First</p>
                    <p class="text-gray-600">
                        Zero storage. Zero tracking. Everything happens in-memory using AWS Serverless and vanishes after your session. 
                        The AI models might learn from our chats, but I don't keep anything.
                    </p>
                </div>
                
                <div class="pt-3">
                    <a href="https://calendly.com/markflournoy/30min" target="_blank" 
                       class="block w-full bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium py-2.5 rounded-lg text-center transition-colors">
                        Want to chat about AI or Sales? →
                    </a>
                </div>
            </div>
        </div>
    </div>

<script>
// Configuration
const CONFIG = {
    API_ENDPOINT: 'https://vd823jgh0a.execute-api.us-east-1.amazonaws.com/prod/AskArtiAPI',
    REQUEST_TIMEOUT: 25000,
    MAX_RETRIES: 2,
    RETRY_DELAY: 2000,
    MAX_INPUT_LENGTH: 200
};

// Playbook Templates Library
const PLAYBOOK_TEMPLATES = {
    'federal-cyber-sale': {
        title: 'Federal Cybersecurity Sales Playbook',
        subtitle: 'Your complete guide to selling cyber solutions to federal agencies',
        icon: '🛡️',
        context_keywords: ['cyber', 'security', 'federal', 'government', 'dhs', 'cisa', 'dod'],
        sections: {
            situation_analysis: {
                title: 'Situation Analysis',
                content: {
                    market_dynamics: [
                        'Federal cyber spending at $18.8B annually with 12% YoY growth',
                        'Zero Trust mandate driving urgency across all agencies',
                        'CISA directives creating compliance deadlines',
                        'Supply chain security requirements tightening'
                    ],
                    key_challenges: [
                        'Complex Authority to Operate (ATO) processes',
                        'FedRAMP authorization requirements',
                        'Budget cycle constraints (Oct-Sep)',
                        'Incumbent vendor relationships'
                    ]
                }
            },
            key_moves: {
                title: 'Your Next Moves',
                timeline: [
                    {
                        timeframe: 'Week 1-2',
                        action: 'Map the Security Architecture',
                        details: 'Identify CISO, Deputy CISO, and security architects. Understand current stack and pain points.',
                        priority: 'urgent'
                    },
                    {
                        timeframe: 'Week 3-4', 
                        action: 'Build Compliance Narrative',
                        details: 'Position your solution against NIST, FISMA, and agency-specific requirements.',
                        priority: 'high-impact'
                    },
                    {
                        timeframe: 'Week 5-8',
                        action: 'Demonstrate ROI & Risk Reduction',
                        details: 'Show measurable security improvements and cost savings vs. current tools.',
                        priority: 'high-impact'
                    }
                ]
            },
            stakeholder_strategy: {
                title: 'Stakeholder Strategy',
                stakeholders: [
                    {
                        role: 'CISO/Deputy CISO',
                        influence: 'high',
                        priorities: ['Risk reduction', 'Compliance', 'Team efficiency'],
                        approach: 'Lead with risk metrics and compliance coverage'
                    },
                    {
                        role: 'Security Architects',
                        influence: 'high',
                        priorities: ['Technical fit', 'Integration ease', 'Performance'],
                        approach: 'Deep technical discussions and proof of concepts'
                    },
                    {
                        role: 'Procurement/Contracting',
                        influence: 'medium',
                        priorities: ['Price', 'Contract terms', 'Vendor stability'],
                        approach: 'Emphasize value and long-term partnership'
                    }
                ]
            },
            talking_points: {
                title: 'Power Questions & Talking Points',
                discovery_questions: [
                    'What percentage of your security alerts actually get investigated?',
                    'How long does your current ATO process take?',
                    'Which CISA directives are you struggling to implement?',
                    'What would a 50% reduction in false positives mean to your team?'
                ],
                value_props: [
                    'Accelerated ATO with pre-built compliance documentation',
                    'FedRAMP authorized and IL-4/5 ready out of the box',
                    'Integrates with your existing SIEM and SOAR tools',
                    'Proven ROI: 40% reduction in security analyst workload'
                ]
            },
            competitive_strategy: {
                title: 'Competitive Strategy',
                likely_competitors: [
                    {
                        name: 'Incumbent Legacy Vendor',
                        weakness: 'Slow to innovate, expensive maintenance',
                        counter: 'Show modern architecture and total cost comparison'
                    },
                    {
                        name: 'Pure-play Security Vendor',
                        weakness: 'Limited federal compliance experience',
                        counter: 'Emphasize your federal compliance expertise and support'
                    }
                ]
            },
            resources: {
                title: 'Key Resources & Next Steps',
                immediate_actions: [
                    'Request copy of their cybersecurity framework assessment',
                    'Schedule technical deep-dive with security architects',
                    'Provide FedRAMP compliance documentation',
                    'Connect with their systems integrator partner'
                ],
                helpful_resources: [
                    'NIST Cybersecurity Framework mapping document',
                    'ROI calculator for federal agencies',
                    'Customer reference from similar agency',
                    'Proof of concept deployment guide'
                ]
            }
        },
        metrics: [
            { label: 'Avg Deal Size', value: '$2.3M' },
            { label: 'Sales Cycle', value: '18 months' },
            { label: 'Win Rate', value: '34%' },
            { label: 'Market Growth', value: '+12% YoY' }
        ]
    },

    'partner-alignment': {
        title: 'Partner & Account Team Alignment Playbook',
        subtitle: 'Resolving conflicts and building collaborative partnerships',
        icon: '🤝',
        context_keywords: ['partner', 'conflict', 'team', 'alignment', 'collaboration'],
        sections: {
            situation_analysis: {
                title: 'Conflict Assessment',
                content: {
                    common_issues: [
                        'Unclear territory or account ownership',
                        'Revenue recognition disputes',
                        'Conflicting customer messaging',
                        'Resource allocation disagreements'
                    ],
                    impact_areas: [
                        'Customer experience and trust',
                        'Deal velocity and closure rates',
                        'Team morale and retention',
                        'Company reputation in market'
                    ]
                }
            },
            key_moves: {
                title: 'Resolution Strategy',
                timeline: [
                    {
                        timeframe: 'Day 1-3',
                        action: 'Diagnose Root Causes',
                        details: 'Meet 1:1 with each party to understand underlying issues and motivations.',
                        priority: 'urgent'
                    },
                    {
                        timeframe: 'Week 1',
                        action: 'Establish Clear Rules of Engagement',
                        details: 'Document account ownership, revenue splits, and customer interaction protocols.',
                        priority: 'high-impact'
                    },
                    {
                        timeframe: 'Week 2-4',
                        action: 'Create Joint Success Metrics',
                        details: 'Align on shared KPIs and accountability measures that benefit both teams.',
                        priority: 'high-impact'
                    }
                ]
            },
            stakeholder_strategy: {
                title: 'Key Players',
                stakeholders: [
                    {
                        role: 'Direct Account Rep',
                        influence: 'high',
                        priorities: ['Quota attainment', 'Customer relationships', 'Commission'],
                        approach: 'Acknowledge their customer investment and ensure fair recognition'
                    },
                    {
                        role: 'Partner Rep',
                        influence: 'high', 
                        priorities: ['Partner satisfaction', 'Deal registration', 'Support'],
                        approach: 'Emphasize mutual value and long-term partnership benefits'
                    },
                    {
                        role: 'Sales Leadership',
                        influence: 'high',
                        priorities: ['Revenue goals', 'Team harmony', 'Customer success'],
                        approach: 'Present win-win solutions that protect revenue and relationships'
                    }
                ]
            },
            talking_points: {
                title: 'Facilitation Framework',
                mediation_questions: [
                    'What does success look like for each of you?',
                    'Where do your priorities actually align?',
                    'What would make this partnership truly valuable?',
                    'How can we protect the customer experience above all?'
                ],
                alignment_principles: [
                    'Customer success drives everyone\'s success',
                    'Clear accountability prevents future conflicts',
                    'Shared metrics create shared incentives',
                    'Regular communication prevents small issues from becoming big problems'
                ]
            },
            competitive_strategy: {
                title: 'Governance Framework',
                likely_competitors: [
                    {
                        name: 'Status Quo (Continued Conflict)',
                        weakness: 'Damages all parties and customers',
                        counter: 'Show concrete examples of lost deals due to internal friction'
                    }
                ]
            },
            resources: {
                title: 'Implementation Tools',
                immediate_actions: [
                    'Draft territory and account assignment matrix',
                    'Create customer interaction protocols',
                    'Establish regular partnership review meetings',
                    'Set up shared CRM visibility and updates'
                ],
                helpful_resources: [
                    'Partner conflict resolution template',
                    'Joint account planning framework',
                    'Customer handoff process documentation',
                    'Success metrics tracking dashboard'
                ]
            }
        },
        metrics: [
            { label: 'Resolution Time', value: '2-4 weeks' },
            { label: 'Success Rate', value: '78%' },
            { label: 'Team Satisfaction', value: '+45%' },
            { label: 'Deal Velocity', value: '+23%' }
        ]
    },

    'gtm-strategy': {
       title: 'Go-to-Market Strategy Playbook',
       subtitle: 'Building winning GTM plans for federal markets',
       icon: '🎯',
       context_keywords: ['gtm', 'go-to-market', 'strategy', 'launch', 'market', 'plan'],
       sections: {
           situation_analysis: {
               title: 'Market Assessment',
               content: {
                   market_dynamics: [
                       'Federal IT spending at $102B annually with digital transformation driving growth',
                       'Cloud-first mandates creating new opportunities',
                       'Procurement modernization enabling faster acquisitions',
                       'Small business set-asides requiring strategic partnerships'
                   ],
                   key_considerations: [
                       'Compliance requirements (FedRAMP, FISMA, etc.)',
                       'Budget cycles and procurement timelines',
                       'Security clearance requirements',
                       'Incumbent vendor relationships and switching costs'
                   ]
               }
           },
           key_moves: {
               title: 'GTM Execution Plan',
               timeline: [
                   {
                       timeframe: 'Month 1',
                       action: 'Market Intelligence & Positioning',
                       details: 'Research target agencies, analyze competitors, and define unique value proposition.',
                       priority: 'urgent'
                   },
                   {
                       timeframe: 'Month 2-3',
                       action: 'Build Partner Ecosystem',
                       details: 'Identify and onboard key systems integrators and reseller partners.',
                       priority: 'high-impact'
                   },
                   {
                       timeframe: 'Month 4-6',
                       action: 'Execute Demand Generation',
                       details: 'Launch targeted campaigns, attend federal events, and build sales pipeline.',
                       priority: 'high-impact'
                   }
               ]
           },
           stakeholder_strategy: {
               title: 'Target Audience Mapping',
               stakeholders: [
                   {
                       role: 'IT Directors/CIOs',
                       influence: 'high',
                       priorities: ['Modernization', 'Cost reduction', 'Mission support'],
                       approach: 'Focus on strategic business outcomes and transformation'
                   },
                   {
                       role: 'Technical Teams',
                       influence: 'medium',
                       priorities: ['Performance', 'Integration', 'Support'],
                       approach: 'Provide detailed technical specifications and proof points'
                   },
                   {
                       role: 'Procurement Officers',
                       influence: 'high',
                       priorities: ['Compliance', 'Price', 'Contract terms'],
                       approach: 'Ensure all documentation and certifications are complete'
                   }
               ]
           },
           talking_points: {
               title: 'Messaging & Positioning',
               discovery_questions: [
                   'What are your top 3 IT modernization priorities?',
                   'How do you currently measure mission success?',
                   'What compliance requirements are most challenging?',
                   'Which vendors do you consider your trusted partners?'
               ],
               value_props: [
                   'Purpose-built for federal compliance and security requirements',
                   'Proven ROI with agencies similar to yours',
                   'Comprehensive support from implementation to optimization',
                   'Scalable solution that grows with your mission needs'
               ]
           },
           competitive_strategy: {
               title: 'Competitive Positioning',
               likely_competitors: [
                   {
                       name: 'Legacy Federal Contractors',
                       weakness: 'Slow innovation, high costs, outdated technology',
                       counter: 'Demonstrate modern capabilities and cost-effectiveness'
                   },
                   {
                       name: 'Commercial Leaders',
                       weakness: 'Limited federal experience and compliance',
                       counter: 'Emphasize federal-specific features and expertise'
                   }
               ]
           },
           resources: {
               title: 'Launch Toolkit',
               immediate_actions: [
                   'Complete FedRAMP or other required certifications',
                   'Develop federal-specific marketing collateral',
                   'Establish GSA Schedule or other contract vehicles',
                   'Build partner channel program and training'
               ],
               helpful_resources: [
                   'Federal market sizing and opportunity analysis',
                   'Competitive battle cards for federal scenarios',
                   'Partner onboarding and certification program',
                   'Federal sales training curriculum'
               ]
           }
       },
       metrics: [
           { label: 'Time to Market', value: '6 months' },
           { label: 'Pipeline Goal', value: '$5M+' },
           { label: 'Partner Count', value: '8-12' },
           { label: 'Market Share', value: '3-5%' }
       ]
   },

   'deal-rescue': {
       title: 'Deal Rescue Playbook',
       subtitle: 'Saving stalled and at-risk federal deals',
       icon: '🚨',
       context_keywords: ['stalled', 'stuck', 'rescue', 'risk', 'losing', 'problem'],
       sections: {
           situation_analysis: {
               title: 'Deal Diagnosis',
               content: {
                   common_stall_points: [
                       'Technical evaluation delays or objections',
                       'Budget or procurement complications',
                       'Stakeholder changes or competing priorities',
                       'Competitive pressure or new entrants'
                   ],
                   warning_signs: [
                       'Decreased communication frequency',
                       'Meeting cancellations or delays',
                       'Requests for additional information',
                       'Introduction of new evaluation criteria'
                   ]
               }
           },
           key_moves: {
               title: 'Recovery Strategy',
               timeline: [
                   {
                       timeframe: 'Week 1',
                       action: 'Conduct Deal Autopsy',
                       details: 'Interview all stakeholders to understand real issues and decision process.',
                       priority: 'urgent'
                   },
                   {
                       timeframe: 'Week 2',
                       action: 'Rebuild Champion Network',
                       details: 'Re-engage supporters and identify new champions who can advocate internally.',
                       priority: 'urgent'
                   },
                   {
                       timeframe: 'Week 3-4',
                       action: 'Address Core Objections',
                       details: 'Develop specific responses to technical, financial, or procedural concerns.',
                       priority: 'high-impact'
                   }
               ]
           },
           stakeholder_strategy: {
               title: 'Stakeholder Recovery',
               stakeholders: [
                   {
                       role: 'Original Champion',
                       influence: 'medium',
                       priorities: ['Personal success', 'Risk avoidance', 'Solution delivery'],
                       approach: 'Understand what changed and how to re-energize their support'
                   },
                   {
                       role: 'New Decision Makers',
                       influence: 'high',
                       priorities: ['Due diligence', 'Risk mitigation', 'Best value'],
                       approach: 'Build relationships quickly and establish credibility'
                   },
                   {
                       role: 'Technical Evaluators',
                       influence: 'high',
                       priorities: ['Technical fit', 'Implementation risk', 'Support quality'],
                       approach: 'Address technical concerns with detailed proof and references'
                   }
               ]
           },
           talking_points: {
               title: 'Recovery Conversations',
               diagnostic_questions: [
                   'What changed since we last spoke?',
                   'What concerns weren\'t we addressing effectively?',
                   'Who else has become involved in this decision?',
                   'What would need to happen for this to move forward?'
               ],
               recovery_messaging: [
                   'We\'re committed to making this successful for you',
                   'Let\'s address your concerns directly and specifically',
                   'Here\'s how we\'ve solved similar challenges for other agencies',
                   'What additional assurance or proof do you need?'
               ]
           },
           competitive_strategy: {
               title: 'Competitive Recovery',
               likely_competitors: [
                   {
                       name: 'Status Quo/Do Nothing',
                       weakness: 'Doesn\'t solve the original problem',
                       counter: 'Remind them of the original pain points and urgency'
                   },
                   {
                       name: 'New Competitive Entrant',
                       weakness: 'Unknown quantity with unproven federal track record',
                       counter: 'Emphasize your proven experience and lower implementation risk'
                   }
               ]
           },
           resources: {
               title: 'Recovery Toolkit',
               immediate_actions: [
                   'Schedule stakeholder interviews within 48 hours',
                   'Prepare detailed objection handling documentation',
                   'Engage executive sponsors for high-level discussions',
                   'Develop modified proposal addressing new requirements'
               ],
               helpful_resources: [
                   'Deal rescue checklist and timeline',
                   'Stakeholder interview script and templates',
                   'Competitive response frameworks',
                   'Executive escalation protocols'
               ]
           }
       },
       metrics: [
           { label: 'Rescue Success Rate', value: '42%' },
           { label: 'Avg Recovery Time', value: '6-8 weeks' },
           { label: 'Effort Required', value: 'High' },
           { label: 'Learning Value', value: 'Very High' }
       ]
   },

   'stakeholder-mapping': {
       title: 'Stakeholder Mapping Playbook',
       subtitle: 'Navigating complex federal decision processes',
       icon: '👥',
       context_keywords: ['stakeholder', 'decision', 'influence', 'mapping', 'politics'],
       sections: {
           situation_analysis: {
               title: 'Decision Process Analysis',
               content: {
                   complexity_factors: [
                       'Multiple agencies or departments involved',
                       'Technical and business stakeholders with different priorities',
                       'Procurement and legal review requirements',
                       'Security and compliance approval processes'
                   ],
                   influence_types: [
                       'Decision makers (formal authority)',
                       'Influencers (trusted advisors)',
                       'Champions (internal advocates)',
                       'Blockers (potential obstacles)'
                   ]
               }
           },
           key_moves: {
               title: 'Mapping Strategy',
               timeline: [
                   {
                       timeframe: 'Week 1-2',
                       action: 'Identify All Stakeholders',
                       details: 'Map formal and informal decision makers across technical, business, and procurement.',
                       priority: 'urgent'
                   },
                   {
                       timeframe: 'Week 3-4',
                       action: 'Assess Influence & Priorities',
                       details: 'Understand each stakeholder\'s role, influence level, and key priorities.',
                       priority: 'high-impact'
                   },
                   {
                       timeframe: 'Week 5-8',
                       action: 'Build Stakeholder Relationships',
                       details: 'Develop tailored engagement strategies for each key stakeholder.',
                       priority: 'high-impact'
                   }
               ]
           },
           stakeholder_strategy: {
               title: 'Stakeholder Categories',
               stakeholders: [
                   {
                       role: 'Program Manager/Business Owner',
                       influence: 'high',
                       priorities: ['Mission success', 'Budget efficiency', 'Timeline adherence'],
                       approach: 'Focus on business outcomes and mission impact'
                   },
                   {
                       role: 'Technical Lead/Architect',
                       influence: 'high',
                       priorities: ['Technical requirements', 'Integration complexity', 'Performance'],
                       approach: 'Provide detailed technical information and proof of concepts'
                   },
                   {
                       role: 'Security Officer',
                       influence: 'high',
                       priorities: ['Risk mitigation', 'Compliance', 'Security controls'],
                       approach: 'Demonstrate security features and compliance certifications'
                   },
                   {
                       role: 'Procurement/Contracting',
                       influence: 'medium',
                       priorities: ['Process compliance', 'Fair competition', 'Contract terms'],
                       approach: 'Ensure all documentation is complete and accurate'
                   }
               ]
           },
           talking_points: {
               title: 'Stakeholder Engagement',
               mapping_questions: [
                   'Who else is involved in evaluating this type of solution?',
                   'How are decisions typically made in your organization?',
                   'What approval processes will this need to go through?',
                   'Who would be most concerned about [specific aspect]?'
               ],
               relationship_building: [
                   'Tailor your message to each stakeholder\'s priorities',
                   'Provide value in every interaction',
                   'Build trust through transparency and expertise',
                   'Create champions by helping them succeed'
               ]
           },
           competitive_strategy: {
               title: 'Influence Strategy',
               likely_competitors: [
                   {
                       name: 'Incumbent with Existing Relationships',
                       weakness: 'May not have relationships with new stakeholders',
                       counter: 'Build new relationships and demonstrate fresh perspective'
                   }
               ]
           },
           resources: {
               title: 'Mapping Tools',
               immediate_actions: [
                   'Create stakeholder influence matrix',
                   'Develop persona-based messaging for each group',
                   'Map decision process timeline and checkpoints',
                   'Identify relationship-building opportunities'
               ],
               helpful_resources: [
                   'Stakeholder mapping template and tools',
                   'Federal decision process flowcharts',
                   'Influence strategy worksheets',
                   'Relationship tracking systems'
               ]
           }
       },
       metrics: [
           { label: 'Stakeholder Coverage', value: '85%+' },
           { label: 'Champion Ratio', value: '3:1' },
           { label: 'Decision Clarity', value: 'High' },
           { label: 'Relationship Quality', value: 'Strong' }
       ]
   },

   'competitive-displacement': {
       title: 'Competitive Displacement Playbook',
       subtitle: 'Strategies for displacing entrenched incumbents',
       icon: '⚔️',
       context_keywords: ['competitive', 'incumbent', 'displacement', 'competition', 'replace'],
       sections: {
           situation_analysis: {
               title: 'Competitive Assessment',
               content: {
                   incumbent_advantages: [
                       'Existing relationships and trust',
                       'Deployed solutions and user familiarity',
                       'Switching cost concerns',
                       'Risk aversion to change'
                   ],
                   displacement_opportunities: [
                       'Technology evolution and modernization needs',
                       'Performance or security gaps',
                       'Cost optimization pressures',
                       'New requirements or compliance mandates'
                   ]
               }
           },
           key_moves: {
               title: 'Displacement Strategy',
               timeline: [
                   {
                       timeframe: 'Month 1',
                       action: 'Competitive Intelligence',
                       details: 'Thoroughly research incumbent\'s strengths, weaknesses, and customer satisfaction.',
                       priority: 'urgent'
                   },
                   {
                       timeframe: 'Month 2',
                       action: 'Differentiation Strategy',
                       details: 'Develop compelling differentiation based on incumbent\'s proven weaknesses.',
                       priority: 'high-impact'
                   },
                   {
                       timeframe: 'Month 3-6',
                       action: 'Proof & Validation',
                       details: 'Provide concrete evidence of superior capabilities through pilots or references.',
                       priority: 'high-impact'
                   }
               ]
           },
           stakeholder_strategy: {
               title: 'Displacement Stakeholders',
               stakeholders: [
                   {
                       role: 'Frustrated Users',
                       influence: 'medium',
                       priorities: ['Better performance', 'Easier usability', 'Feature gaps'],
                       approach: 'Become their internal advocate for change'
                   },
                   {
                       role: 'Change Champions',
                       influence: 'high',
                       priorities: ['Innovation', 'Competitive advantage', 'Modernization'],
                       approach: 'Position as strategic transformation opportunity'
                   },
                   {
                       role: 'Risk-Averse Leadership',
                       influence: 'high',
                       priorities: ['Stability', 'Proven solutions', 'Minimal disruption'],
                       approach: 'Demonstrate lower risk through proof and gradual transition'
                   }
               ]
           },
           talking_points: {
               title: 'Displacement Messaging',
               competitive_questions: [
                   'How satisfied are you with your current solution\'s performance?',
                   'What features or capabilities are you missing?',
                   'How does your current cost compare to market benchmarks?',
                   'What would justify the effort of making a change?'
               ],
               displacement_themes: [
                   'Technology evolution requires platform evolution',
                   'Hidden costs of staying with legacy solutions',
                   'Competitive advantage through superior capabilities',
                   'Risk mitigation through proven alternatives'
               ]
           },
           competitive_strategy: {
               title: 'Battle Plan',
               likely_competitors: [
                   {
                       name: 'Entrenched Incumbent',
                       weakness: 'Legacy technology, high maintenance costs, limited innovation',
                       counter: 'Demonstrate modern capabilities, cost savings, and future roadmap'
                   }
               ]
           },
           resources: {
               title: 'Displacement Toolkit',
               immediate_actions: [
                   'Conduct competitive analysis and SWOT assessment',
                   'Develop side-by-side comparison materials',
                   'Prepare risk mitigation and transition plans',
                   'Gather compelling customer references and case studies'
               ],
               helpful_resources: [
                   'Competitive battle cards and objection handling',
                   'ROI and TCO comparison tools',
                   'Migration and transition planning templates',
                   'Reference customer introduction protocols'
               ]
           }
       },
       metrics: [
           { label: 'Displacement Success', value: '28%' },
           { label: 'Avg Sales Cycle', value: '24 months' },
           { label: 'Deal Size Premium', value: '+40%' },
           { label: 'Customer Satisfaction', value: '94%' }
       ]
   }
};

// Context-Driven Playbook Generator
class PlaybookGenerator {
   constructor() {
       this.elements = this.getElements();
       this.currentPlaybook = null;
       this.init();
   }

   getElements() {
       return {
           scenarioSelector: document.getElementById('scenario-selector'),
           situationInput: document.getElementById('situation-input'),
           generateBtn: document.getElementById('generate-playbook-btn'),
           loadingContainer: document.getElementById('loading-container'),
           loadingMessage: document.getElementById('loading-message'),
           errorMessage: document.getElementById('error-message'),
           retryBtn: document.getElementById('retry-btn'),
           playbookContainer: document.getElementById('playbook-container'),
           aboutBtn: document.getElementById('about-btn'),
           aboutModal: document.getElementById('about-modal'),
           closeAbout: document.getElementById('close-about'),
           shareBtn: document.getElementById('share-btn')
       };
   }

   init() {
       this.setupEventListeners();
       this.elements.situationInput.focus();
   }

   setupEventListeners() {
       // Generate playbook
       this.elements.generateBtn.addEventListener('click', () => this.generatePlaybook());
       this.elements.situationInput.addEventListener('keydown', (e) => {
           if (e.key === 'Enter') {
               e.preventDefault();
               this.generatePlaybook();
           }
       });

       // Scenario buttons
       document.querySelectorAll('.scenario-btn').forEach(btn => {
           btn.addEventListener('click', (e) => {
               const scenario = e.currentTarget.getAttribute('data-scenario');
               this.selectScenario(scenario);
           });
       });

       // Modal events
       this.elements.aboutBtn.addEventListener('click', () => this.showModal());
       this.elements.closeAbout.addEventListener('click', () => this.hideModal());
       this.elements.aboutModal.addEventListener('click', (e) => {
           if (e.target === this.elements.aboutModal) this.hideModal();
       });

       // Share
       this.elements.shareBtn.addEventListener('click', () => this.share());
       this.elements.retryBtn.addEventListener('click', () => this.generatePlaybook());

       // Escape key
       document.addEventListener('keydown', (e) => {
           if (e.key === 'Escape') this.hideModal();
       });
   }

   selectScenario(scenarioKey) {
       // Update UI
       document.querySelectorAll('.scenario-btn').forEach(btn => btn.classList.remove('active'));
       document.querySelector(`[data-scenario="${scenarioKey}"]`).classList.add('active');
       
       // Generate playbook immediately
       this.generatePlaybookFromTemplate(scenarioKey);
   }

   async generatePlaybook() {
       const situation = this.elements.situationInput.value.trim();
       
       if (!situation) {
           this.showError('Please describe your situation or select a scenario below.');
           return;
       }

       this.showLoading();
       this.hideScenarioSelector();

       try {
           // Detect context from user input
           const detectedScenario = this.detectScenarioFromInput(situation);
           
           if (detectedScenario) {
               // Generate from template with customization
               await this.generateCustomizedPlaybook(detectedScenario, situation);
           } else {
               // Fallback to API call for custom scenarios
               await this.generateAPIPlaybook(situation);
           }
       } catch (error) {
           console.error('Playbook generation failed:', error);
           this.showError('Something went wrong. Let\'s try that again.');
       } finally {
           this.hideLoading();
       }
   }

   detectScenarioFromInput(input) {
       const lowerInput = input.toLowerCase();
       
       for (const [scenarioKey, template] of Object.entries(PLAYBOOK_TEMPLATES)) {
           const keywords = template.context_keywords;
           const matches = keywords.filter(keyword => lowerInput.includes(keyword));
           
           if (matches.length >= 2) { // Need at least 2 keyword matches
               return scenarioKey;
           }
       }
       
       return null;
   }

   generatePlaybookFromTemplate(scenarioKey) {
       this.showLoading();
       this.hideScenarioSelector();

       // Simulate processing time for better UX
       setTimeout(() => {
           const template = PLAYBOOK_TEMPLATES[scenarioKey];
           this.currentPlaybook = this.customizeTemplate(template, '');
           this.displayPlaybook(this.currentPlaybook);
           this.hideLoading();
       }, 1500);
   }

   async generateCustomizedPlaybook(scenarioKey, userInput) {
       const template = PLAYBOOK_TEMPLATES[scenarioKey];
       
       // Simulate processing time
       await new Promise(resolve => setTimeout(resolve, 2000));
       
       this.currentPlaybook = this.customizeTemplate(template, userInput);
       this.displayPlaybook(this.currentPlaybook);
   }

   customizeTemplate(template, userInput) {
       // Create a deep copy of the template
       const customized = JSON.parse(JSON.stringify(template));
       
       // Basic customization based on user input
       if (userInput) {
           const agencies = this.extractAgencies(userInput);
           const technologies = this.extractTechnologies(userInput);
           
           if (agencies.length > 0) {
               customized.subtitle = `Tailored for ${agencies[0]} and similar agencies`;
           }
           
           // Add context-specific insights
           customized.user_context = {
               input: userInput,
               detected_agencies: agencies,
               detected_technologies: technologies
           };
       }
       
       return customized;
   }

   extractAgencies(input) {
       const agencies = [
           'DHS', 'Department of Homeland Security',
           'DOD', 'Department of Defense',
           'VA', 'Veterans Affairs',
           'CISA', 'Treasury', 'Justice', 'FBI',
           'NASA', 'NOAA', 'EPA'
       ];
       
       return agencies.filter(agency => 
           input.toLowerCase().includes(agency.toLowerCase())
       );
   }

   extractTechnologies(input) {
       const technologies = [
           'cybersecurity', 'cloud', 'AI', 'machine learning',
           'data analytics', 'automation', 'DevOps'
       ];
       
       return technologies.filter(tech => 
           input.toLowerCase().includes(tech.toLowerCase())
       );
   }

   async generateAPIPlaybook(situation) {
       // Fallback to API for custom scenarios
       try {
           const response = await fetch(CONFIG.API_ENDPOINT, {
               method: 'POST',
               headers: { 'Content-Type': 'application/json' },
               body: JSON.stringify({ 
                   situation: situation,
                   mode: 'playbook',
                   currentDate: new Date().toISOString().split('T')[0]
               })
           });
           
           if (!response.ok) throw new Error('API request failed');
           
           const data = await response.json();
           this.currentPlaybook = this.formatAPIResponse(data, situation);
           this.displayPlaybook(this.currentPlaybook);
           
       } catch (error) {
           // If API fails, use generic template
           console.warn('API failed, using generic template');
           this.currentPlaybook = this.createGenericPlaybook(situation);
           this.displayPlaybook(this.currentPlaybook);
       }
   }

   formatAPIResponse(apiData, situation) {
       // Format API response into playbook structure
       return {
           title: 'Custom Sales Playbook',
           subtitle: 'Tailored strategy for your specific situation',
           icon: '🎯',
           user_context: { input: situation },
           sections: {
               situation_analysis: {
                   title: 'Situation Analysis',
                   content: {
                       market_dynamics: [apiData.quick_take || 'Custom situation analysis'],
                       key_challenges: apiData.challenges || ['Analyze your specific challenges']
                   }
               },
               key_moves: {
                   title: 'Your Next Moves',
                   timeline: (apiData.key_moves || []).map((move, i) => ({
                       timeframe: `Week ${i + 1}`,
                       action: move.action || 'Action needed',
                       details: move.why || 'Strategic reasoning',
                       priority: i === 0 ? 'urgent' : 'high-impact'
                   }))
               },
               talking_points: {
                   title: 'Key Talking Points',
                   discovery_questions: apiData.talking_points || [
                       'What are your biggest challenges?',
                       'How do you measure success?',
                       'What would change mean for your team?'
                   ],
                   value_props: [
                       'Addresses your specific needs',
                       'Proven results in similar situations',
                       'Comprehensive support throughout'
                   ]
               },
               resources: {
                   title: 'Next Steps',
                   immediate_actions: [
                       'Schedule follow-up discussion',
                       'Gather additional requirements',
                       'Prepare detailed proposal',
                       'Connect with key stakeholders'
                   ]
               }
           },
           metrics: [
               { label: 'Confidence', value: 'High' },
               { label: 'Complexity', value: 'Medium' },
               { label: 'Timeline', value: '4-8 weeks' },
               { label: 'Success Rate', value: '65%' }
           ]
       };
   }

   createGenericPlaybook(situation) {
       return {
           title: 'Federal Sales Playbook',
           subtitle: 'Strategic approach for your situation',
           icon: '🎯',
           user_context: { input: situation },
           sections: {
               situation_analysis: {
                   title: 'Situation Analysis',
                   content: {
                       market_dynamics: [
                           'Federal market opportunities continue to grow',
                           'Digital transformation driving new requirements',
                           'Compliance and security remain critical factors',
                           'Procurement processes are becoming more efficient'
                       ],
                       key_challenges: [
                           'Complex decision-making processes',
                           'Long sales cycles and evaluation periods',
                           'Multiple stakeholder alignment required',
                           'Competitive landscape and incumbent relationships'
                       ]
                   }
               },
               key_moves: {
                   title: 'Strategic Approach',
                   timeline: [
                       {
                           timeframe: 'Week 1-2',
                           action: 'Stakeholder Discovery',
                           details: 'Identify and understand all decision makers and influencers.',
                           priority: 'urgent'
                       },
                       {
                           timeframe: 'Week 3-4',
                           action: 'Value Proposition Development',
                           details: 'Craft compelling messaging tailored to specific agency needs.',
                           priority: 'high-impact'
                       },
                       {
                           timeframe: 'Week 5-8',
                           action: 'Proof & Validation',
                           details: 'Provide evidence of capabilities through demos, pilots, or references.',
                           priority: 'high-impact'
                       }
                   ]
               },
               talking_points: {
                   title: 'Essential Questions',
                   discovery_questions: [
                       'What are your top mission priorities this year?',
                       'How do you currently address this challenge?',
                       'What would success look like for your organization?',
                       'Who else is involved in this type of decision?'
                   ],
                   value_props: [
                       'Purpose-built for federal requirements',
                       'Proven track record with similar agencies',
                       'Comprehensive support and partnership approach',
                       'Cost-effective solution with measurable ROI'
                   ]
               },
               resources: {
                   title: 'Next Steps',
                   immediate_actions: [
                       'Schedule stakeholder discovery meetings',
                       'Prepare agency-specific value proposition',
                       'Gather relevant case studies and references',
                       'Develop proof of concept or pilot proposal'
                   ]
               }
           },
           metrics: [
               { label: 'Approach', value: 'Consultative' },
               { label: 'Timeline', value: '6-12 weeks' },
               { label: 'Effort Level', value: 'High' },
               { label: 'Success Factors', value: 'Relationship' }
           ]
       };
   }

   displayPlaybook(playbook) {
       const html = `
           <div class="playbook-header fade-in">
               <div class="relative z-10">
                   <div class="flex items-center gap-3 mb-3">
                       <span class="text-3xl">${playbook.icon}</span>
                       <div>
                           <h1 class="text-2xl font-bold">${playbook.title}</h1>
                           <p class="text-purple-100 text-sm">${playbook.subtitle}</p>
                       </div>
                   </div>
                   ${playbook.user_context ? `
                       <div class="bg-white/10 rounded-lg p-3 mt-4">
                           <p class="text-sm text-purple-100">
                               <strong>Your Situation:</strong> "${playbook.user_context.input}"
                           </p>
                       </div>
                   ` : ''}
                   <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6">
                       ${playbook.metrics.map(metric => `
                           <div class="text-center">
                               <div class="text-xl font-bold text-white">${metric.value}</div>
                               <div class="text-xs text-purple-200">${metric.label}</div>
                           </div>
                       `).join('')}
                   </div>
               </div>
           </div>

           ${this.renderSection(playbook.sections.situation_analysis)}
           ${this.renderTimelineSection(playbook.sections.key_moves)}
           ${playbook.sections.stakeholder_strategy ? this.renderStakeholderSection(playbook.sections.stakeholder_strategy) : ''}
           ${this.renderTalkingPointsSection(playbook.sections.talking_points)}
           ${playbook.sections.competitive_strategy ? this.renderCompetitiveSection(playbook.sections.competitive_strategy) : ''}
           ${this.renderResourcesSection(playbook.sections.resources)}
           
           <div class="result-card text-center">
               <div class="flex flex-col sm:flex-row gap-3 justify-center">
                   <button onclick="playbookGenerator.copyPlaybook()" 
                       class="px-6 py-3 bg-customPurple-500 hover:bg-customPurple-700 text-white font-medium rounded-lg transition-colors">
                       📋 Copy Playbook
                   </button>
                   <button onclick="playbookGenerator.printPlaybook()" 
                       class="px-6 py-3 bg-white hover:bg-gray-50 text-gray-700 font-medium rounded-lg border border-gray-200 transition-colors">
                       🖨️ Print Playbook
                   </button>
                   <button onclick="playbookGenerator.startOver()" 
                       class="px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-lg transition-colors">
                       🔄 New Playbook
                   </button>
               </div>
           </div>
       `;
       
       this.elements.playbookContainer.innerHTML = html;
       this.elements.playbookContainer.classList.remove('hidden');
       
       // Smooth scroll to playbook
       setTimeout(() => {
           this.elements.playbookContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
       }, 100);
   }

   renderSection(section) {
       if (!section) return '';
       
       return `
           <div class="result-card fade-in">
               <div class="playbook-section">
                   <h2 class="text-xl font-bold text-gray-900 mb-4">${section.title}</h2>
                   ${section.content.market_dynamics ? `
                       <div class="mb-6">
                           <h3 class="font-semibold text-gray-800 mb-3">Market Dynamics</h3>
                           <ul class="space-y-2">
                               ${section.content.market_dynamics.map(item => `
                                   <li class="flex items-start gap-2">
                                       <span class="text-green-500 mt-1 flex-shrink-0">📈</span>
                                       <span class="text-sm">${item}</span>
                                   </li>
                               `).join('')}
                           </ul>
                       </div>
                   ` : ''}
                   ${section.content.key_challenges ? `
                       <div>
                           <h3 class="font-semibold text-gray-800 mb-3">Key Challenges</h3>
                           <ul class="space-y-2">
                               ${section.content.key_challenges.map(item => `
                                   <li class="flex items-start gap-2">
                                       <span class="text-orange-500 mt-1 flex-shrink-0">⚠️</span>
                                       <span class="text-sm">${item}</span>
                                   </li>
                               `).join('')}
                           </ul>
                       </div>
                   ` : ''}
                   ${section.content.common_issues ? `
                       <div class="mb-6">
                           <h3 class="font-semibold text-gray-800 mb-3">Common Issues</h3>
                           <ul class="space-y-2">
                               ${section.content.common_issues.map(item => `
                                   <li class="flex items-start gap-2">
                                       <span class="text-red-500 mt-1 flex-shrink-0">🚩</span>
                                       <span class="text-sm">${item}</span>
                                   </li>
                               `).join('')}
                           </ul>
                       </div>
                   ` : ''}
                   ${section.content.impact_areas ? `
                       <div>
                           <h3 class="font-semibold text-gray-800 mb-3">Impact Areas</h3>
                           <ul class="space-y-2">
                               ${section.content.impact_areas.map(item => `
                                   <li class="flex items-start gap-2">
                                       <span class="text-purple-500 mt-1 flex-shrink-0">💡</span>
                                       <span class="text-sm">${item}</span>
                                   </li>
                               `).join('')}
                           </ul>
                       </div>
                   ` : ''}
               </div>
           </div>
       `;
   }

   renderTimelineSection(section) {
       if (!section || !section.timeline) return '';
       
       return `
           <div class="result-card fade-in">
               <div class="playbook-section">
                   <h2 class="text-xl font-bold text-gray-900 mb-6">${section.title}</h2>
                   <div class="space-y-4">
                       ${section.timeline.map(item => `
                           <div class="timeline-item ${item.priority || ''}">
                               <div class="action-item ${item.priority || ''}">
                                   <div class="flex justify-between items-start mb-2">
                                       <h3 class="font-semibold text-gray-900">${item.action}</h3>
                                       <span class="text-xs font-medium px-2 py-1 rounded-full ${
                                           item.priority === 'urgent' ? 'bg-red-100 text-red-800' :
                                           item.priority === 'high-impact' ? 'bg-green-100 text-green-800' :
                                           'bg-gray-100 text-gray-800'
                                       }">${item.timeframe}</span>
                                   </div>
                                   <p class="text-sm text-gray-600">${item.details}</p>
                               </div>
                           </div>
                       `).join('')}
                   </div>
               </div>
           </div>
       `;
   }

   renderStakeholderSection(section) {
       if (!section || !section.stakeholders) return '';
       
       return `
           <div class="result-card fade-in">
               <div class="playbook-section">
                   <h2 class="text-xl font-bold text-gray-900 mb-6">${section.title}</h2>
                   <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                       ${section.stakeholders.map(stakeholder => `
                           <div class="border border-gray-200 rounded-lg p-4">
                               <div class="flex justify-between items-start mb-3">
                                   <h3 class="font-semibold text-gray-900">${stakeholder.role}</h3>
                                   <span class="text-xs font-medium px-2 py-1 rounded-full ${
                                       stakeholder.influence === 'high' ? 'bg-red-100 text-red-800' :
                                       stakeholder.influence === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                                       'bg-gray-100 text-gray-800'
                                   }">${stakeholder.influence} influence</span>
                               </div>
                               <div class="mb-3">
                                   <h4 class="text-sm font-medium text-gray-700 mb-1">Priorities:</h4>
                                   <ul class="text-sm text-gray-600">
                                       ${stakeholder.priorities.map(priority => `
                                           <li>• ${priority}</li>
                                       `).join('')}
                                   </ul>
                               </div>
                               <div>
                                   <h4 class="text-sm font-medium text-gray-700 mb-1">Approach:</h4>
                                   <p class="text-sm text-gray-600">${stakeholder.approach}</p>
                               </div>
                           </div>
                       `).join('')}
                   </div>
               </div>
           </div>
       `;
   }

   renderTalkingPointsSection(section) {
       if (!section) return '';
       
       return `
           <div class="result-card fade-in">
               <div class="playbook-section">
                   <h2 class="text-xl font-bold text-gray-900 mb-6">${section.title}</h2>
                   <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                       ${section.discovery_questions ? `
                           <div>
                               <h3 class="font-semibold text-gray-800 mb-3">🔍 Discovery Questions</h3>
                               <ul class="space-y-2">
                                   ${section.discovery_questions.map(question => `
                                       <li class="flex items-start gap-2">
                                           <span class="text-blue-500 mt-1">▶</span>
                                           <span class="text-sm">${question}</span>
                                       </li>
                                   `).join('')}
                               </ul>
                           </div>
                       ` : ''}
                       ${section.value_props ? `
                           <div>
                               <h3 class="font-semibold text-gray-800 mb-3">💎 Value Propositions</h3>
                               <ul class="space-y-2">
                                   ${section.value_props.map(prop => `
                                       <li class="flex items-start gap-2">
                                           <span class="text-green-500 mt-1">✓</span>
                                           <span class="text-sm">${prop}</span>
                                       </li>
                                   `).join('')}
                               </ul>
                           </div>
                       ` : ''}
                       ${section.mediation_questions ? `
                           <div>
                               <h3 class="font-semibold text-gray-800 mb-3">🤝 Mediation Questions</h3>
                               <ul class="space-y-2">
                                   ${section.mediation_questions.map(question => `
                                       <li class="flex items-start gap-2">
                                           <span class="text-purple-500 mt-1">▶</span>
                                           <span class="text-sm">${question}</span>
                                       </li>
                                   `).join('')}
                               </ul>
                           </div>
                       ` : ''}
                       ${section.alignment_principles ? `
                           <div>
                               <h3 class="font-semibold text-gray-800 mb-3">⚖️ Alignment Principles</h3>
                               <ul class="space-y-2">
                                   ${section.alignment_principles.map(principle => `
                                       <li class="flex items-start gap-2">
                                           <span class="text-indigo-500 mt-1">◆</span>
                                           <span class="text-sm">${principle}</span>
                                       </li>
                                   `).join('')}
                               </ul>
                           </div>
                       ` : ''}
                   </div>
               </div>
           </div>
       `;
   }

   renderCompetitiveSection(section) {
       if (!section || !section.likely_competitors) return '';
       
       return `
           <div class="result-card fade-in">
               <div class="playbook-section">
                   <h2 class="text-xl font-bold text-gray-900 mb-6">${section.title}</h2>
                   <div class="space-y-4">
                       ${section.likely_competitors.map(competitor => `
                           <div class="border border-gray-200 rounded-lg p-4">
                               <h3 class="font-semibold text-gray-900 mb-2">${competitor.name}</h3>
                               <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                   <div>
                                       <h4 class="text-sm font-medium text-red-700 mb-1">Their Weakness:</h4>
                                       <p class="text-sm text-gray-600">${competitor.weakness}</p>
                                   </div>
                                   <div>
                                       <h4 class="text-sm font-medium text-green-700 mb-1">Your Counter:</h4>
                                       <p class="text-sm text-gray-600">${competitor.counter}</p>
                                   </div>
                               </div>
                           </div>
                       `).join('')}
                   </div>
               </div>
           </div>
       `;
   }

   renderResourcesSection(section) {
       if (!section) return '';
       
       return `
           <div class="result-card fade-in">
               <div class="playbook-section">
                   <h2 class="text-xl font-bold text-gray-900 mb-6">${section.title}</h2>
                   <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                       ${section.immediate_actions ? `
                           <div>
                               <h3 class="font-semibold text-gray-800 mb-3">🎯 Immediate Actions</h3>
                               <ul class="space-y-2">
                                   ${section.immediate_actions.map(action => `
                                       <li class="flex items-start gap-2">
                                           <span class="text-orange-500 mt-1">→</span>
                                           <span class="text-sm">${action}</span>
                                       </li>
                                   `).join('')}
                               </ul>
                           </div>
                       ` : ''}
                       ${section.helpful_resources ? `
                           <div>
                               <h3 class="font-semibold text-gray-800 mb-3">📚 Helpful Resources</h3>
                               <ul class="space-y-2">
                                   ${section.helpful_resources.map(resource => `
                                       <li class="flex items-start gap-2">
                                           <span class="text-blue-500 mt-1">📄</span>
                                           <span class="text-sm">${resource}</span>
                                       </li>
                                   `).join('')}
                               </ul>
                           </div>
                       ` : ''}
                   </div>
               </div>
           </div>
       `;
   }

   showLoading() {
       this.elements.loadingContainer.classList.remove('hidden');
   }

   hideLoading() {
       this.elements.loadingContainer.classList.add('hidden');
   }

   hideScenarioSelector() {
       this.elements.scenarioSelector.style.display = 'none';
   }

   showScenarioSelector() {
       this.elements.scenarioSelector.style.display = 'block';
   }

   showError(message) {
       this.elements.errorMessage.querySelector('p').textContent = message;
       this.elements.errorMessage.classList.remove('hidden');
       setTimeout(() => {
           this.elements.errorMessage.classList.add('hidden');
       }, 5000);
   }

   copyPlaybook() {
       const content = this.elements.playbookContainer.innerText;
       
       if (!content) {
           alert('No playbook to copy');
           return;
       }
       
       navigator.clipboard.writeText(content)
           .then(() => {
               alert('Playbook copied to clipboard!');
           })
           .catch(() => alert('Copy failed. Please try selecting and copying manually.'));
   }

   printPlaybook() {
       window.print();
   }

   startOver() {
       this.elements.playbookContainer.classList.add('hidden');
       this.elements.playbookContainer.innerHTML = '';
       this.elements.situationInput.value = '';
       this.currentPlaybook = null;
       
       // Reset scenario buttons
       document.querySelectorAll('.scenario-btn').forEach(btn => btn.classList.remove('active'));
       
       this.showScenarioSelector();
       this.elements.situationInput.focus();
   }

   share() {
       const shareData = {
           title: 'AskArti - Federal Sales Playbooks',
           text: 'Get personalized federal sales strategies instantly',
           url: 'https://askarti.com'
       };
       
       if (navigator.share) {
           navigator.share(shareData).catch(console.error);
       } else {
           navigator.clipboard.writeText(`${shareData.text} - ${shareData.url}`)
               .then(() => {
                   this.elements.shareBtn.textContent = 'Link Copied!';
                   setTimeout(() => this.elements.shareBtn.textContent = 'Share', 2000);
               })
               .catch(() => alert('Please copy: https://askarti.com'));
       }
   }

   showModal() {
       this.elements.aboutModal.classList.remove('hidden');
   }

   hideModal() {
       this.elements.aboutModal.classList.add('hidden');
   }
}

// Initialize the playbook generator
const playbookGenerator = new PlaybookGenerator();
</script>
</body>
</html>